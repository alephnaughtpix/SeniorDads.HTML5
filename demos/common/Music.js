SeniorDads.CreateNameSpace("SeniorDads.Music");SeniorDads.Music=function(l,p,v){void 0===v&&(v=!0);var w=new music(l);w.stereo(v);w.Load(p);this.load=w.Load;this.resource_size=1;this.play=w.Play;this.stop=w.Stop;this.stereo=w.stereo;Object.defineProperties(this,{pattern_position:{get:function(){return SeniorDads.Music.pattern_position}},track_position:{get:function(){return SeniorDads.Music.track_position}},loaded:{get:function(){return w.loaded}},resource_size:{get:function(){return 1}},resource_loaded:{get:function(){return loaded?1:0}}})};
SeniorDads.Music.IfAtPoint=function(l,p,v){SeniorDads.Music.track_position==SeniorDads.Music.BreakPoint_Track&&SeniorDads.Music.pattern_position==SeniorDads.Music.BreakPoint_Pattern&&null!=SeniorDads.Music.BreakPoint_Event&&SeniorDads.Music.BreakPoint_Event()};SeniorDads.Music.SetBreakPoint=function(l,p,v){SeniorDads.Music.BreakPoint_Pattern=p;SeniorDads.Music.BreakPoint_Track=l;SeniorDads.Music.BreakPoint_Event=v};
SeniorDads.Music.CheckForBreakPoint=function(){SeniorDads.Music.track_position==SeniorDads.Music.BreakPoint_Track&&SeniorDads.Music.pattern_position==SeniorDads.Music.BreakPoint_Pattern&&null!=SeniorDads.Music.BreakPoint_Event&&SeniorDads.Music.BreakPoint_Event()};var CODEF_AUDIO_CONTEXT=null,CODEF_AUDIO_NODE=null;
// Nearly all of the following code is by Antoine Santo, and is a modified version of his code for the CODEF project. http://codef.santo.fr
function music(l){this.pattern_position=function(){return 0};var p=!1,v,w;window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext;if("undefined"!=typeof AudioContext)switch(l){case "YM":CODEF_AUDIO_CONTEXT=new AudioContext;CODEF_AUDIO_NODE=CODEF_AUDIO_CONTEXT.createScriptProcessor(8192);this.loader={};this.loader.player=new YmProcessor;this.stereo_value=!1;break;default:this.stereo_value=!1}"YM"==l?(this.LoadAndRun=function(l){var p=
this;if("undefined"!=typeof AudioContext){var v=new XMLHttpRequest;v.open("GET",l);v.overrideMimeType("text/plain; charset=x-user-defined");v.onreadystatechange=function(){if(4==this.readyState&&200==this.status){for(var l=this.responseText||"",v=[],w=l.length,x=String.fromCharCode,z=0;z<w;z++)v[z]=x(l.charCodeAt(z)&255);l=new dataType;l.data=v.join("");YmConst_PLAYER_FREQ=CODEF_AUDIO_CONTEXT.sampleRate;p.loader.player.stereo=p.stereo_value;p.loader.player.load(l)}};v.send()}},this.Load=function(l){var y=
this;if("undefined"!=typeof AudioContext){var x=new XMLHttpRequest;x.open("GET",l);x.overrideMimeType("text/plain; charset=x-user-defined");x.onreadystatechange=function(){if(4==this.readyState&&200==this.status){for(var l=this.responseText||"",x=[],z=l.length,H=String.fromCharCode,B=0;B<z;B++)x[B]=H(l.charCodeAt(B)&255);l=new dataType;l.data=x.join("");YmConst_PLAYER_FREQ=CODEF_AUDIO_CONTEXT.sampleRate;y.loader.player.stereo=y.stereo_value;w=l;p=!0;v=y.loader.player}};x.send()}},this.Play=function(){v.load(w)},
this.Stop=function(){CODEF_AUDIO_NODE.disconnect();CODEF_AUDIO_NODE.onaudioprocess=CODEF_AUDIO_NODE=null;null!=v&&v.stop()}):(this.LoadAndRun=function(l){var p=this;this.loader=window.neoart.FileLoader;if("undefined"!=typeof AudioContext){var v=new XMLHttpRequest;v.open("GET",l);v.overrideMimeType("text/plain; charset=x-user-defined");v.responseType="arraybuffer";v.onreadystatechange=function(){4==this.readyState&&200==this.status&&(p.loader.player=null,p.loader.load(this.response),p.loader.player.reset(),
p.loader.player.stereo=p.stereo_value,p.loader.player.play())};v.send()}},this.Load=function(l){var w=this;this.loader=window.neoart.FileLoader;if("undefined"!=typeof AudioContext){var x=new XMLHttpRequest;x.open("GET",l);x.overrideMimeType("text/plain; charset=x-user-defined");x.responseType="arraybuffer";x.onreadystatechange=function(){4==this.readyState&&200==this.status&&(w.loader.player=null,w.loader.load(this.response),w.loader.player.reset(),w.loader.player.stereo=w.stereo_value,v=w.loader.player,
p=!0)};x.send()}},this.Play=function(){null!=v&&v.play()},this.Stop=function(){null!=v&&v.stop()});this.loaded=function(){return p};this.stereo=function(l){this.stereo_value=l};return this}
var YmConst_BUFFER_SIZE=8192,YmConst_PLAYER_FREQ=48E3,YmConst_DRUM_PREC=15,YmConst_AMSTRAD_FREQ=1E6,YmConst_ATARI_FREQ=2E6,YmConst_SPECTRUM_FREQ=1773400,YmConst_INTERLEAVED=1,YmConst_DRUM_SIGNED=2,YmConst_DRUM_4BITS=4,YmConst_TIME_CONTROL=8,YmConst_LOOP_MODE=16,YmConst_MFP_PREDIV=[0,4,10,16,50,64,100,200],YmConst_MONO=[6.3071586250394E-4,.00163782667521185,.00269580167037975,.00383515935748365,.00590024516535946,.00787377544480728,.01174962614825892,.01602221747489853,.02299061047191789,.03141371908729311,
.04648986276843572,.06340728985463016,.09491256447035126,.13414919481999166,.21586759036022013,.3333333333333333],YmConst_STEREO=[9.4607379375591E-4,.00245674001281777,.00404370250556963,.00575273903622547,.00885036774803918,.01181066316721091,.01762443922238838,.02403332621234779,.03448591570787683,.04712057863093966,.06973479415265357,.09511093478194525,.1423688467055269,.20122379222998749,.3238013855403302,.5],YmConst_ENVELOPES=[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,
14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,15,15,15,15,15,15,15,
15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,
12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
function YmSong(l){this.title;this.author;this.comment;this.attribs;this.clock;this.digidrums;this.drums;this.frames=[];this.frameSize;this.length;this.rate;this.restart;this.supported=!0;this.data=new dataType;this.data.data=l;this.init=function(){this.decode();this.attribs&YmConst_INTERLEAVED&&this.deinterleave();for(i=0;i<this.length;++i)this.frames[i]=this.data.readBytes(0,this.frameSize)};this.decode=function(){var l;l=this.data.readMultiByte(4,"txt");switch(l){case "YM2!":case "YM3!":case "YM3b":this.frameSize=
14;this.length=(this.data.data.length-4)/this.frameSize;this.clock=YmConst_ATARI_FREQ;this.rate=50;this.restart="YM3b"!=l?0:this.data.readByte();this.attribs=YmConst_INTERLEAVED|YmConst_TIME_CONTROL;break;case "YM4!":this.supported=!1;break;case "YM5!":case "YM6!":l=this.data.readMultiByte(8,"txt");if("LeOnArD!"!=l){this.supported=!1;break}this.length=this.data.readInt();this.attribs=this.data.readInt();this.drums=this.data.readShort();this.clock=this.data.readInt();this.rate=this.data.readShort();
this.restart=this.data.readInt();this.data.readShort();if(this.drums){this.digidrums=[];for(l=0;l<this.drums;++l)this.digidrum=new Digidrum(this.data.readInt()),0!=this.digidrum.size&&(this.digidrum.wave.data=this.data.readBytes(0,this.digidrum.size),this.digidrum.convert(this.attribs),this.digidrums[l]=this.digidrum);this.attribs&=~YmConst_DRUM_4BITS}this.title=this.data.readString();this.author=this.data.readString();this.comment=this.data.readString();this.frameSize=16;this.attribs=YmConst_INTERLEAVED|
YmConst_TIME_CONTROL;break;case "MIX1":supported=!1;break;case "YMT1":case "YMT2":supported=!1;break;default:supported=!1}};this.deinterleave=function(){var l,v,w=0,z=[],y=[];for(l=0;l<this.frameSize;++l)z[l]=this.data.pos+this.length*l;for(l=0;l<this.length;++l){for(v=0;v<this.frameSize;++v)y[v+w]=this.data.data[l+z[v]];w+=this.frameSize}this.data.data="";this.data.data=y;this.data.pos=0;this.attribs&=~YmConst_INTERLEAVED};this.init()}
function YmProcessor(){this.counter;this.sound;this.soundChannel;this.soundChannelPos;this.song;this.loop=1;this.stereo=0;this.audioFreq;this.clock;this.registers=[];this.volumeEnv;this.buffer;this.bufferSize;this.voiceA=new YmChannel(this);this.voiceB=new YmChannel(this);this.voiceC=new YmChannel(this);this.samplesTick;this.samplesLeft;this.frame;this.envData;this.envPhase;this.envPos;this.envShape;this.envStep;this.noiseOutput;this.noisePos;this.noiseStep;this.rng;this.syncBuzzer;this.syncBuzzerPhase;
this.syncBuzzerStep;__self=this;this.init=function(){var l;this.bufferSize=YmConst_BUFFER_SIZE;this.buffer=[];for(l=0;l<this.bufferSize;++l)this.buffer[l]=new Sample;this.envData=YmConst_ENVELOPES};this.load=function(l){var p=new LHa;this.song=new YmSong(p.unpack(l));this.audioFreq=YmConst_PLAYER_FREQ;this.clock=this.song.clock;this.samplesTick=this.audioFreq/this.song.rate;CODEF_AUDIO_NODE.onaudioprocess=function(l){__self.mixer(l)};return this.song.supported};this.mixer=function(l){for(var p=0,
v=0,w=0,z=0,y=0,x=0,y=0;w<this.bufferSize;){if(0==this.samplesLeft){if(this.frame>=this.song.length)if(this.loop)this.frame=this.song.restart;else{this.stop();return}this.syncBuzzerStop();for(v=0;v<this.song.frameSize;v++)this.registers[v]=this.song.frames[this.frame][v].charCodeAt(0);this.frame++;this.updateEffects(1,6,14);this.updateEffects(3,8,15);this.writeRegisters();this.samplesLeft=this.samplesTick}x=this.samplesLeft;w+x>this.bufferSize&&(x=this.bufferSize-w);y=z+x;for(v=z;v<y;++v)z=this.buffer[v],
this.noisePos&65536&&(p=this.rng&1^this.rng>>2&1,this.rng=this.rng>>1|p<<16,this.noiseOutput^=p?0:65535,this.noisePos&=65535),this.volumeEnv=this.envData[Math.floor((this.envShape<<6)+(this.envPhase<<5)+(this.envPos>>26))],this.voiceA.computeVolume(),this.voiceB.computeVolume(),this.voiceC.computeVolume(),p=this.voiceA.enabled()&(this.noiseOutput|this.voiceA.mixNoise),this.voiceA.getvolume(),z.voiceA=p?this.voiceA.getvolume():-1,p=this.voiceB.enabled()&(this.noiseOutput|this.voiceB.mixNoise),z.voiceB=
p?this.voiceB.getvolume():-1,p=this.voiceC.enabled()&(this.noiseOutput|this.voiceC.mixNoise),z.voiceC=p?this.voiceC.getvolume():-1,this.voiceA.next(),this.voiceB.next(),this.voiceC.next(),this.noisePos+=this.noiseStep,this.envPos+=this.envStep,2147483647<this.envPos&&(this.envPos-=2147483647),0==this.envPhase&&this.envPos<this.envStep&&(envPhase=1),this.syncBuzzer&&(this.syncBuzzerPhase+=this.syncBuzzerStep,this.syncBuzzerPhase&1073741824&&(this.envPhase=this.envPos=0,this.syncBuzzerPhase&=1073741823));
w+=x;z=y;this.samplesLeft-=x}w=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);if(this.stereo)for(v=0;v<this.bufferSize;++v)z=this.buffer[v],w[v]=z.left(),l[v]=z.right();else for(v=0;v<this.bufferSize;++v)y=this.buffer[v].mono(),w[v]=y,l[v]=y};this.writeRegisters=function(){var l;this.registers[0]&=255;this.registers[1]&=15;this.voiceA.computeTone(this.registers[1],this.registers[0]);this.registers[2]&=255;this.registers[3]&=15;this.voiceB.computeTone(this.registers[3],this.registers[2]);
this.registers[4]&=255;this.registers[5]&=15;this.voiceC.computeTone(this.registers[5],this.registers[4]);this.registers[6]&=31;3>this.registers[6]?(this.noisePos=0,this.noiseOutput=65535,this.noiseStep=0):(l=this.clock/((this.registers[6]<<3)*this.audioFreq),this.noiseStep=Math.floor(32768*l));this.registers[7]&=255;this.voiceA.mixTone=this.registers[7]&1?65535:0;this.voiceB.mixTone=this.registers[7]&2?65535:0;this.voiceC.mixTone=this.registers[7]&4?65535:0;this.voiceA.mixNoise=this.registers[7]&
8?65535:0;this.voiceB.mixNoise=this.registers[7]&16?65535:0;this.voiceC.mixNoise=this.registers[7]&32?65535:0;this.registers[8]&=31;this.voiceA.setvolume(this.registers[8]);this.registers[9]&=31;this.voiceB.setvolume(this.registers[9]);this.registers[10]&=31;this.voiceC.setvolume(this.registers[10]);this.registers[11]&=255;this.registers[12]&=255;l=this.registers[12]<<8|this.registers[11];3>l?this.envStep=0:(l=this.clock/((l<<8)*this.audioFreq),this.envStep=Math.floor(1073741824*l));255==this.registers[13]?
this.registers[13]=0:(this.registers[13]&=15,this.envPos=this.envPhase=0,this.envShape=this.registers[13])};this.updateEffects=function(l,p,v){var w=0,z=0,y=0;l=this.registers[l]&240;p=this.registers[p]>>5&7;v=this.registers[v];if(l&48)switch(y=((l&48)>>4)-1,l&192){case 64:w=this.registers[y+8]&31,0<=w&&w<this.song.drums&&(p=YmConst_MFP_PREDIV[p]*v,0<p&&(z=2457600/p,0==y?(this.voiceA.drum=this.song.digidrums[w],this.voiceA.drumStart(z)):1==y?(this.voiceB.drum=this.song.digidrums[w],this.voiceB.drumStart(z)):
2==y&&(this.voiceC.drum=this.song.digidrums[w],this.voiceC.drumStart(z))))}};this.syncBuzzerStart=function(l,p){this.envShape=this.shapeEnv&15;this.syncBuzzerStep=1073741824*this.timerFreq/this.audioFreq;this.syncBuzzerPhase=0;this.syncBuzzer=!0};this.syncBuzzerStop=function(){this.syncBuzzer=!1;this.syncBuzzerStep=this.syncBuzzerPhase=0};this.Stop=this.stop=function(){this.reset();return!0};this.reset=function(){var l;this.voiceA=new YmChannel(this);this.voiceB=new YmChannel(this);this.voiceC=new YmChannel(this);
this.frame=this.samplesLeft=0;this.registers=[];for(l=0;16>l;++l)this.registers[l]=0;this.registers[7]=255;this.writeRegisters();this.volumeEnv=0;this.noiseOutput=65535;this.noiseStep=this.noisePos=0;this.rng=1;this.envStep=this.envShape=this.envPos=this.envPhase=0;this.syncBuzzerStop()};this.init();this.reset();CODEF_AUDIO_NODE.connect(CODEF_AUDIO_CONTEXT.destination)}
function Sample(){this.voiceC=this.voiceB=this.voiceA=-1;this.mono=function(){var l=YmConst_MONO,p=0;-1<this.voiceA&&(p+=l[this.voiceA]);-1<this.voiceB&&(p+=l[this.voiceB]);-1<this.voiceC&&(p+=l[this.voiceC]);return p};this.left=function(){var l=YmConst_STEREO,p=0;-1<this.voiceA&&(p+=l[this.voiceA]);-1<this.voiceB&&(p+=l[this.voiceB]);return p};this.right=function(){var l=YmConst_STEREO,p=0;-1<this.voiceB&&(p+=l[this.voiceB]);-1<this.voiceC&&(p+=l[this.voiceC]);return p}}
function YmChannel(l){this.drumStep=this.drumPos=this.drum=this.digidrum=this.step=this.position=this.mode=this.mixTone=this.mixNoise=0;this.processor=l;this.vol=0;this.enabled=function(){return this.position>>30|this.mixTone};this.getvolume=function(){return this.mode?this.processor.volumeEnv:this.vol};this.setvolume=function(l){this.mode=l&16?!0:!1;this.vol=l};this.next=function(){this.position+=this.step;2147483647<this.position&&(this.position-=2147483647)};this.computeTone=function(l,v){var w=
l<<8|v;5>w?(this.position=1073741824,this.step=0):(w=this.processor.clock/((w<<3)*this.processor.audioFreq),this.step=Math.floor(1073741824*w))};this.computeVolume=function(){var l;this.digidrum&&(l=this.drumPos>>YmConst_DRUM_PREC,this.vol=this.drum.data[l]/16,this.mixTone=this.mixNoise=65535,this.drumPos+=this.drumStep,l=this.drumPos>>YmConst_DRUM_PREC,l>=this.drum.size&&(this.digidrum=!1))};this.drumStart=function(l){this.digidrum=!0;this.drumPos=0;this.drumStep=(this.drumFreq<<15)/this.processor.audioFreq};
this.drumStop=function(){this.digidrum=!1}}function Digidrum(l){this.data;this.repeatLen;this.size;this.wave=null;this.size=l;this.wave=new dataType;this.convert=function(l){var v;this.data=[];if(l&YmConst_DRUM_4BITS)for(v=0;v<this.size;++v)l=(this.wave.readByte()&15)>>7,this.data[v]=YmConst_MONO[l];else for(v=0;v<this.size;++v)this.data[v]=this.wave.readByte();this.wave=null}}
function dataType(){this.data;this.pos=0;this.endian="BIG";this.readBytes=function(l,p){for(var v="",w=0;w<p;w++)v+=this.data[l+this.pos++];return v};this.readMultiByte=function(l,p){if("txt"==p){for(var v="",w=0;w<l;w++)v+=this.data[this.pos++];return v}};this.readInt=function(){var l=parseInt(this.data[this.pos+0].charCodeAt(0).toString(16),16),p=parseInt(this.data[this.pos+1].charCodeAt(0).toString(16),16),v=parseInt(this.data[this.pos+2].charCodeAt(0).toString(16),16),w=parseInt(this.data[this.pos+
3].charCodeAt(0).toString(16),16),l="BIG"==this.endian?l<<24|p<<16|v<<8|w:w<<24|v<<16|p<<8|l;this.pos+=4;return l};this.readShort=function(){var l=parseInt(this.data[this.pos+0].charCodeAt(0).toString(16),16),p=parseInt(this.data[this.pos+1].charCodeAt(0).toString(16),16);this.pos+=2;return l<<8|p};this.readByte=function(){var l=parseInt(this.data[this.pos].charCodeAt(0).toString(16),16);this.pos+=1;return l};this.readString=function(){for(var l="";;)if(0!=this.data[this.pos++].charCodeAt(0))l+=this.data[this.pos-
1];else return l};this.substr=function(l,p){return this.data.substr(l,p)};this.bytesAvailable=function(){return this.length-this.pos}}
function LHa(){this.data;this.source;this.buffer;this.output;this.srcSize;this.dstSize;this.srcPos;this.dstPos;this.c_Table;this.p_Table;this.c_Len;this.p_Len;this.l_Tree;this.r_Tree;this.bitBuffer;this.bitCount;this.subBuffer;this.blockSize;this.fillBufferSize;this.fillIndex;this.decodei;this.decodej;this.data="";this.buffer=[];this.output=[];this.c_Table=[];this.p_Table=[];this.c_Len=[];this.p_Len=[];this.l_Tree=[];this.r_Tree=[];this.unpack=function(l){this.header=new LHaHeader(l);if(0==this.header.size||
"-lh5-"!=this.header.method||0!=this.header.level)return l.data;this.source=l;this.srcSize=this.header.packed;this.srcPos=this.source.pos;this.dstSize=this.header.original;this.subBuffer=this.bitCount=this.bitBuffer=this.fillBufferSize=0;this.fillBuffer(16);this.decodej=this.blockSize=0;l=this.dstSize;for(var p,v;0!=l;){p=8192<l?8192:l;this.decode(p);v=p>this.dstSize?this.dstSize:p;if(0<v){for(var w=this.output.pos=0;w<v;w++)this.data+=String.fromCharCode(this.output[w]);this.dstPos+=v;this.dstSize-=
v}l-=p}this.buffer="";this.output=[];return this.data};this.decode=function(l){for(var p,v=0;0<=--this.decodej;)if(this.output[v]=this.output[this.decodei],this.decodei=++this.decodei&8191,++v==l)return;for(;;)if(p=this.decode_c(),255>=p){if(this.output[v]=p,++v==l)break}else for(this.decodej=p-253,this.decodei=v-this.decode_p()-1&8191;0<=--this.decodej;)if(this.output[v]=this.output[this.decodei],this.decodei=++this.decodei&8191,++v==l)return};this.decode_c=function(){var l,p=0;0==this.blockSize&&
(this.blockSize=this.getBits(16),this.read_p(19,5,3),this.read_c(),this.read_p(14,4,-1));this.blockSize--;l=this.c_Table[this.bitBuffer>>4];if(510<=l){p=8;do l=this.bitBuffer&p?this.r_Tree[l]:this.l_Tree[l],p>>=1;while(510<=l)}this.fillBuffer(this.c_Len[l]);return l&65535};this.decode_p=function(){var l=this.p_Table[this.bitBuffer>>8],p=0;if(14<=l){p=128;do l=this.bitBuffer&p?this.r_Tree[l]:this.l_Tree[l],p>>=1;while(14<=l)}this.fillBuffer(this.p_Len[l]);0!=l&&(l=(1<<l-1)+this.getBits(l-1));return l&
65535};this.read_c=function(){var l,p=0,v=0,w=this.getBits(9);if(0==w){l=this.getBits(9);for(p=0;510>p;++p)this.c_Len[p]=0;for(p=0;4096>p;++p)this.c_Table[p]=l}else{for(;p<w;){l=this.p_Table[this.bitBuffer>>8];if(19<=l){v=128;do l=this.bitBuffer&v?this.r_Tree[l]:this.l_Tree[l],v>>=1;while(19<=l)}this.fillBuffer(this.p_Len[l]);if(2>=l)for(l=0==l?1:1==l?this.getBits(4)+3:this.getBits(9)+20;0<=--l;)this.c_Len[p++]=0;else this.c_Len[p++]=l-2}for(;510>p;)this.c_Len[p++]=0;this.makeTable(510,this.c_Len,
12,this.c_Table)}};this.read_p=function(l,p,v){var w=0,z=0,y=this.getBits(p);if(0==y){p=this.getBits(p);for(w=0;w<l;++w)this.p_Len[w]=0;for(w=0;256>w;++w)this.p_Table[w]=p}else{for(;w<y;){p=this.bitBuffer>>13;if(7==p)for(z=4096;z&this.bitBuffer;)z>>=1,p++;this.fillBuffer(7>p?3:p-3);this.p_Len[w++]=p;if(w==v)for(p=this.getBits(2);0<=--p;)this.p_Len[w++]=0}for(;w<l;)this.p_Len[w++]=0;this.makeTable(l,this.p_Len,8,this.p_Table)}};this.getBits=function(l){var p=this.bitBuffer>>16-l;this.fillBuffer(l);
return p&65535};this.fillBuffer=function(l){var p;for(this.bitBuffer=this.bitBuffer<<l&65535;l>this.bitCount;)this.bitBuffer|=this.subBuffer<<(l-=this.bitCount),this.bitBuffer&=65535,0==this.fillBufferSize&&(this.fillIndex=0,p=4064<this.srcSize?4064:this.srcSize,0<p&&(this.source.pos=this.srcPos,this.buffer=this.source.readBytes(0,p),this.srcPos+=p,this.srcSize-=p),this.fillBufferSize=p),0<this.fillBufferSize?(this.fillBufferSize--,this.subBuffer=this.buffer[this.fillIndex++].charCodeAt(0)):this.subBuffer=
0,this.bitCount=8;this.bitBuffer|=this.subBuffer>>(this.bitCount-=l);this.bitBuffer&=65535};this.makeTable=function(l,p,v,w){var z=l,y,x,D,A,E,H,B,J,L;y=[];var K=[],G=[],F=1<<15-v;for(x=0;x<l;++x)y[x]=0;for(x=0;x<l;++x)y[p[x]]++;G[1]=0;for(x=1;17>x;++x)G[x+1]=G[x]+(y[x]<<16-x)&65535;if(0!=G[17])return!1;D=16-v;for(x=1;x<=v;++x)G[x]>>=D,K[x]=1<<v-x;for(;17>x;)K[x]=1<<16-x++;x=G[v+1]>>D;if(0!=x)for(A=1<<v;x!=A;)w[x++]=0;for(y=0;y<l;++y)if(0!=(E=p[y])){H=G[E]+K[E];if(E<=v)for(x=G[E];x<H;++x)w[x]=y;else{x=
E-v;A=G[E];B=A>>D;for(J=w;0!=x;)0==J[B]&&(this.l_Tree[z]=0,this.r_Tree[z]=0,J[B]=z++),L=A&F?this.r_Tree:this.l_Tree,A<<=1,x--;L[J[B]]=y}G[E]=H}return!0}}
function LHaHeader(l){this.size;this.checksum;this.method;this.packed;this.original;this.timeStamp;this.attribute;this.level;this.nameLength;this.name;l.endian="LITTLE";l.pos=0;this.size=l.readByte();this.checksum=l.readByte();this.method=l.readMultiByte(5,"txt");this.packed=l.readInt();this.original=l.readInt();this.timeStamp=l.readInt();this.attribute=l.readByte();this.level=l.readByte();this.nameLength=l.readByte();this.name=l.readMultiByte(this.nameLength,"txt");l.readShort()}
(function(){function l(l,t){var d=Object.create(null,{endian:{value:1,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},buffer:{value:null,writable:!0},view:{value:null,writable:!0},bytesAvailable:{get:function(){return this.length-this.index}},position:{get:function(){return this.index},set:function(a){0>a?a=0:a>this.length&&(a=this.length);this.index=a}},clear:{value:function(){this.buffer=new ArrayBuffer;this.view=null;this.index=this.length=0}},readAt:{value:function(a){return this.view.getUint8(a)}},
readByte:{value:function(){return this.view.getInt8(this.index++)}},readShort:{value:function(){var a=this.view.getInt16(this.index,this.endian);this.index+=2;return a}},readInt:{value:function(){var a=this.view.getInt32(this.index,this.endian);this.index+=4;return a}},readUbyte:{value:function(){return this.view.getUint8(this.index++)}},readUshort:{value:function(){var a=this.view.getUint16(this.index,this.endian);this.index+=2;return a}},readUint:{value:function(){var a=this.view.getUint32(this.index,
this.endian);this.index+=4;return a}},readBytes:{value:function(a,g,k){a=a.view;var c=this.index,e=this.view;(k+=c)>this.length&&(k=this.length);for(;c<k;++c)a.setUint8(g++,e.getUint8(c));this.index=c}},readString:{value:function(a){var g=this.index,k=this.view,c="";(a+=g)>this.length&&(a=this.length);for(;g<a;++g)c+=String.fromCharCode(k.getUint8(g));this.index=a;return c}},writeAt:{value:function(a,g){this.view.setUint8(a,g)}},writeByte:{value:function(a){this.view.setInt8(this.index++,a)}},writeShort:{value:function(a){this.view.setInt16(this.index,
a);this.index+=2}},writeInt:{value:function(a){this.view.setInt32(this.index,a);this.index+=4}}});d.buffer=l;d.view=new DataView(l);d.length=l.byteLength;return Object.seal(d)}function p(){return Object.create(null,{l:{value:0,writable:!0},r:{value:0,writable:!0},next:{value:null,writable:!0}})}function v(){return Object.create(null,{player:{value:null,writable:!0},channels:{value:[],writable:!0},buffer:{value:[],writable:!0},samplesTick:{value:0,writable:!0},samplesLeft:{value:0,writable:!0},remains:{value:0,
writable:!0},completed:{value:0,writable:!0},bufferSize:{get:function(){return this.buffer.length},set:function(l){var t;t=this.buffer.length||0;if(!(l==t||512>l)&&(this.buffer.length=l,l>t))for(this.buffer[t]=p(),t=++t;t<l;++t)this.buffer[t]=this.buffer[t-1].next=p()}},complete:{get:function(){return this.completed},set:function(l){this.completed=l^this.player.loopSong}},reset:{value:function(){var l=this.channels[0],t=this.buffer[0];for(this.completed=this.remains=this.samplesLeft=0;l;)l.initialize(),
l=l.next;for(;t;)t.l=t.r=0,t=t.next}},restore:{configurable:!0,value:function(){}}})}function w(){var F=Object.create(null,{context:{value:null,writable:!0},node:{value:null,writable:!0},analyse:{value:0,writable:!0},endian:{value:0,writable:!0},sampleRate:{value:0,writable:!0},playSong:{value:0,writable:!0},lastSong:{value:0,writable:!0},version:{value:0,writable:!0},title:{value:"",writable:!0},channels:{value:0,writable:!0},loopSong:{value:1,writable:!0},speed:{value:0,writable:!0},tempo:{value:0,
writable:!0},mixer:{value:null,writable:!0},tick:{value:0,writable:!0},paused:{value:0,writable:!0},callback:{value:null,writable:!0},quality:{configurable:!0,set:function(l){this.callback=l?this.mixer.accurate.bind(this.mixer):this.mixer.fast.bind(this.mixer)}},toggle:{value:function(l){this.mixer.channels[l].mute^=1}},setup:{configurable:!0,value:function(){}},load:{value:function(t){this.lastSong=this.playSong=this.version=0;this.mixer.restore();t.view||(t=l(t));t.position=0;if(67324752==t.readUint())if(window.neoart.Unzip)t=
z(t),t=t.uncompress(t.entries[0]);else throw"Unzip support is not available.";t.endian=this.endian;t.position=0;this.loader(t);this.version&&this.setup();return this.version}},play:{value:function(){var l;this.version&&(this.paused?this.paused=0:(this.initialize(),this.node=this.context.createScriptProcessor(this.mixer.bufferSize),this.node.onaudioprocess=this.callback),this.analyse&&window.neoart.Flectrum?(l=window.neoart.analyserNode=this.context.createAnalyser(),this.node.connect(l),l.connect(this.context.destination)):
this.node.connect(this.context.destination),l=document.createEvent("Event"),l.initEvent("flodPlay",!0,!1),document.dispatchEvent(l))}},pause:{value:function(){if(this.node){this.node.disconnect();this.paused=1;var l=document.createEvent("Event");l.initEvent("flodPause",!0,!1);document.dispatchEvent(l)}}},stop:{value:function(){if(this.node){this.node.disconnect();this.node.onaudioprocess=this.node=null;this.paused=0;this.restore&&this.restore();var l=document.createEvent("Event");l.initEvent("flodStop",
!0,!1);document.dispatchEvent(l)}}},reset:{value:function(){this.tick=0;this.mixer.initialize();this.mixer.samplesTick=2.5*this.sampleRate/this.tempo>>0}}});window.neoart.audioContext||(window.neoart.audioContext=new AudioContext);F.context=window.neoart.audioContext;F.sampleRate=F.context.sampleRate;return F}function z(F){function t(c){var b=Object.create(null,{count:{value:null,writable:!0},symbol:{value:null,writable:!0}});b.count=new Uint16Array(c);b.symbol=new Uint16Array(c);return Object.seal(b)}
function d(){var b=Object.create(null,{output:{value:null,writable:!0},inpbuf:{value:null,writable:!0},inpcnt:{value:0,writable:!0},outcnt:{value:0,writable:!0},bitbuf:{value:0,writable:!0},bitcnt:{value:0,writable:!0},flencode:{value:null,writable:!0},fdiscode:{value:null,writable:!0},dlencode:{value:null,writable:!0},ddiscode:{value:null,writable:!0},input:{set:function(c){this.inpbuf=c[0];this.inpbuf.endian=c[2];this.inpcnt=this.inpbuf.position=0;this.output=l(new ArrayBuffer(c[1]));this.output.endian=
c[2];this.outcnt=this.output.position=0}},inflate:{value:function(){var c,b;do if(b=this.bits(1),c=this.bits(2),c=0==c?this.stored():1==c?this.codes(this.flencode,this.fdiscode):2==c?this.dynamic():1)throw"Invalid block type.";while(!b)}},initialize:{value:function(){var c=new Uint8Array(288),b=0;this.flencode=t(288);for(this.fdiscode=t(30);144>b;++b)c[b]=8;for(;256>b;++b)c[b]=9;for(;280>b;++b)c[b]=7;for(;288>b;++b)c[b]=8;this.construct(this.fdiscode,c,288);for(b=0;30>b;++b)c[b]=5;this.construct(this.fdiscode,
c,30);this.dlencode=t(286);this.ddiscode=t(30)}},construct:{value:function(c,b,e){for(var g=0,f=1,a=new Uint16Array(16),k=0;16>g;++g)c.count[g]=0;for(;k<e;++k)c.count[b[k]]++;if(c.count[0]==e)return 0;for(g=1;16>g;++g)if(f<<=1,f-=c.count[g],0>f)return f;for(g=1;15>g;++g)a[g+1]=a[g]+c.count[g];for(k=0;k<e;++k)0!=b[k]&&(c.symbol[a[b[k]]++]=k);return f}},bits:{value:function(c){for(var b=this.bitbuf,e=this.inpbuf.length;this.bitcnt<c;){if(this.inpcnt==e)throw"Available inflate data did not terminate.";
b|=this.inpbuf.readAt(this.inpcnt++)<<this.bitcnt;this.bitcnt+=8}this.bitbuf=b>>c;this.bitcnt-=c;return b&(1<<c)-1}},codes:{value:function(b,f){var a,d,h;do{h=this.decode(b);if(0>h)return h;if(256>h)this.output.writeAt(this.outcnt++,h);else if(256<h){h-=257;if(29<=h)throw ERRRO7;d=g[h]+this.bits(k[h]);h=this.decode(f);if(0>h)return h;a=c[h]+this.bits(e[h]);if(a>this.outcnt)throw"Distance is too far back.";for(a=this.outcnt-a;d--;)this.output.writeAt(this.outcnt++,this.output.readAt(a++))}}while(256!=
h);return 0}},decode:{value:function(c){for(var b=this.bitbuf,e=0,g,f=0,a=0,k=this.inpbuf.length,d=this.bitcnt,h=1;;){for(;d--;){e|=b&1;b>>=1;g=c.count[h];if(e<f+g)return this.bitbuf=b,this.bitcnt=this.bitcnt-h&7,c.symbol[a+(e-f)];a+=g;f+=g;f<<=1;e<<=1;++h}d=16-h;if(!d)break;if(this.inpcnt==k)throw"Available inflate data did not terminate.";b=this.inpbuf.readAt(this.inpcnt++);8<d&&(d=8)}return-9}},stored:{value:function(){var c=this.inpbuf.length,b;this.bitbuf=this.bitcnt=0;if(this.inpcnt+4>c)throw"Available inflate data did not terminate.";
b=this.inpbuf.readAt(this.inpcnt++);b|=this.inpbuf.readAt(this.inpcnt++)<<8;if(this.inpbuf.readAt(this.inpcnt++)!=(~b&255)||this.inpbuf.readAt(this.inpcnt++)!=(~b>>8&255))throw"Stored block length did not match one's complement.";if(this.inpcnt+b>c)throw"Available inflate data did not terminate.";for(;b--;)this.output.writeAt(this.outcnt++,this.inpbuf.readAt(this.inpcnt++));return 0}},dynamic:{value:function(){var c=new Uint8Array(316),b;b=0;var e,g=this.bits(5)+257,a=this.bits(5)+1;e=this.bits(4)+
4;var k=g+a,d;if(286<g||30<a)throw"Too many length or distance codes.";for(;b<e;++b)c[f[b]]=this.bits(3);for(;19>b;++b)c[f[b]]=0;if(b=this.construct(this.dlencode,c,19))throw"Code lengths codes incomplete.";for(b=0;b<k;)if(d=this.decode(this.dlencode),16>d)c[b++]=d;else{e=0;if(16==d){if(0==b)throw"Repeat lengths with no first length.";e=c[b-1];d=3+this.bits(2)}else d=17==d?3+this.bits(3):11+this.bits(7);if(b+d>k)throw"Repeat more than specified lengths.";for(;d--;)c[b++]=e}b=this.construct(this.dlencode,
c,g);if(0>b||0<b&&1!=g-this.dlencode.count[0])throw"Invalid literal/length code lengths.";b=this.construct(this.ddiscode,c.subarray(g),a);if(0>b||0<b&&1!=a-this.ddiscode.count[0])throw"Invalid distance code lengths.";return this.codes(this.dlencode,this.ddiscode)}}});b.initialize();return Object.seal(b)}function a(){return Object.create(null,{name:{value:"",writable:!0},extra:{value:null,writable:!0},version:{value:0,writable:!0},flag:{value:0,writable:!0},method:{value:0,writable:!0},time:{value:0,
writable:!0},crc:{value:0,writable:!0},compressed:{value:0,writable:!0},size:{value:0,writable:!0},offset:{value:0,writable:!0},date:{get:function(){return new Date((this.time>>25&127)+1980,(this.time>>21&15)-1,this.time>>16&31,this.time>>11&31,this.time>>5&63,(this.time&31)<<1)}},isDirectory:{get:function(){return"/"==this.name.charAt(this.name.length-1)}}})}if(!F)return null;var g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],k=[0,0,0,0,0,0,0,0,1,1,1,1,
2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],e=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],b=Object.create(null,{endian:{value:1,writable:!0},entries:{value:null,writable:!0},stream:{value:null,writable:!0},uncompress:{value:function(b){var c=this.stream,e;e=!1;var g,f,a;if(!b)return null;if("string"==typeof b){a=this.entries.length;
for(g=0;g<a;++g)if(f=this.entries[g],f.name==b){b=f;e=!0;break}if(!e)return null}c.position=b.offset+28;e=c.readUshort();c.position+=b.name.length+e;if(b.compressed)switch(e=l(new ArrayBuffer(b.compressed),this.endian),c.readBytes(e,0,b.compressed),b.method){case 0:return e;case 8:return c=d(),c.input=[e,b.size,this.endian],c.inflate(),c.output;default:throw"Compression method not supported.";}}},parseCentral:{value:function(){var b=this.stream,c,e=l(new ArrayBuffer(46),this.endian),g,f=this.entries.length,
k;for(g=0;g<f;++g){b.readBytes(e,0,46);e.position=0;if(33639248!=e.readUint())throw"Unexpected end of archive.";e.position+=24;k=e.readUshort();if(!k)throw"Unexpected end of archive.";c=a();c.name=b.readString(k);if(k=e.readUshort())c.extra=l(new ArrayBuffer(k),this.endian),b.readBytes(c.extra,0,k);b.position+=e.readUshort();e.position=6;c.version=e.readUshort();c.flag=e.readUshort();if(1==(c.flag&1))throw"Encrypted archive not supported.";c.method=e.readUshort();c.time=e.readUint();c.crc=e.readUint();
c.compressed=e.readUint();c.size=e.readUint();e.position=42;c.offset=e.readUint();Object.freeze(c);this.entries[g]=c}}},parseEnd:{value:function(){var b=this.stream,c=b.length-22,e=c-65536;0>e&&(e=0);do if(80==b.readAt(c)&&(b.position=c,101010256==b.readUint()))break;while(--c>e);if(c==e)throw"The archive is either in unknown format or damaged.";b.position=c+10;this.entries=[];this.entries.length=b.readUshort();b.position=c+16;b.position=b.readUint();this.parseCentral()}}});F.view||(F=l(F));F.endian=
1;F.position=0;b.stream=F;b.parseEnd();return Object.seal(b)}function y(l){var t=Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},panning:{value:0,writable:!0},delay:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},audena:{value:0,writable:!0},audcnt:{value:0,writable:!0},audloc:{value:0,writable:!0},audper:{value:0,writable:!0},audvol:{value:0,writable:!0},timer:{value:0,writable:!0},level:{value:0,writable:!0},ldata:{value:0,writable:!0},
rdata:{value:0,writable:!0},enabled:{get:function(){return this.audena},set:function(d){d!=this.audena&&(this.audena=d,this.audloc=this.pointer,this.audcnt=this.pointer+this.length,this.timer=1,d&&(this.delay+=2))}},period:{set:function(d){0>d?d=0:65535<d&&(d=65535);this.audper=d}},volume:{set:function(d){0>d?d=0:64<d&&(d=64);this.audvol=d}},resetData:{value:function(){this.rdata=this.ldata=0}},initialize:{value:function(){this.audloc=this.audcnt=this.audena=0;this.audper=50;this.length=this.pointer=
this.delay=this.rdata=this.ldata=this.timer=this.audvol=0}}});t.panning=t.level=0==(++l&2)?-1:1;return Object.seal(t)}function x(){return Object.create(null,{active:{value:0,writable:!0},forced:{value:-1,writable:!0},l0:{value:0,writable:!0},l1:{value:0,writable:!0},l2:{value:0,writable:!0},l3:{value:0,writable:!0},l4:{value:0,writable:!0},r0:{value:0,writable:!0},r1:{value:0,writable:!0},r2:{value:0,writable:!0},r3:{value:0,writable:!0},r4:{value:0,writable:!0},initialize:{value:function(){this.r0=
this.r1=this.r2=this.r3=this.r4=this.l0=this.l1=this.l2=this.l3=this.l4=0}},process:{value:function(l,t){var d=.5139651662784244;0==l&&(this.l0=.4860348337215757*t.l+d*this.l0,this.r0=.4860348337215757*t.r+d*this.r0,d=.06850445132502514,t.l=this.l1=.9314955486749749*this.l0+d*this.l1,t.r=this.r1=.9314955486749749*this.r0+d*this.r1);0<(this.active|this.forced)&&(d=.47866541564678,this.l2=.52133458435322*t.l+d*this.l2,this.r2=.52133458435322*t.r+d*this.r2,this.l3=.52133458435322*this.l2+d*this.l3,this.r3=
.52133458435322*this.r2+d*this.r3,t.l=this.l4=.52133458435322*this.l3+d*this.l4,t.r=this.r4=.52133458435322*this.r3+d*this.r4);1<t.l?t.l=1:-1>t.l&&(t.l=-1);1<t.r?t.r=1:-1>t.r&&(t.r=-1)}}})}function D(){return Object.create(null,{note:{value:0,writable:!0},sample:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}function A(){return Object.create(null,{name:{value:"",writable:!0},length:{value:0,writable:!0},loop:{value:0,writable:!0},repeat:{value:0,writable:!0},volume:{value:0,
writable:!0},pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0}})}function E(){return Object.create(null,{pattern:{value:0,writable:!0},transpose:{value:0,writable:!0}})}function H(){var l=v();Object.defineProperties(l,{filter:{value:null,writable:!0},model:{value:1,writable:!0},memory:{value:[],writable:!0},loopPtr:{value:0,writable:!0},loopLen:{value:4,writable:!0},clock:{value:0,writable:!0},master:{value:0,writable:!0},ready:{value:0,writable:!0},volume:{set:function(l){0<l?(64<l&&(l=
64),this.master=l/64*.00390625):this.master=0}},initialize:{value:function(){var l=this.memory.length,d=l+this.loopLen;this.reset();this.filter.initialize();if(!this.ready)for(this.ready=1,this.loopPtr=l;l<d;++l)this.memory[l]=0}},restore:{value:function(){this.ready=0;this.memory.length=0}},store:{value:function(l,d,a){var g,k,c=l.position,e=this.memory.length;a&&(l.position=a);k=l.position+d;k>=l.length&&(g=k-l.length,d=l.length-l.position);k=e;for(d+=e;k<d;++k)this.memory[k]=l.readByte();for(d+=
g;k<d;++k)this.memory[k]=0;a&&(l.position=c);return e}},fast:{value:function(l){var d,a,g=this.memory,k,c=0,e,f=0,b,h,m=this.bufferSize,q,n,u;if(this.completed){if(!this.remains){this.player.stop();return}m=this.remains}for(;c<m;){this.samplesLeft||(this.player.process(),this.samplesLeft=this.samplesTick,this.completed&&(m=c+this.samplesTick,m>this.bufferSize&&(this.remains=m-this.bufferSize,m=this.bufferSize)));n=this.samplesLeft;c+n>=m&&(n=m-c);e=f+n;for(d=this.channels[0];d;){h=this.buffer[f];
if(d.audena&&60<d.audper)for(q=d.audper/this.clock,u=d.audvol*this.master,k=u*(1-d.level),b=u*(1+d.level),a=f;a<e;++a)d.delay?d.delay--:1>--d.timer&&(d.mute||(u=.0078125*g[d.audloc],d.ldata=u*k,d.rdata=u*b),d.audloc++,d.timer+=q,d.audloc>=d.audcnt&&(d.audloc=d.pointer,d.audcnt=d.pointer+d.length)),h.l+=d.ldata,h.r+=d.rdata,h=h.next;else for(a=f;a<e;++a)h.l+=d.ldata,h.r+=d.rdata,h=h.next;d=d.next}f=e;c+=n;this.samplesLeft-=n}u=this.model;g=this.filter;h=this.buffer[0];d=l.outputBuffer.getChannelData(0);
l=l.outputBuffer.getChannelData(1);for(a=0;a<m;++a)g.process(u,h),d[a]=h.l,l[a]=h.r,h.l=h.r=0,h=h.next}}});l.channels[0]=y(0);l.channels[0].next=l.channels[1]=y(1);l.channels[1].next=l.channels[2]=y(2);l.channels[2].next=l.channels[3]=y(3);l.bufferSize=8192;l.filter=x();l.master=.00390625;return Object.seal(l)}function B(l){var t=w();Object.defineProperties(t,{quality:{set:function(d){this.callback=this.mixer.fast.bind(this.mixer)}},stereo:{set:function(d){var a=this.mixer.channels[0];for(0>d?d=0:
1<d&&(d=1);a;)a.level=d*a.panning,a=a.next}},volume:{set:function(d){0>d?d=0:1<d&&(d=1);this.mixer.master=.00390625*d}},frequency:{value:function(d){d?(this.mixer.clock=3579545/this.sampleRate,this.mixer.samplesTick=735):(this.mixer.clock=3546895/this.sampleRate,this.mixer.samplesTick=882)}}});t.mixer=l||H();t.mixer.player=t;t.frequency(0);t.channels=4;t.endian=0;t.quality=0;t.speed=6;t.tempo=125;return t}function J(){return Object.create(null,{next:{value:null,writable:!0},mute:{value:0,writable:!0},
enabled:{value:0,writable:!0},sample:{value:null,writable:!0},length:{value:0,writable:!0},index:{value:0,writable:!0},pointer:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},speed:{value:0,writable:!0},dir:{value:0,writable:!0},oldSample:{value:null,writable:!0},oldLength:{value:0,writable:!0},oldPointer:{value:0,writable:!0},oldFraction:{value:0,writable:!0},oldSpeed:{value:0,writable:!0},oldDir:{value:0,writable:!0},volume:{value:0,writable:!0},lvol:{value:0,writable:!0},
rvol:{value:0,writable:!0},panning:{value:128,writable:!0},lpan:{value:.5,writable:!0},rpan:{value:.5,writable:!0},ldata:{value:0,writable:!0},rdata:{value:0,writable:!0},mixCounter:{value:0,writable:!0},lmixRampU:{value:0,writable:!0},lmixDeltaU:{value:0,writable:!0},rmixRampU:{value:0,writable:!0},rmixDeltaU:{value:0,writable:!0},lmixRampD:{value:0,writable:!0},lmixDeltaD:{value:0,writable:!0},rmixRampD:{value:0,writable:!0},rmixDeltaD:{value:0,writable:!0},volCounter:{value:0,writable:!0},lvolDelta:{value:0,
writable:!0},rvolDelta:{value:0,writable:!0},panCounter:{value:0,writable:!0},lpanDelta:{value:0,writable:!0},rpanDelta:{value:0,writable:!0},initialize:{value:function(){this.enabled=0;this.sample=null;this.dir=this.speed=this.fraction=this.delta=this.pointer=this.index=this.length=0;this.oldSample=null;this.rvol=this.lvol=this.volume=this.oldDir=this.oldSpeed=this.oldFraction=this.oldPointer=this.oldLength=0;this.panning=128;this.rpan=this.lpan=.5;this.rpanDelta=this.lpanDelta=this.panCounter=this.rvolDelta=
this.lvolDelta=this.volCounter=this.rmixDeltaD=this.rmixRampD=this.lmixDeltaD=this.lmixRampD=this.rmixDeltaU=this.rmixRampU=this.lmixDeltaU=this.lmixRampU=this.mixCounter=this.rdata=this.ldata=0}}})}function L(){return Object.create(null,{name:{value:"",writable:!0},bits:{value:8,writable:!0},volume:{value:0,writable:!0},length:{value:0,writable:!0},data:{value:[],writable:!0},loopMode:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopLen:{value:0,writable:!0},store:{value:function(l){var t=
0,d,a=this.length,g;this.loopLen||(this.loopMode=0);g=l.position;this.loopMode?(a=this.loopStart+this.loopLen,this.data=new Float32Array(a+1)):this.data=new Float32Array(this.length+1);if(8==this.bits)for(g+a>l.length&&(a=l.length-g),d=0;d<a;d++)t=l.readByte()+t,-128>t?t+=256:127<t&&(t-=256),this.data[d]=.0078125*t;else for(g+(a<<1)>l.length&&(a=l.length-g>>1),d=0;d<a;d++)t=l.readShort()+t,-32768>t?t+=65536:32767<t&&(t-=65536),this.data[d]=3.051758E-5*t;t=g+length;this.loopMode?(this.length=this.loopStart+
this.loopLen,this.data[a]=1==this.loopMode?this.data[this.loopStart]:this.data[a-1]):this.data[this.length]=0;if(a!=this.length)for(g=this.data[a-1],d=a;d<this.length;d++)this.data[d]=g;l.position=t<l.length?t:l.length-1}}})}function K(){var l=v();Object.defineProperties(l,{setup:{value:function(l){var d=1;this.channels.length=l;for(this.channels[0]=J();d<l;++d)this.channels[d]=this.channels[d-1].next=J()}},initialize:{value:function(){this.reset()}},fast:{value:function(l){var d,a,g,k=0,c,e=0,f,
b,h=this.bufferSize,m,q;if(this.completed){if(!this.remains){this.player.stop();return}h=this.remains}for(;k<h;){this.samplesLeft||(this.player.process(),this.player.fast(),this.samplesLeft=this.samplesTick,this.completed&&(h=k+this.samplesTick,h>this.bufferSize&&(this.remains=h-this.bufferSize,h=this.bufferSize)));m=this.samplesLeft;k+m>=h&&(m=h-k);c=e+m;for(d=this.channels[0];d;){if(d.enabled)for(f=d.sample,a=f.data,b=this.buffer[e],g=e;g<c;++g){if(d.index!=d.pointer){if(d.index>=d.length)if(f.loopMode)d.pointer=
f.loopStart+(d.index-d.length),d.length=f.length,2==f.loopMode&&(d.dir=d.dir?0:f.length+f.loopStart-1);else{d.enabled=0;break}else d.pointer=d.index;d.mute?(d.ldata=0,d.rdata=0):(q=d.dir?a[d.dir-d.pointer]:a[d.pointer],d.ldata=q*d.lvol,d.rdata=q*d.rvol)}d.index=d.pointer+d.delta;1<=(d.fraction+=d.speed)&&(d.index++,d.fraction--);b.l+=d.ldata;b.r+=d.rdata;b=b.next}d=d.next}e=c;k+=m;this.samplesLeft-=m}b=this.buffer[0];d=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);for(g=0;g<
h;++g)1<b.l?b.l=1:-1>b.l&&(b.l=-1),1<b.r?b.r=1:-1>b.r&&(b.r=-1),d[g]=b.l,l[g]=b.r,b.l=b.r=0,b=b.next}},accurate:{value:function(l){var d,a,g,k,c,e=0,f,b=0,h,m,q,n,u=this.bufferSize,r,C;if(this.completed){if(!this.remains){this.player.stop();return}u=this.remains}for(;e<u;){this.samplesLeft||(this.player.process(),this.player.accurate(),this.samplesLeft=this.samplesTick,this.completed&&(u=e+this.samplesTick,u>this.bufferSize&&(this.remains=u-this.bufferSize,u=this.bufferSize)));r=this.samplesLeft;
e+r>=u&&(r=u-e);f=b+r;for(d=this.channels[0];d;){if(d.enabled){m=d.sample;a=m.data;if(q=d.oldSample)g=q.data;n=this.buffer[b];for(c=b;c<f;++c){C=d.mute?0:a[d.pointer];C+=(a[d.pointer+d.dir]-C)*d.fraction;1<=(d.fraction+=d.speed)&&(k=d.fraction>>0,d.fraction-=k,0<d.dir?(d.pointer+=k,d.pointer>d.length&&(d.fraction+=d.pointer-d.length,d.pointer=d.length)):(d.pointer-=k,d.pointer<d.length&&(d.fraction+=d.length-d.pointer,d.pointer=d.length)));d.mixCounter?(q?(h=d.mute?0:g[d.oldPointer],h+=(g[d.oldPointer+
d.oldDir]-h)*d.oldFraction,1<(d.oldFraction+=d.oldSpeed)&&(k=d.oldFraction>>0,d.oldFraction-=k,0<d.oldDir?(d.oldPointer+=k,d.oldPointer>d.oldLength&&(d.oldFraction+=d.oldPointer-d.oldLength,d.oldPointer=d.oldLength)):(d.oldPointer-=k,d.oldPointer<d.oldLength&&(d.oldFraction+=d.oldLength-d.oldPointer,d.oldPointer=d.oldLength))),n.l+=C*d.lmixRampU+h*d.lmixRampD,n.r+=C*d.rmixRampU+h*d.rmixRampD,d.lmixRampD-=d.lmixDeltaD,d.rmixRampD-=d.rmixDeltaD):(n.l+=C*d.lmixRampU,n.r+=C*d.rmixRampU),d.lmixRampU+=
d.lmixDeltaU,d.rmixRampU+=d.rmixDeltaU,d.mixCounter--,d.oldPointer==d.oldLength&&(q.loopMode?1==q.loopMode?(d.oldPointer=q.loopStart,d.oldLength=q.length):0<d.oldDir?(d.oldPointer=q.length-1,d.oldLength=q.loopStart,d.oldDir=-1):(--d.oldFraction,d.oldPointer=q.loopStart,d.oldLength=q.length,d.oldDir=1):(q=null,d.oldPointer=0))):(n.l+=C*d.lvol,n.r+=C*d.rvol,d.volCounter?(d.lvol+=d.lvolDelta,d.rvol+=d.rvolDelta,d.volCounter--):d.panCounter&&(d.lpan+=d.lpanDelta,d.rpan+=d.rpanDelta,d.panCounter--,d.lvol=
d.volume*d.lpan,d.rvol=d.volume*d.rpan));if(d.pointer==d.length)if(m.loopMode)1==m.loopMode?(d.pointer=m.loopStart,d.length=m.length):0<d.dir?(d.pointer=m.length-1,d.length=m.loopStart,d.dir=-1):(--d.fraction,d.pointer=m.loopStart,d.length=m.length,d.dir=1);else{d.enabled=0;break}n=n.next}}d=d.next}b=f;e+=r;this.samplesLeft-=r}n=this.buffer[0];d=l.outputBuffer.getChannelData(0);l=l.outputBuffer.getChannelData(1);for(c=0;c<u;++c)1<n.l?n.l=1:-1>n.l&&(n.l=-1),1<n.r?n.r=1:-1>n.r&&(n.r=-1),d[c]=n.l,l[c]=
n.r,n.l=n.r=0,n=n.next}}});l.bufferSize=8192;return Object.seal(l)}function G(l){var t=w();Object.defineProperties(t,{track:{value:null,writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},timer:{value:0,writable:!0},master:{value:0,writable:!0},volume:{set:function(d){0>d?d=0:1<d&&(d=1);this.master=64*d}},setup:{configurable:!1,value:function(){this.mixer.setup(this.channels)}}});t.mixer=l||K();t.mixer.player=t;t.endian=1;t.quality=1;return t}window.neoart=Object.create(null);
window.neoart.Unzip=1;(function(){var p="Unknown Format;Ultimate SoundTracker;D.O.C. SoundTracker 9;Master SoundTracker;D.O.C. SoundTracker 2.0/2.2;SoundTracker 2.3;SoundTracker 2.4;NoiseTracker 1.0;NoiseTracker 1.1;NoiseTracker 2.0;ProTracker 1.0;ProTracker 1.1/2.1;ProTracker 1.2/2.0;His Master's NoiseTracker;SoundFX 1.0/1.7;SoundFX 1.8;SoundFX 1.945;SoundFX 1.994/2.0;BP SoundMon V1;BP SoundMon V2;BP SoundMon V3;Delta Music 1.0;Delta Music 2.0;Digital Mugician;Digital Mugician 7 Voices;Future Composer 1.0/1.3;Future Composer 1.4;SidMon 1.0;SidMon 2.0;David Whittaker;FredEd;Jochen Hippel;Jochen Hippel COSO;Rob Hubbard;FastTracker II;Sk@leTracker;MadTracker 2.0;MilkyTracker;DigiBooster Pro 2.18;OpenMPT".split(";");
window.neoart.FileLoader=function(){var t=Object.create(null,{player:{value:null,writable:!0},index:{value:0,writable:!0},amiga:{value:null,writable:!0},mixer:{value:null,writable:!0},tracker:{get:function(){return this.player?p[this.index+this.player.version]:p[0]}},load:{value:function(d){var a,g;d.view||(d=l(d));d.endian=1;d.position=0;if(67324752==d.readUint())if(window.neoart.Unzip)d=z(d),d=d.uncompress(d.entries[0]);else throw"Unzip support is not available.";if(!d)return null;if(this.player&&
"STPlayer"!=this.player.id&&(this.player.load(d),this.player.version))return player;if(336<d.length&&(d.position=38,a=d.readString(20),"FastTracker v2.00   "==a||"FastTracker v 2.00  "==a||"Sk@le Tracker"==a||"MadTracker 2.0"==a||"MilkyTracker        "==a||"DigiBooster Pro 2.18"==a||-1!=a.indexOf("OpenMPT"))&&(this.player=window.neoart.F2Player(this.mixer),this.player.load(d),this.player.version))return this.index=33,this.player;d.endian=0;if(2105<d.length)if(d.position=1080,a=d.readString(4),"M.K."==
a||"FLT4"==a){if(this.player=window.neoart.MKPlayer(this.amiga),this.player.load(d),this.player.version)return this.index=4,this.player}else if("FEST"==a&&(this.player=window.neoart.HMPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=12,this.player;if(2105<d.length&&(d.position=1080,a=d.readString(4),"M.K."==a||"M!K!"==a)&&(this.player=window.neoart.PTPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=9,this.player;if(1685<d.length&&(d.position=
60,a=d.readString(4),"SONG"!=a&&(d.position=124,a=d.readString(4)),"SONG"==a||"SO31"==a)&&(this.player=window.neoart.FXPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=13,this.player;if(4<d.length&&(d.position=0,a=d.readString(4),"ALL "==a&&(this.player=window.neoart.D1Player(this.amiga),this.player.load(d),this.player.version))||3018<d.length&&(d.position=3014,a=d.readString(4),".FNL"==a&&(this.player=window.neoart.D2Player(this.amiga),this.player.load(d),this.player.version)))return this.index=
20,this.player;if(30<d.length&&(d.position=26,a=d.readString(3),"BPS"==a||"V.2"==a||"V.3"==a)&&(this.player=window.neoart.BPPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=17,this.player;if(4<d.length&&(d.position=0,a=d.readString(4),"SMOD"==a||"FC14"==a)&&(this.player=window.neoart.FCPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=24,this.player;if(10<d.length&&(d.position=0,a=d.readString(9)," MUGICIAN"==a&&(this.player=window.neoart.DMPlayer(this.amiga),
this.player.load(d),this.player.version)))return this.index=22,this.player;if(86<d.length&&(d.position=58,a=d.readString(28),"SIDMON II - THE MIDI VERSION"==a&&(this.player=window.neoart.S2Player(this.amiga),this.player.load(d),this.player.version)))return this.index=26,this.player;if(2830<d.length&&(d.position=0,g=d.readUshort(),20218==g&&(this.player=window.neoart.FEPlayer(this.amiga),this.player.load(d),this.player.version)))return this.index=29,this.player;if(5220<d.length&&(this.player=window.neoart.S1Player(this.amiga),
this.player.load(d),this.player.version))return this.index=26,this.player;d.position=0;g=d.readUshort();d.position=0;a=d.readString(4);if("COSO"==a||24576==g||24578==g||24590==g||24598==g)if(this.player=window.neoart.JHPlayer(this.amiga),this.player.load(d),this.player.version)return this.index=30,this.player;d.position=0;d.readUshort();this.player=window.neoart.DWPlayer(this.amiga);this.player.load(d);if(this.player.version)return this.index=28,this.player;d.position=0;g=d.readUshort();if(24576==
g&&(this.player=window.neoart.RHPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=32,this.player;if(1625<d.length&&(this.player=window.neoart.STPlayer(this.amiga),this.player.load(d),this.player.version))return this.index=0,this.player;d.clear();this.index=0;return this.player=null}}});t.amiga=H();return Object.seal(t)}()})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,
writable:!0},restart:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},synth:{value:0,writable:!0},synthPtr:{value:0,writable:!0},arpeggio:{value:0,writable:!0},autoArpeggio:{value:0,writable:!0},autoSlide:{value:0,writable:!0},vibrato:{value:0,writable:!0},volume:{value:0,writable:!0},volumeDef:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrPtr:{value:0,writable:!0},
adsrCtr:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoPtr:{value:0,writable:!0},lfoCtr:{value:0,writable:!0},egControl:{value:0,writable:!0},egPtr:{value:0,writable:!0},egCtr:{value:0,writable:!0},egValue:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxCtr:{value:0,writable:!0},modControl:{value:0,writable:!0},modPtr:{value:0,writable:!0},modCtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.samplePtr=this.sample=this.period=this.note=this.restart=this.enabled=
0;this.sampleLen=2;this.synth=0;this.synthPtr=-1;this.modCtr=this.modPtr=this.modControl=this.fxCtr=this.fxControl=this.egValue=this.egCtr=this.egPtr=this.egControl=this.lfoCtr=this.lfoPtr=this.lfoControl=this.adsrCtr=this.adsrPtr=this.adsrControl=this.volumeDef=this.volume=this.vibrato=this.autoSlide=this.autoArpeggio=this.arpeggio=0}}})}var t=[6848,6464,6080,5760,5440,5120,4832,4576,4320,4064,3840,3616,3424,3232,3040,2880,2720,2560,2416,2288,2160,2032,1920,1808,1712,1616,1520,1440,1360,1280,1208,
1144,1080,1016,960,904,856,808,760,720,680,640,604,572,540,508,480,452,428,404,380,360,340,320,302,286,270,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95,90,85,80,76,72,68,64,60,57],d=[0,64,128,64,0,-64,-128,-64];window.neoart.BPPlayer=function(a){a=B(a);Object.defineProperties(a,{id:{value:"BPPlayer"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},buffer:{value:null,writable:!0},voices:{value:[],writable:!0},
trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},row:{value:0,writable:!0},nextPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},repeatCtr:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},initialize:{value:function(){var g,a=this.voices[0];this.reset();this.speed=6;this.tick=1;this.repeatCtr=this.jumpFlag=this.nextPos=this.row=this.patternPos=this.trackPos=0;this.arpeggioCtr=1;for(g=this.vibratoPos=0;128>g;++g)this.buffer[g]=0;for(;a;)a.initialize(),
a.channel=this.mixer.channels[a.index],a.samplePtr=this.mixer.loopPtr,a=a.next}},restore:{value:function(){for(var g,a,c,e=this.voices[0];e;){if(-1<e.synthPtr)for(c=e.index<<5,a=e.synthPtr+32,g=e.synthPtr;g<a;++g)this.mixer.memory[g]=this.buffer[c++];e=e.next}}},loader:{value:function(g){var a=0,c=0,e,f,b;this.title=g.readString(26);e=g.readString(4);if("BPSM"==e)this.version=1;else{e=e.substr(0,3);if("V.2"==e)this.version=2;else if("V.3"==e)this.version=3;else return;g.position=29;b=g.readUbyte()}for(this.length=
g.readUshort();16>++c;)e=A(),Object.defineProperties(e,{synth:{value:0,writable:!0},table:{value:0,writable:!0},adsrControl:{value:0,writable:!0},adsrTable:{value:0,writable:!0},adsrLen:{value:0,writable:!0},adsrSpeed:{value:0,writable:!0},lfoControl:{value:0,writable:!0},lfoTable:{value:0,writable:!0},lfoDepth:{value:0,writable:!0},lfoLen:{value:0,writable:!0},lfoDelay:{value:0,writable:!0},lfoSpeed:{value:0,writable:!0},egControl:{value:0,writable:!0},egTable:{value:0,writable:!0},egLen:{value:0,
writable:!0},egDelay:{value:0,writable:!0},egSpeed:{value:0,writable:!0},fxControl:{value:0,writable:!0},fxDelay:{value:0,writable:!0},fxSpeed:{value:0,writable:!0},modControl:{value:0,writable:!0},modTable:{value:0,writable:!0},modLen:{value:0,writable:!0},modDelay:{value:0,writable:!0},modSpeed:{value:0,writable:!0}}),e=Object.seal(e),255==g.readUbyte()?(e.synth=1,e.table=g.readUbyte(),e.pointer=e.table<<6,e.length=g.readUshort()<<1,e.adsrControl=g.readUbyte(),e.adsrTable=g.readUbyte()<<6,e.adsrLen=
g.readUshort(),e.adsrSpeed=g.readUbyte(),e.lfoControl=g.readUbyte(),e.lfoTable=g.readUbyte()<<6,e.lfoDepth=g.readUbyte(),e.lfoLen=g.readUshort(),3>this.version?(g.readByte(),e.lfoDelay=g.readUbyte(),e.lfoSpeed=g.readUbyte(),e.egControl=g.readUbyte(),e.egTable=g.readUbyte()<<6,g.readByte(),e.egLen=g.readUshort(),g.readByte(),e.egDelay=g.readUbyte(),e.egSpeed=g.readUbyte(),e.fxSpeed=1,e.modSpeed=1,e.volume=g.readUbyte(),g.position+=6):(e.lfoDelay=g.readUbyte(),e.lfoSpeed=g.readUbyte(),e.egControl=g.readUbyte(),
e.egTable=g.readUbyte()<<6,e.egLen=g.readUshort(),e.egDelay=g.readUbyte(),e.egSpeed=g.readUbyte(),e.fxControl=g.readUbyte(),e.fxSpeed=g.readUbyte(),e.fxDelay=g.readUbyte(),e.modControl=g.readUbyte(),e.modTable=g.readUbyte()<<6,e.modSpeed=g.readUbyte(),e.modDelay=g.readUbyte(),e.volume=g.readUbyte(),e.modLen=g.readUshort())):(g.position--,e.synth=0,e.name=g.readString(24),e.length=g.readUshort()<<1,e.length?(e.loop=g.readUshort(),e.repeat=g.readUshort()<<1,e.volume=g.readUshort(),e.loop+e.repeat>=
e.length&&(e.repeat=e.length-e.loop)):(e.pointer--,e.repeat=2,g.position+=6)),this.samples[c]=e;e=this.length<<2;this.tracks.length=e;for(c=0;c<e;++c)f=E(),Object.defineProperties(f,{soundTranspose:{value:0,writable:!0}}),f=Object.seal(f),f.pattern=g.readUshort(),f.soundTranspose=g.readByte(),f.transpose=g.readByte(),f.pattern>a&&(a=f.pattern),this.tracks[c]=f;e=a<<4;this.patterns.length=e;for(c=0;c<e;++c)a=D(),a.note=g.readByte(),a.sample=g.readUbyte(),a.effect=a.sample&15,a.sample=(a.sample&240)>>
4,a.param=g.readByte(),this.patterns[c]=a;this.mixer.store(g,b<<6);for(c=0;16>++c;)e=this.samples[c],!e.synth&&e.length&&(e.pointer=this.mixer.store(g,e.length),e.loopPtr=e.pointer+e.loop)}},process:{value:function(){var g,a,c,e,f,b=this.mixer.memory,h,m=this.voices[0];this.arpeggioCtr=--this.arpeggioCtr&3;for(this.vibratoPos=++this.vibratoPos&7;m;){g=m.channel;m.period+=m.autoSlide;g.period=m.vibrato?m.period+(d[this.vibratoPos]/m.vibrato>>0):m.period;g.pointer=m.samplePtr;g.length=m.sampleLen;if(m.arpeggio||
m.autoArpeggio)e=m.note,this.arpeggioCtr?1==this.arpeggioCtr&&(e+=(m.arpeggio&15)+(m.autoArpeggio&15)):e+=((m.arpeggio&240)>>4)+((m.autoArpeggio&240)>>4),g.period=m.period=t[e+35],m.restart=0;if(!(!m.synth||0>m.sample||(e=this.samples[m.sample],m.adsrControl&&0==--m.adsrCtr&&(m.adsrCtr=e.adsrSpeed,a=128+b[e.adsrTable+m.adsrPtr]>>2,g.volume=a*m.volume>>6,++m.adsrPtr==e.adsrLen&&(m.adsrPtr=0,1==m.adsrControl&&(m.adsrControl=0))),m.lfoControl&&0==--m.lfoCtr&&(m.lfoCtr=e.lfoSpeed,a=b[e.lfoTable+m.lfoPtr],
e.lfoDepth&&(a=a/e.lfoDepth>>0),g.period=m.period+a,++m.lfoPtr==e.lfoLen&&(m.lfoPtr=0,1==m.lfoControl&&(m.lfoControl=0))),0>m.synthPtr))){if(m.egControl&&0==--m.egCtr){m.egCtr=e.egSpeed;a=m.egValue;m.egValue=128+b[e.egTable+m.egPtr]>>3;if(m.egValue!=a)if(h=(m.index<<5)+a,c=m.synthPtr+a,m.egValue<a)for(a-=m.egValue,f=c-a;c>f;)b[--c]=this.buffer[--h];else for(a=m.egValue-a,f=c+a;c<f;)b[c++]=~this.buffer[h++]+1;++m.egPtr==e.egLen&&(m.egPtr=0,1==m.egControl&&(m.egControl=0))}switch(m.fxControl){case 1:if(0==
--m.fxCtr)for(m.fxCtr=e.fxSpeed,c=m.synthPtr,f=m.synthPtr+32,a=0<c?b[c-1]:0;c<f;)a=a+b[c+1]>>1,b[c++]=a;break;case 2:h=(m.index<<5)+31;f=m.synthPtr+32;a=e.fxSpeed;for(c=m.synthPtr;c<f;++c)this.buffer[h]<b[c]?b[c]-=a:this.buffer[h]>b[c]&&(b[c]+=a),h--;break;case 3:case 5:h=m.index<<5;f=m.synthPtr+32;a=e.fxSpeed;for(c=m.synthPtr;c<f;++c)this.buffer[h]<b[c]?b[c]-=a:this.buffer[h]>b[c]&&(b[c]+=a),h++;break;case 4:h=m.synthPtr+64;f=m.synthPtr+32;a=e.fxSpeed;for(c=m.synthPtr;c<f;++c)b[h]<b[c]?b[c]-=a:b[h]>
b[c]&&(b[c]+=a),h++;break;case 6:if(0==--m.fxCtr)for(m.fxControl=0,m.fxCtr=1,h=m.synthPtr+64,f=m.synthPtr+32,c=m.synthPtr;c<f;++c)b[c]=b[h++]}m.modControl&&0==--m.modCtr&&(m.modCtr=e.modSpeed,b[m.synthPtr+32]=b[e.modTable+m.modPtr],++m.modPtr==e.modLen&&(m.modPtr=0,1==m.modControl&&(m.modControl=0)))}m=m.next}if(0==--this.tick){this.tick=this.speed;for(m=this.voices[0];m;){g=m.channel;m.enabled=0;f=this.tracks[(this.trackPos<<2)+m.index];this.row=h=this.patterns[this.patternPos+(f.pattern-1<<4)];
e=h.note;c=h.effect;a=h.param;if(e){m.autoArpeggio=m.autoSlide=m.vibrato=0;if(10!=c||0==(a&240))e+=f.transpose;m.note=e;m.period=t[e+35];m.restart=13>c?m.volumeDef=1:0;e=h.sample;0==e&&(e=m.sample);if(10!=c||0==(a&15))e+=f.soundTranspose;13>c&&(!m.synth||m.sample!=e)&&(m.sample=e,m.enabled=1)}switch(c){case 0:m.arpeggio=a;break;case 1:m.volume=a;m.volumeDef=0;if(3>this.version||!m.synth)g.volume=m.volume;break;case 2:this.tick=this.speed=a;break;case 3:this.mixer.filter.active=a;break;case 4:m.period-=
a;m.arpeggio=0;break;case 5:m.period+=a;m.arpeggio=0;break;case 6:3==this.version?m.vibrato=a:this.repeatCtr=a;break;case 7:3==this.version?(this.nextPos=a,this.jumpFlag=1):0==this.repeatCtr&&(this.trackPos=a);break;case 8:m.autoSlide=a;break;case 9:m.autoArpeggio=a;3==this.version&&(m.adsrPtr=0,0==m.adsrControl&&(m.adsrControl=1));break;case 11:m.fxControl=a;break;case 13:m.autoArpeggio=a;m.fxControl^=1;m.adsrPtr=0;0==m.adsrControl&&(m.adsrControl=1);break;case 14:m.autoArpeggio=a;m.adsrPtr=0;0==
m.adsrControl&&(m.adsrControl=1);break;case 15:m.autoArpeggio=a}m=m.next}this.jumpFlag?(this.trackPos=this.nextPos,this.patternPos=this.jumpFlag=0):16==++this.patternPos&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1));for(m=this.voices[0];m;){g=m.channel;m.enabled&&(g.enabled=m.enabled=0);if(0!=m.restart&&-1<m.synthPtr){h=m.index<<5;f=m.synthPtr+32;for(c=m.synthPtr;c<f;++c)b[c]=this.buffer[h++];m.synthPtr=-1}m=m.next}for(m=this.voices[0];m;){if(!(0==m.restart||
0>m.sample)){g=m.channel;g.period=m.period;m.restart=0;e=this.samples[m.sample];if(e.synth){if(m.synth=1,m.egValue=0,m.adsrPtr=m.lfoPtr=m.egPtr=m.modPtr=0,m.adsrCtr=1,m.lfoCtr=e.lfoDelay+1,m.egCtr=e.egDelay+1,m.fxCtr=e.fxDelay+1,m.modCtr=e.modDelay+1,m.adsrControl=e.adsrControl,m.lfoControl=e.lfoControl,m.egControl=e.egControl,m.fxControl=e.fxControl,m.modControl=e.modControl,g.pointer=m.samplePtr=e.pointer,g.length=m.sampleLen=e.length,m.adsrControl?(a=128+b[e.adsrTable]>>2,m.volumeDef&&(m.volume=
e.volume,m.volumeDef=0),g.volume=a*m.volume>>6):g.volume=m.volumeDef?e.volume:m.volume,m.egControl||m.fxControl||m.modControl)for(m.synthPtr=e.pointer,c=m.index<<5,f=m.synthPtr+32,h=m.synthPtr;h<f;++h)this.buffer[c++]=b[h]}else m.synth=m.lfoControl=0,0>e.pointer?(m.samplePtr=this.mixer.loopPtr,m.sampleLen=2):(g.pointer=e.pointer,g.volume=m.volumeDef?e.volume:m.volume,2!=e.repeat?(m.samplePtr=e.loopPtr,g.length=m.sampleLen=e.repeat):(m.samplePtr=this.mixer.loopPtr,m.sampleLen=2,g.length=e.length));
g.enabled=m.enabled=1}m=m.next}}}}});a.voices[0]=l(0);a.voices[0].next=a.voices[1]=l(1);a.voices[1].next=a.voices[2]=l(2);a.voices[2].next=a.voices[3]=l(3);a.buffer=new Int8Array(128);return Object.seal(a)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},status:{value:0,writable:!0},speed:{value:0,writable:!0},
step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},tableCtr:{value:0,writable:!0},tablePos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},volume:{value:0,writable:!0},attackCtr:{value:0,writable:!0},decayCtr:{value:0,writable:!0},releaseCtr:{value:0,writable:!0},
sustain:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.status=this.patternPos=this.trackPos=0;this.speed=1;this.row=this.step=null;this.releaseCtr=this.decayCtr=this.attackCtr=this.volume=this.vibratoPeriod=this.vibratoPos=this.vibratoDir=this.vibratoCtr=this.tablePos=this.tableCtr=this.pitchBend=this.arpeggioPos=this.period=this.note=0;this.sustain=1}}})}function t(){var a=A();Object.defineProperties(a,{synth:{value:0,writable:!0},attackStep:{value:0,writable:!0},attackDelay:{value:0,
writable:!0},decayStep:{value:0,writable:!0},decayDelay:{value:0,writable:!0},releaseStep:{value:0,writable:!0},releaseDelay:{value:0,writable:!0},sustain:{value:0,writable:!0},arpeggio:{value:null,writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},table:{value:null,writable:!0},tableDelay:{value:0,writable:!0},vibratoWait:{value:0,writable:!0},vibratoStep:{value:0,writable:!0},vibratoLen:{value:0,writable:!0}});a.arpeggio=new Int8Array(8);a.table=new Int8Array(48);return Object.seal(a)}
var d=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D1Player=function(a){a=B(a);Object.defineProperties(a,{id:{value:"D1Player"},pointers:{value:null,writable:!0},tracks:{value:[],
writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var g=this.voices[0];this.reset();for(this.speed=6;g;)g.initialize(),g.channel=this.mixer.channels[g.index],g.sample=this.samples[20],g=g.next}},loader:{value:function(g){var a,c=0,e,f=0,b,d,m;if("ALL "==g.readString(4)){for(a=new Uint32Array(25);25>c;++c)a[c]=g.readUint();this.pointers=new Uint32Array(4);for(c=1;4>c;++c)this.pointers[c]=this.pointers[f]+(a[f++]>>
1)-1;b=this.pointers[3]+(a[3]>>1)-1;this.tracks.length=b;e=104+a[1]-2;g.position=104;f=1;for(c=0;c<b;++c)d=E(),m=g.readUshort(),65535==m||g.position==e?(d.pattern=-1,d.transpose=g.readUshort(),e+=a[f++]):(g.position--,d.pattern=(m>>2&16320)>>2,d.transpose=g.readByte()),this.tracks[c]=d;b=a[4]>>2;this.patterns.length=b;for(c=0;c<b;++c)e=D(),e.sample=g.readUbyte(),e.note=g.readUbyte(),e.effect=g.readUbyte()&31,e.param=g.readUbyte(),this.patterns[c]=e;e=5;for(c=0;20>c;++c){this.samples[c]=null;if(0!=
a[e]){d=t();d.attackStep=g.readUbyte();d.attackDelay=g.readUbyte();d.decayStep=g.readUbyte();d.decayDelay=g.readUbyte();d.sustain=g.readUshort();d.releaseStep=g.readUbyte();d.releaseDelay=g.readUbyte();d.volume=g.readUbyte();d.vibratoWait=g.readUbyte();d.vibratoStep=g.readUbyte();d.vibratoLen=g.readUbyte();d.pitchBend=g.readByte();d.portamento=g.readUbyte();d.synth=g.readUbyte();d.tableDelay=g.readUbyte();for(f=0;8>f;++f)d.arpeggio[f]=g.readByte();d.length=g.readUshort();d.loop=g.readUshort();d.repeat=
g.readUshort()<<1;d.synth=d.synth?0:1;if(d.synth){for(f=0;48>f;++f)d.table[f]=g.readByte();b=a[e]-78}else b=d.length;d.pointer=this.mixer.store(g,b);d.loopPtr=d.pointer+d.loop;this.samples[c]=d}e++}d=t();d.pointer=d.loopPtr=this.mixer.memory.length;d.length=d.repeat=2;this.samples[20]=d;this.version=1}}},process:{value:function(){for(var a,k,c,e,f=this.voices[0];f;){k=f.channel;0==--f.speed&&(f.speed=this.speed,0==f.patternPos&&(f.step=this.tracks[this.pointers[f.index]+f.trackPos],0>f.step.pattern&&
(f.trackPos=f.step.transpose,f.step=this.tracks[this.pointers[f.index]+f.trackPos]),f.trackPos++),c=this.patterns[f.step.pattern+f.patternPos],c.effect&&(f.row=c),c.note&&(k.enabled=0,f.row=c,f.note=c.note+f.step.transpose,f.arpeggioPos=f.pitchBend=f.status=0,e=f.sample=this.samples[c.sample],e.synth||(k.pointer=e.pointer),k.length=e.length,f.tableCtr=f.tablePos=0,f.vibratoCtr=e.vibratoWait,f.vibratoPos=e.vibratoLen,f.vibratoDir=e.vibratoLen<<1,f.volume=f.attackCtr=f.decayCtr=f.releaseCtr=0,f.sustain=
e.sustain),16==++f.patternPos&&(f.patternPos=0));e=f.sample;if(e.synth)if(0==f.tableCtr){f.tableCtr=e.tableDelay;do a=1,48<=f.tablePos&&(f.tablePos=0),c=e.table[f.tablePos],f.tablePos++,0<=c?(k.pointer=e.pointer+(c<<5),a=0):-1!=c?e.tableDelay=c&127:f.tablePos=e.table[f.tablePos];while(a)}else f.tableCtr--;e.portamento&&(c=d[f.note]+f.pitchBend,0!=f.period?f.period<c?(f.period+=e.portamento,f.period>c&&(f.period=c)):(f.period-=e.portamento,f.period<c&&(f.period=c)):f.period=c);0==f.vibratoCtr?(f.vibratoPeriod=
f.vibratoPos*e.vibratoStep,0==(f.status&1)?(f.vibratoPos++,f.vibratoPos==f.vibratoDir&&(f.status^=1)):(f.vibratoPos--,0==f.vibratoPos&&(f.status^=1))):f.vibratoCtr--;f.pitchBend=0>e.pitchBend?f.pitchBend+e.pitchBend:f.pitchBend-e.pitchBend;if(f.row)switch(c=f.row,c.effect){case 1:if(c=c.param&15)this.speed=c;break;case 2:f.pitchBend-=c.param;break;case 3:f.pitchBend+=c.param;break;case 4:this.mixer.filter.active=c.param;break;case 5:e.vibratoWait=c.param;break;case 6:e.vibratoStep=c.param;case 7:e.vibratoLen=
c.param;break;case 8:e.pitchBend=c.param;break;case 9:e.portamento=c.param;break;case 10:e.volume=64;break;case 11:e.arpeggio[0]=c.param;break;case 12:e.arpeggio[1]=c.param;break;case 13:e.arpeggio[2]=c.param;break;case 14:e.arpeggio[3]=c.param;break;case 15:e.arpeggio[4]=c.param;break;case 16:e.arpeggio[5]=c.param;break;case 17:e.arpeggio[6]=c.param;break;case 18:e.arpeggio[7]=c.param;break;case 19:e.arpeggio[0]=e.arpeggio[4]=c.param;break;case 20:e.arpeggio[1]=e.arpeggio[5]=c.param;break;case 21:e.arpeggio[2]=
e.arpeggio[6]=c.param;break;case 22:e.arpeggio[3]=e.arpeggio[7]=c.param;break;case 23:c=c.param;64<c&&(c=64);e.attackStep=c;break;case 24:e.attackDelay=c.param;break;case 25:c=c.param;64<c&&(c=64);e.decayStep=c;break;case 26:e.decayDelay=c.param;break;case 27:e.sustain=c.param&e.sustain&255;break;case 28:e.sustain=(e.sustain&65280)+c.param;break;case 29:c=c.param;64<c&&(c=64);e.releaseStep=c;break;case 30:e.releaseDelay=c.param}e.portamento?c=f.period:(c=d[f.note+e.arpeggio[f.arpeggioPos]],f.arpeggioPos=
++f.arpeggioPos&7,c-=e.vibratoLen*e.vibratoStep,c+=f.pitchBend,f.period=0);k.period=c+f.vibratoPeriod;a=f.status&14;c=f.volume;0==a&&(0==f.attackCtr?(f.attackCtr=e.attackDelay,c+=e.attackStep,64<=c&&(a|=2,f.status|=2,c=64)):f.attackCtr--);2==a&&(0==f.decayCtr?(f.decayCtr=e.decayDelay,c-=e.decayStep,c<=e.volume&&(a|=6,f.status|=6,c=e.volume)):f.decayCtr--);6==a&&(0==f.sustain?(a|=14,f.status|=14):f.sustain--);14==a&&(0==f.releaseCtr?(f.releaseCtr=e.releaseDelay,c-=e.releaseStep,0>c&&(f.status&=9,c=
0)):f.releaseCtr--);k.volume=f.volume=c;k.enabled=1;e.synth||(e.loop?(k.pointer=e.loopPtr,k.length=e.repeat):(k.pointer=this.mixer.loopPtr,k.length=2));f=f.next}}}});a.voices[0]=l(0);a.voices[0].next=a.voices[1]=l(1);a.voices[1].next=a.voices[2]=l(2);a.voices[2].next=a.voices[3]=l(3);return Object.seal(a)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,
writable:!0},trackPos:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},restart:{value:0,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioPtr:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},pitchBend:{value:0,writable:!0},portamento:{value:0,writable:!0},tableCtr:{value:0,writable:!0},tablePos:{value:0,writable:!0},vibratoCtr:{value:0,
writable:!0},vibratoDir:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoPeriod:{value:0,writable:!0},vibratoSustain:{value:0,writable:!0},volume:{value:0,writable:!0},volumeMax:{value:0,writable:!0},volumePos:{value:0,writable:!0},volumeSustain:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.restart=this.patternPos=this.trackLen=this.trackPos=this.trackPtr=0;this.row=this.step=null;this.volume=this.vibratoSustain=this.vibratoPeriod=this.vibratoPos=this.vibratoDir=
this.vibratoCtr=this.tablePos=this.tableCtr=this.portamento=this.pitchBend=this.arpeggioPos=this.arpeggioPtr=this.finalPeriod=this.period=this.note=0;this.volumeMax=63;this.volumeSustain=this.volumePos=0}}})}function t(){var a=A();Object.defineProperties(a,{index:{value:0,writable:!0},pitchBend:{value:0,writable:!0},synth:{value:0,writable:!0},table:{value:null,writable:!0},vibratos:{value:null,writable:!0},volumes:{value:null,writable:!0}});a.table=new Uint8Array(48);a.vibratos=new Uint8Array(15);
a.volumes=new Uint8Array(15);return Object.seal(a)}var d=[0,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113];window.neoart.D2Player=function(a){a=B(a);Object.defineProperties(a,{id:{value:"D2Player"},
tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},data:{value:null,writable:!0},arpeggios:{value:null,writable:!0},voices:{value:[],writable:!0},noise:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.speed=5;this.tick=1;for(this.noise=0;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[this.samples.length-1],a.trackPtr=this.data[a.index],a.restart=this.data[a.index+4],a.trackLen=this.data[a.index+
8],a=a.next}},loader:{value:function(a){var d=0,c,e=0,f,b,h;a.position=3014;if(".FNL"==a.readString(4)){a.position=4042;for(this.data=new Uint16Array(12);4>d;++d)this.data[d+4]=a.readUshort()>>1,h=a.readUshort()>>1,this.data[d+8]=h,e+=h;h=e;for(d=3;0<d;--d)this.data[d]=h-=this.data[d+8];this.tracks.length=e;for(d=0;d<e;++d)c=E(),c.pattern=a.readUbyte()<<4,c.transpose=a.readByte(),this.tracks[d]=c;e=a.readUint()>>2;this.patterns.length=e;for(d=0;d<e;++d)f=D(),f.note=a.readUbyte(),f.sample=a.readUbyte(),
f.effect=a.readUbyte()-1,f.param=a.readUbyte(),this.patterns[d]=f;a.position+=254;h=a.readUshort();b=a.position;a.position-=256;e=1;f=new Uint16Array(128);for(d=0;128>d;++d)c=a.readUshort(),c!=h&&(f[e++]=c);this.samples.length=e;for(d=0;d<e;++d){a.position=b+f[d];h=t();h.length=a.readUshort()<<1;h.loop=a.readUshort();h.repeat=a.readUshort()<<1;for(c=0;15>c;++c)h.volumes[c]=a.readUbyte();for(c=0;15>c;++c)h.vibratos[c]=a.readUbyte();h.pitchBend=a.readUshort();h.synth=a.readByte();h.index=a.readUbyte();
for(c=0;48>c;++c)h.table[c]=a.readUbyte();this.samples[d]=h}e=a.readUint();this.mixer.store(a,e);a.position+=64;for(d=0;8>d;++d)f[d]=a.readUint();e=this.samples.length;b=a.position;for(d=0;d<e;++d)h=this.samples[d],0<=h.synth||(a.position=b+f[h.index],h.pointer=this.mixer.store(a,h.length),h.loopPtr=h.pointer+h.loop);a.position=3018;for(d=0;1024>d;++d)this.arpeggios[d]=a.readByte();h=t();h.pointer=h.loopPtr=this.mixer.memory.length;h.length=h.repeat=2;this.samples[e]=h;e=this.patterns.length;c=this.samples.length-
1;for(d=0;d<e;++d)f=this.patterns[d],f.sample>c&&(f.sample=0);this.version=2}}},process:{value:function(){var a;a=0;for(var k,c,e,f=this.voices[0];64>a;)this.noise=this.noise<<7|this.noise>>>25,this.noise+=1858762093,this.noise^=2656676139,c=this.noise>>>24&255,127<c&&(c|=-256),this.mixer.memory[a++]=c,c=this.noise>>>16&255,127<c&&(c|=-256),this.mixer.memory[a++]=c,c=this.noise>>>8&255,127<c&&(c|=-256),this.mixer.memory[a++]=c,c=this.noise&255,127<c&&(c|=-256),this.mixer.memory[a++]=c;0>--this.tick&&
(this.tick=this.speed);for(;f;){if(!(1>f.trackLen)){a=f.channel;e=f.sample;e.synth&&(a.pointer=e.loopPtr,a.length=e.repeat);if(0==this.tick){0==f.patternPos&&(f.step=this.tracks[f.trackPtr+f.trackPos],++f.trackPos==f.trackLen&&(f.trackPos=f.restart));c=f.row=this.patterns[f.step.pattern+f.patternPos];c.note&&(a.enabled=0,f.note=c.note,f.period=d[c.note+f.step.transpose],e=f.sample=this.samples[c.sample],0>e.synth&&(a.pointer=e.pointer,a.length=e.length),f.arpeggioPos=0,f.tableCtr=0,f.tablePos=0,f.vibratoCtr=
e.vibratos[1],f.vibratoPos=0,f.vibratoDir=0,f.vibratoPeriod=0,f.vibratoSustain=e.vibratos[2],f.volume=0,f.volumePos=0,f.volumeSustain=0);switch(c.effect){case 0:this.speed=c.param&15;break;case 1:this.mixer.filter.active=c.param;break;case 2:f.pitchBend=~(c.param&255)+1;break;case 3:f.pitchBend=c.param&255;break;case 4:f.portamento=c.param;break;case 5:f.volumeMax=c.param&63;break;case 6:this.mixer.volume=c.param;break;case 7:f.arpeggioPtr=(c.param&63)<<4}f.patternPos=++f.patternPos&15}e=f.sample;
0<=e.synth&&(f.tableCtr?f.tableCtr--:(f.tableCtr=e.index,c=e.table[f.tablePos],255==c&&(c=e.table[++f.tablePos],255!=c&&(f.tablePos=c,c=e.table[f.tablePos])),255!=c&&(a.pointer=c<<8,a.length=e.length,47<++f.tablePos&&(f.tablePos=0))));c=e.vibratos[f.vibratoPos];f.vibratoPeriod=f.vibratoDir?f.vibratoPeriod-c:f.vibratoPeriod+c;0==--f.vibratoCtr&&(f.vibratoCtr=e.vibratos[f.vibratoPos+1],f.vibratoDir=~f.vibratoDir);f.vibratoSustain?f.vibratoSustain--:(f.vibratoPos+=3,15==f.vibratoPos&&(f.vibratoPos=12),
f.vibratoSustain=e.vibratos[f.vibratoPos+2]);f.volumeSustain?f.volumeSustain--:(c=e.volumes[f.volumePos],k=e.volumes[f.volumePos+1],k<f.volume?(f.volume-=c,f.volume<k&&(f.volume=k,f.volumePos+=3,f.volumeSustain=e.volumes[f.volumePos-1])):(f.volume+=c,f.volume>k&&(f.volume=k,f.volumePos+=3,15==f.volumePos&&(f.volumePos=12),f.volumeSustain=e.volumes[f.volumePos-1])));f.portamento&&(f.period<f.finalPeriod?(f.finalPeriod-=f.portamento,f.finalPeriod<f.period&&(f.finalPeriod=f.period)):(f.finalPeriod+=
f.portamento,f.finalPeriod>f.period&&(f.finalPeriod=f.period)));c=this.arpeggios[f.arpeggioPtr+f.arpeggioPos];-128==c&&(f.arpeggioPos=0,c=this.arpeggios[f.arpeggioPtr]);f.arpeggioPos=++f.arpeggioPos&15;0==f.portamento&&(c=f.note+f.step.transpose+c,0>c&&(c=0),f.finalPeriod=d[c]);f.vibratoPeriod-=e.pitchBend-f.pitchBend;a.period=f.finalPeriod+f.vibratoPeriod;c=f.volume>>2&63;c>f.volumeMax&&(c=f.volumeMax);a.volume=c;a.enabled=1}f=f.next}}}});a.voices[0]=l(0);a.voices[0].next=a.voices[1]=l(1);a.voices[1].next=
a.voices[2]=l(2);a.voices[2].next=a.voices[3]=l(3);a.arpeggios=new Int8Array(1024);return Object.seal(a)}})();(function(){function l(){return Object.create(null,{channel:{value:null,writable:!0},sample:{value:null,writable:!0},step:{value:null,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},val1:{value:0,writable:!0},val2:{value:0,writable:!0},finalPeriod:{value:0,writable:!0},arpeggioStep:{value:0,writable:!0},effectCtr:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchCtr:{value:0,
writable:!0},pitchStep:{value:0,writable:!0},portamento:{value:0,writable:!0},volume:{value:0,writable:!0},volumeCtr:{value:0,writable:!0},volumeStep:{value:0,writable:!0},mixMute:{value:0,writable:!0},mixPtr:{value:0,writable:!0},mixEnd:{value:0,writable:!0},mixSpeed:{value:0,writable:!0},mixStep:{value:0,writable:!0},mixVolume:{value:0,writable:!0},initialize:{value:function(){this.step=this.sample=null;this.volumeStep=this.volumeCtr=this.volume=this.portamento=this.pitchStep=this.pitchCtr=this.pitch=
this.effectCtr=this.arpeggioStep=this.finalPeriod=this.val2=this.val1=this.period=this.note=0;this.mixMute=1;this.mixVolume=this.mixStep=this.mixSpeed=this.mixEnd=this.mixPtr=0}}})}var t=[3220,3040,2869,2708,2556,2412,2277,2149,2029,1915,1807,1706,1610,1520,1434,1354,1278,1206,1139,1075,1014,957,904,853,805,760,717,677,639,603,569,537,507,479,452,426,403,380,359,338,319,302,285,269,254,239,226,213,201,190,179,169,160,151,142,134,127,4842,4571,4314,4072,3843,3628,3424,3232,3051,2879,2718,2565,2421,
2285,2157,2036,1922,1814,1712,1616,1525,1440,1359,1283,1211,1143,1079,1018,961,907,856,808,763,720,679,641,605,571,539,509,480,453,428,404,381,360,340,321,303,286,270,254,240,227,214,202,191,180,170,160,151,143,135,127,4860,4587,4330,4087,3857,3641,3437,3244,3062,2890,2728,2574,2430,2294,2165,2043,1929,1820,1718,1622,1531,1445,1364,1287,1215,1147,1082,1022,964,910,859,811,765,722,682,644,607,573,541,511,482,455,430,405,383,361,341,322,304,287,271,255,241,228,215,203,191,181,170,161,152,143,135,128,
4878,4604,4345,4102,3871,3654,3449,3255,3073,2900,2737,2584,2439,2302,2173,2051,1936,1827,1724,1628,1536,1450,1369,1292,1219,1151,1086,1025,968,914,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,4895,4620,4361,4116,3885,3667,3461,3267,3084,2911,2747,2593,2448,2310,2181,2058,1943,1834,1731,1634,1542,1455,1374,1297,1224,1155,1090,1029,971,917,865,817,771,728,687,648,612,578,545,515,486,458,433,408,385,364,343,324,
306,289,273,257,243,229,216,204,193,182,172,162,153,144,136,129,4913,4637,4377,4131,3899,3681,3474,3279,3095,2921,2757,2603,2456,2319,2188,2066,1950,1840,1737,1639,1547,1461,1379,1301,1228,1159,1094,1033,975,920,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,4931,4654,4393,4146,3913,3694,3486,3291,3106,2932,2767,2612,2465,2327,2196,2073,1957,1847,1743,1645,1553,1466,1384,1306,1233,1163,1098,1037,978,923,872,823,
777,733,692,653,616,582,549,518,489,462,436,411,388,366,346,326,308,291,275,259,245,231,218,206,194,183,173,163,154,145,137,130,4948,4671,4409,4161,3928,3707,3499,3303,3117,2942,2777,2621,2474,2335,2204,2081,1964,1854,1750,1651,1559,1471,1389,1311,1237,1168,1102,1040,982,927,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,4966,4688,4425,4176,3942,3721,3512,3315,3129,2953,2787,2631,2483,2344,2212,2088,1971,1860,
1756,1657,1564,1477,1394,1315,1242,1172,1106,1044,985,930,878,829,782,738,697,658,621,586,553,522,493,465,439,414,391,369,348,329,310,293,277,261,246,233,219,207,196,185,174,164,155,146,138,131,4984,4705,4441,4191,3956,3734,3524,3327,3140,2964,2797,2640,2492,2352,2220,2096,1978,1867,1762,1663,1570,1482,1399,1320,1246,1176,1110,1048,989,934,881,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,5002,4722,4457,4206,3970,
3748,3537,3339,3151,2974,2807,2650,2501,2361,2228,2103,1985,1874,1769,1669,1576,1487,1404,1325,1251,1180,1114,1052,993,937,884,835,788,744,702,662,625,590,557,526,496,468,442,417,394,372,351,331,313,295,279,263,248,234,221,209,197,186,175,166,156,148,139,131,5020,4739,4473,4222,3985,3761,3550,3351,3163,2985,2818,2659,2510,2369,2236,2111,1992,1881,1775,1675,1581,1493,1409,1330,1255,1185,1118,1055,996,940,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,
222,209,198,187,176,166,157,148,140,132,5039,4756,4489,4237,3999,3775,3563,3363,3174,2996,2828,2669,2519,2378,2244,2118,2E3,1887,1781,1681,1587,1498,1414,1335,1260,1189,1122,1059,1E3,944,891,841,794,749,707,667,630,594,561,530,500,472,445,420,397,374,353,334,315,297,281,265,250,236,223,210,198,187,177,167,157,149,140,132,5057,4773,4505,4252,4014,3788,3576,3375,3186,3007,2838,2679,2528,2387,2253,2126,2007,1894,1788,1688,1593,1503,1419,1339,1264,1193,1126,1063,1003,947,894,844,796,752,710,670,632,597,
563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,5075,4790,4521,4268,4028,3802,3589,3387,3197,3018,2848,2688,2538,2395,2261,2134,2014,1901,1794,1694,1599,1509,1424,1344,1269,1198,1130,1067,1007,951,897,847,799,754,712,672,634,599,565,533,504,475,449,423,400,377,356,336,317,299,283,267,252,238,224,212,200,189,178,168,159,150,141,133,5093,4808,4538,4283,4043,3816,3602,3399,3209,3029,2859,2698,2547,2404,2269,2142,2021,1908,1801,1700,1604,1514,1429,
1349,1273,1202,1134,1071,1011,954,900,850,802,757,715,675,637,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,238,225,212,201,189,179,169,159,150,142,134];window.neoart.DMPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"DMPlayer"},songs:{value:[],writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},voices:{value:[],writable:!0},buffer1:{value:0,writable:!0},buffer2:{value:0,writable:!0},song1:{value:0,writable:!0},song2:{value:0,writable:!0},trackPos:{value:0,
writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},patternEnd:{value:0,writable:!0},stepEnd:{value:0,writable:!0},numChannels:{value:0,writable:!0},arpeggios:{value:null,writable:!0},averages:{value:null,writable:!0},volumes:{value:null,writable:!0},mixChannel:{value:null,writable:!0},mixPeriod:{value:0,writable:!0},initialize:{value:function(){var a,g=0,d;this.reset();7<this.playSong&&(this.playSong=0);this.song1=this.songs[this.playSong];this.speed=this.song1.speed&15;
this.speed|=this.speed<<4;this.tick=this.song1.speed;this.patternPos=this.trackPos=0;this.patternLen=64;this.stepEnd=this.patternEnd=1;for(this.numChannels=4;7>g;++g)d=this.voices[g],d.initialize(),d.sample=this.samples[0],4>g&&(a=this.mixer.channels[g],a.enabled=0,a.pointer=this.mixer.loopPtr,a.length=2,a.period=124,a.volume=0,d.channel=a);if(2==this.version)for(0!=(this.playSong&1)&&this.playSong--,this.song2=this.songs[this.playSong+1],this.mixChannel=y(7),this.numChannels=7,a=this.mixer.channels[3],
a.mute=0,a.pointer=this.buffer1,a.length=350,a.period=this.mixPeriod,a.volume=64,a=this.buffer1+700,g=this.buffer1;g<a;++g)this.mixer.memory[g]=0}},loader:{value:function(a){var g,d=0,c,e,f,b;c=a.readString(24);if(" MUGICIAN/SOFTEYES 1990 "==c)this.version=1;else if(" MUGICIAN2/SOFTEYES 1990"==c)this.version=2;else return;a.position=28;for(e=new Uint32Array(8);8>d;++d)e[d]=a.readUint();a.position=76;for(d=0;8>d;++d)f=Object.create(null,{title:{value:"",writable:!0},speed:{value:0,writable:!0},length:{value:0,
writable:!0},loop:{value:0,writable:!0},loopStep:{value:0,writable:!0},tracks:{value:[],writable:!0}}),f.loop=a.readUbyte(),f.loopStep=a.readUbyte()<<2,f.speed=a.readUbyte(),f.length=a.readUbyte()<<2,f.title=a.readString(12),this.songs[d]=f;a.position=204;this.lastSong=this.songs.length-1;for(d=0;8>d;++d)for(f=this.songs[d],c=e[d]<<2,g=0;g<c;++g)b=E(),b.pattern=a.readUbyte()<<6,b.transpose=a.readByte(),f.tracks[g]=b;f=a.position;a.position=60;c=a.readUint();this.samples.length=++c;a.position=f;for(d=
1;d<c;++d)e=A(),Object.defineProperties(e,{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},finetune:{value:0,writable:!0},arpeggio:{value:0,writable:!0},pitch:{value:0,writable:!0},pitchDelay:{value:0,writable:!0},pitchLoop:{value:0,writable:!0},pitchSpeed:{value:0,writable:!0},effect:{value:0,writable:!0},effectDone:{value:0,writable:!0},effectStep:{value:0,writable:!0},effectSpeed:{value:0,writable:!0},source1:{value:0,writable:!0},source2:{value:0,writable:!0},volumeLoop:{value:0,writable:!0},
volumeSpeed:{value:0,writable:!0}}),b=Object.seal(e),b.wave=a.readUbyte(),b.waveLen=a.readUbyte()<<1,b.volume=a.readUbyte(),b.volumeSpeed=a.readUbyte(),b.arpeggio=a.readUbyte(),b.pitch=a.readUbyte(),b.effectStep=a.readUbyte(),b.pitchDelay=a.readUbyte(),b.finetune=a.readUbyte()<<6,b.pitchLoop=a.readUbyte(),b.pitchSpeed=a.readUbyte(),b.effect=a.readUbyte(),b.source1=a.readUbyte(),b.source2=a.readUbyte(),b.effectSpeed=a.readUbyte(),b.volumeLoop=a.readUbyte(),this.samples[d]=b;this.samples[0]=this.samples[1];
f=a.position;a.position=64;c=a.readUint()<<7;a.position=f;this.mixer.store(a,c);f=a.position;a.position=68;e=a.readUint();a.position=26;c=a.readUshort()<<6;this.patterns.length=c;a.position=f+(e<<5);e&&(e=f);for(d=0;d<c;++d)g=D(),g.note=a.readUbyte(),g.sample=a.readUbyte()&63,g.effect=a.readUbyte(),g.param=a.readByte(),this.patterns[d]=g;f=a.position;a.position=72;if(e)for(c=a.readUint(),a.position=f,g=this.mixer.store(a,c),f=a.position,this.mixer.memory.length+=350,this.buffer1=this.mixer.memory.length,
this.mixer.memory.length+=350,this.buffer2=this.mixer.memory.length,this.mixer.memory.length+=350,this.mixer.loopLen=8,c=this.samples.length,d=1;d<c;++d)b=this.samples[d],32>b.wave||(a.position=e+(b.wave-32<<5),b.pointer=a.readUint(),b.length=a.readUint()-b.pointer,b.loop=a.readUint(),b.name=a.readString(12),b.loop?(b.loop-=b.pointer,b.repeat=b.length-b.loop,0!=(b.repeat&1)&&b.repeat--):(b.loopPtr=this.mixer.memory.length,b.repeat=8),0!=(b.pointer&1)&&b.pointer--,0!=(b.length&1)&&b.length--,b.pointer+=
g,b.loopPtr||(b.loopPtr=b.pointer+b.loop));else f+=a.readUint();a.position=24;if(1==a.readUshort())for(a.position=f,c=a.length-a.position,256<c&&(c=256),d=0;d<c;++d)this.arpeggios[d]=a.readUbyte()}},process:{value:function(){for(var a,g,d=0,c,e,f,b=this.mixer.memory,h,m,l,n,u,r;d<this.numChannels;++d){r=this.voices[d];n=r.sample;3>d||4==this.numChannels?(a=r.channel,this.stepEnd&&(r.step=this.song1.tracks[this.trackPos+d]),31<n.wave&&(a.pointer=n.loopPtr,a.length=n.repeat)):(a=this.mixChannel,this.stepEnd&&
(r.step=this.song2.tracks[this.trackPos+(d-3)]));if(this.patternEnd&&(g=this.patterns[r.step.pattern+this.patternPos],g.note)){74!=g.effect&&(r.note=g.note,g.sample&&(n=r.sample=this.samples[g.sample]));r.val1=64>g.effect?1:g.effect-62;r.val2=g.param;c=r.step.transpose+n.finetune;12!=r.val1?(r.pitch=g.effect,1==r.val1&&(c+=r.pitch,r.period=0>c?0:t[c])):(r.pitch=g.note,c+=r.pitch,r.period=0>c?0:t[c]);11==r.val1&&(n.arpeggio=r.val2&7);if(12!=r.val1)if(31<n.wave)a.pointer=n.pointer,a.length=n.length,
a.enabled=0,r.mixPtr=n.pointer,r.mixEnd=n.pointer+n.length,r.mixMute=0;else if(g=n.wave<<7,a.pointer=g,a.length=n.waveLen,10!=r.val1&&(a.enabled=0),4==this.numChannels&&0!=n.effect&&2!=r.val1&&4!=r.val1){f=g+128;m=n.source1<<7;for(e=g;e<f;++e)b[e]=b[m++];n.effectStep=0;r.effectCtr=n.effectSpeed}3!=r.val1&&4!=r.val1&&12!=r.val1&&(r.volumeCtr=1,r.volumeStep=0);r.arpeggioStep=0;r.pitchCtr=n.pitchDelay;r.pitchStep=0;r.portamento=0}switch(r.val1){case 5:u=r.val2;0<u&&65>u&&(this.patternLen=u);break;case 6:u=
r.val2&15;u|=u<<4;if(0==r.val2||15<r.val2)break;this.speed=u;break;case 7:this.mixer.filter.active=1;break;case 8:this.mixer.filter.active=0;break;case 13:r.val1=0;u=r.val2&15;if(0==u)break;u=r.val2&240;if(0==u)break;this.speed=r.val2}}for(d=0;d<this.numChannels;++d){r=this.voices[d];n=r.sample;if(4==this.numChannels){if(a=r.channel,32>n.wave&&n.effect&&!n.effectDone)if(n.effectDone=1,r.effectCtr)r.effectCtr--;else switch(r.effectCtr=n.effectSpeed,g=n.wave<<7,n.effect){case 1:for(e=0;127>e;++e)u=
b[g],u+=b[g+1],b[g++]=u>>1;break;case 2:m=n.source1<<7;l=n.source2<<7;c=n.effectStep;f=n.waveLen;n.effectStep=++n.effectStep&127;for(e=0;e<f;++e)u=b[m++],u+=b[l+c],b[g++]=u>>1,c=++c&127;break;case 3:u=b[g];for(e=0;127>e;++e)b[g]=b[++g];b[g]=u;break;case 4:g+=127;u=b[g];for(e=0;127>e;++e)b[g]=b[--g];b[g]=u;break;case 5:c=u=g;for(e=0;64>e;++e)b[c++]=b[g++],g++;c=g=u;c+=64;for(e=0;64>e;++e)b[c++]=b[g++];break;case 6:m=g+64;g+=128;for(e=0;64>e;++e)b[--g]=b[--m],b[--g]=b[m];break;case 7:g+=n.effectStep;
b[g]=~b[g]+1;++n.effectStep>=n.waveLen&&(n.effectStep=0);break;case 8:n.effectStep=++n.effectStep&127;l=(n.source2<<7)+n.effectStep;c=b[l];f=n.waveLen;u=3;for(e=0;e<f;++e)m=b[g]+u,-128>m?m+=256:127<m&&(m-=256),b[g++]=m,u+=c,-128>u?u+=256:127<u&&(u-=256);break;case 9:l=n.source2<<7;f=n.waveLen;for(e=0;e<f;++e)u=b[l++],u+=b[g],127<u&&(u-=256),b[g++]=u;break;case 10:for(e=0;126>e;++e)u=3*b[g++],u+=b[g+1],b[g]=u>>2;break;case 11:m=n.source1<<7;l=n.source2<<7;f=n.waveLen;n.effectStep=++n.effectStep&127;
u=n.effectStep;64<=u&&(u=127-u);c=(u^255)&63;for(e=0;e<f;++e)h=b[m++]*u,h+=b[l++]*c,b[g++]=h>>6;break;case 12:m=n.source1<<7;l=n.source2<<7;f=n.waveLen;n.effectStep=++n.effectStep&31;u=n.effectStep;16<=u&&(u=31-u);c=(u^255)&15;for(e=0;e<f;++e)h=b[m++]*u,h+=b[l++]*c,b[g++]=h>>4;break;case 13:for(e=0;126>e;++e)u=b[g++],u+=b[g+1],b[g]=u>>1;break;case 14:c=g+n.effectStep;b[c]=~b[c]+1;c=n.effectStep+n.source2&n.waveLen-1;c+=g;b[c]=~b[c]+1;++n.effectStep>=n.waveLen&&(n.effectStep=0);break;case 15:c=g;for(e=
0;127>e;++e)u=b[g],u+=b[g+1],b[g++]=u>>1;g=c;n.effectStep++;if(n.effectStep==n.source2){n.effectStep=0;c=u=g;for(e=0;64>e;++e)b[c++]=b[g++],g++;c=g=u;c+=64;for(e=0;64>e;++e)b[c++]=b[g++]}}}else a=3>d?r.channel:this.mixChannel;r.volumeCtr&&(r.volumeCtr--,0==r.volumeCtr&&(r.volumeCtr=n.volumeSpeed,r.volumeStep=++r.volumeStep&127,r.volumeStep||n.volumeLoop?(c=r.volumeStep+(n.volume<<7),u=~(b[c]+129)+1,r.volume=(u&255)>>2,a.volume=r.volume):r.volumeCtr=0));u=r.note;n.arpeggio&&(c=r.arpeggioStep+(n.arpeggio<<
5),u+=this.arpeggios[c],r.arpeggioStep=++r.arpeggioStep&31);c=u+r.step.transpose+n.finetune;r.finalPeriod=t[c];g=r.finalPeriod;if(1==r.val1||12==r.val1)u=~r.val2+1,r.portamento+=u,r.finalPeriod+=r.portamento,r.val2&&(0>u&&r.finalPeriod<=r.period||0<=u&&r.finalPeriod>=r.period)&&(r.portamento=r.period-g,r.val2=0);n.pitch&&(r.pitchCtr?r.pitchCtr--:(c=r.pitchStep,r.pitchStep=++r.pitchStep&127,0==r.pitchStep&&(r.pitchStep=n.pitchLoop),c+=n.pitch<<7,u=b[c],r.finalPeriod+=~u+1));a.period=r.finalPeriod}if(4<
this.numChannels){m=this.buffer1;this.buffer1=this.buffer2;this.buffer2=m;a=this.mixer.channels[3];a.pointer=m;for(d=3;7>d;++d)r=this.voices[d],r.mixStep=0,125>r.finalPeriod?(r.mixMute=1,r.mixSpeed=0):(e=(r.finalPeriod<<8)/this.mixPeriod&65535,l=(256/e&255)<<8,g=256%e<<8&16777215,r.mixSpeed=(l|g/e&255)<<8),r.mixVolume=r.mixMute?0:r.volume<<8;for(d=0;350>d;++d){g=0;for(e=3;7>e;++e)r=this.voices[e],l=(b[r.mixPtr+(r.mixStep>>16)]&255)+r.mixVolume,g+=this.volumes[l],r.mixStep+=r.mixSpeed;b[m++]=this.averages[g]}a.length=
350;a.period=this.mixPeriod;a.volume=64}if(0==--this.tick){if(this.tick=this.speed&15,this.speed=(this.speed&240)>>4,this.speed|=this.tick<<4,this.patternEnd=1,this.patternPos++,64==this.patternPos||this.patternPos==this.patternLen)this.patternPos=0,this.stepEnd=1,this.trackPos+=4,this.trackPos==this.song1.length&&(this.trackPos=this.song1.loopStep,this.mixer.complete=1)}else this.stepEnd=this.patternEnd=0;for(d=0;d<this.numChannels;++d)r=this.voices[d],r.mixPtr+=r.mixStep>>16,n=r.sample,n.effectDone=
0,r.mixPtr>=r.mixEnd&&(n.loop?r.mixPtr-=n.repeat:(r.mixPtr=0,r.mixMute=1)),4>d&&(a=r.channel,a.enabled=1)}},tables:{value:function(){var a=0,g,d,c=0,e=0,f,b,h=128;this.averages=new Int32Array(1024);this.volumes=new Int32Array(16384);for(this.mixPeriod=203;1024>a;++a)127<h&&(h-=256),this.averages[a]=h,383<a&&639>a&&(h=++h&255);for(a=0;64>a;++a){f=-128;b=128;for(d=0;256>d;++d)h=f*e/63+128,g=c+b,this.volumes[g]=h&255,0!=a&&63!=a&&128<=b&&--this.volumes[g],f++,b=++b&255;c+=256;e++}}}});d.voices[0]=l();
d.voices[1]=l();d.voices[2]=l();d.voices[3]=l();d.voices[4]=l();d.voices[5]=l();d.voices[6]=l();d.arpeggios=new Uint8Array(256);d.tables();return Object.seal(d)}})();(function(){function l(t,d){return Object.create(null,{index:{value:t,writable:!0},bitFlag:{value:d,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},frqseqPtr:{value:0,writable:!0},
frqseqPos:{value:0,writable:!0},volseqPtr:{value:0,writable:!0},volseqPos:{value:0,writable:!0},volseqSpeed:{value:0,writable:!0},volseqCounter:{value:0,writable:!0},halve:{value:0,writable:!0},speed:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},flags:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},transpose:{value:0,writable:!0},portaDelay:{value:0,writable:!0},portaDelta:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibrato:{value:0,
writable:!0},vibratoDelta:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.speed=this.halve=this.volseqCounter=this.volseqSpeed=this.volseqPos=this.volseqPtr=this.frqseqPos=this.frqseqPtr=this.patternPos=this.trackPos=this.trackPtr=0;this.tick=1;this.busy=-1;this.vibratoDepth=this.vibratoSpeed=this.vibratoDelta=this.vibrato=this.portaSpeed=this.portaDelta=this.portaDelay=this.transpose=this.period=
this.note=this.flags=0}}})}window.neoart.DWPlayer=function(t){t=B(t);Object.defineProperties(t,{id:{value:"DWPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},stream:{value:null,writable:!0},song:{value:null,writable:!0},songvol:{value:0,writable:!0},master:{value:0,writable:!0},periods:{value:0,writable:!0},frqseqs:{value:0,writable:!0},volseqs:{value:0,writable:!0},transpose:{value:0,writable:!0},slower:{value:0,writable:!0},slowerCounter:{value:0,writable:!0},delaySpeed:{value:0,
writable:!0},delayCounter:{value:0,writable:!0},fadeSpeed:{value:0,writable:!0},fadeCounter:{value:0,writable:!0},wave:{value:null,writable:!0},waveCenter:{value:0,writable:!0},waveLo:{value:0,writable:!0},waveHi:{value:0,writable:!0},waveDir:{value:0,writable:!0},waveLen:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveRateNeg:{value:0,writable:!0},waveRatePos:{value:0,writable:!0},voices:{value:[],writable:!0},active:{value:0,writable:!0},complete:{value:0,writable:!0},variant:{value:0,writable:!0},
base:{value:0,writable:!0},com2:{value:0,writable:!0},com3:{value:0,writable:!0},com4:{value:0,writable:!0},readMix:{value:"",writable:!0},readLen:{value:0,writable:!0},initialize:{value:function(){var d,a,g=this.voices[this.active];this.reset();this.song=this.songs[this.playSong];this.songvol=this.master;this.speed=this.song.speed;this.transpose=0;this.slowerCounter=6;this.delaySpeed=this.song.delay;this.fadeCounter=this.fadeSpeed=this.delayCounter=0;if(this.wave){this.waveDir=0;this.wavePos=this.wave.pointer+
this.waveCenter;d=this.wave.pointer;for(a=this.wavePos;d<a;++d)this.mixer.memory[d]=this.waveRateNeg;for(a+=this.waveCenter;d<a;++d)this.mixer.memory[d]=this.waveRatePos}for(;g;)g.initialize(),g.channel=this.mixer.channels[g.index],g.sample=this.samples[0],this.complete+=g.bitFlag,g.trackPtr=this.song.tracks[g.index],g.trackPos=this.readLen,this.stream.position=g.trackPtr,g.patternPos=this.base+this.stream[this.readMix](),this.frqseqs&&(this.stream.position=this.frqseqs,g.frqseqPtr=this.base+this.stream.readUshort(),
g.frqseqPos=g.frqseqPtr),g=g.next}},loader:{value:function(d){var a,g,k,c,e,f,b=10,h,m;this.master=64;this.readMix="readUshort";this.readLen=2;this.variant=0;if(18663==d.readUshort()){d.position=4;if(24832!=d.readUshort())return;d.position+=d.readUshort();this.variant=30}else d.position=0;for(;20085!=m;){m=d.readUshort();switch(m){case 18426:this.base=d.position+d.readShort();break;case 24832:d.position+=2;e=d.position;24832==d.readUshort()&&(e=d.position+d.readUshort());break;case 49404:b=d.readUshort();
18==b?(this.readMix="readUint",this.readLen=4):this.variant=10;16890==d.readUshort()&&(g=d.position+d.readUshort());4656==d.readUshort()&&(a=1);break;case 4656:d.position-=6;16890==d.readUshort()&&(g=d.position+d.readUshort(),a=1);d.position+=4;break;case 48764:this.channels=d.readUshort(),d.position+=2,14204==d.readUshort()&&(this.master=d.readUshort())}if(20>d.bytesAvailable)return}c=d.position;this.songs=[];f=2147483647;h=0;for(d.position=g;;){g=Object.create(null,{speed:{value:0,writable:!0},
delay:{value:0,writable:!0},tracks:{value:null,writable:!0}});g.tracks=new Uint32Array(this.channels);a?(g.speed=d.readUbyte(),g.delay=d.readUbyte()):g.speed=d.readUshort();if(255<g.speed)break;for(k=0;k<this.channels;++k)m=this.base+d[this.readMix](),m<f&&(f=m),g.tracks[k]=m;this.songs[h++]=g;if(f-d.position<b)break}if(h&&(this.lastSong=this.songs.length-1,d.position=e,18987==d.readUshort())){g=b=0;for(this.wave=null;20085!=m;)switch(m=d.readUshort(),m){case 19450:if(g)break;e=d.position+d.readShort();
d.position++;h=d.readUbyte();d.position-=10;m=d.readUshort();a=d.position;16890==m||8314==m?g=d.position+d.readUshort():53500==m&&(g=64+d.readUshort(),d.position-=18,g+=d.position+d.readUshort());d.position=a;break;case 33987:if(b)break;d.position+=4;m=d.readUshort();56060==m?b=d.readUshort():56316==m&&(b=d.readUint());12==b&&30>this.variant&&(this.variant=20);a=d.position;this.samples=[];this.samples.length=++h;d.position=g;for(k=0;k<h;++k)m=A(),Object.defineProperties(m,{relative:{value:0,writable:!0},
finetune:{value:0,writable:!0}}),f=Object.seal(m),f.length=d.readUint(),f.relative=parseInt(3579545/d.readUshort()),f.pointer=this.mixer.store(d,f.length),m=d.position,d.position=e+k*b+4,f.loopPtr=d.readInt(),0==this.variant?(d.position+=6,f.volume=d.readUshort()):10==this.variant&&(d.position+=4,f.volume=d.readUshort(),f.finetune=d.readByte()),d.position=m,this.samples[k]=f;this.mixer.loopLen=64;d.length=g;d.position=a;break;case 8314:m=d.position+d.readShort();if(12860!=d.readUshort()){d.position-=
2;break}this.wave=this.samples[parseInt((m-e)/b)];this.waveCenter=d.readUshort()+1<<1;d.position+=2;this.waveRateNeg=d.readByte();d.position+=12;this.waveRatePos=d.readByte();break;case 1131:case 1643:h=d.readUshort(),f=this.samples[parseInt((d.readUshort()-e)/b)],f.relative=1643==m?f.relative+h:f.relative-h}if(this.samples.length){d.position=c;this.slower=this.volseqs=this.frqseqs=this.periods=0;this.com2=176;this.com3=160;for(this.com4=144;16<d.bytesAvailable;)switch(m=d.readUshort(),m){case 18426:d.position+=
2;if(18987!=d.readUshort())break;a=d.position;d.position+=4;m=d.readUshort();if(4154==m){if(d.position+=4,49404==d.readUshort()){m=d.readUshort();h=this.songs.length;for(k=0;k<h;++k)this.songs[k].delay*=m;d.position+=6}}else 21291==m&&(d.position-=8);m=d.readUshort();18987==m&&(d.position=this.base+d.readUshort(),this.slower=d.readByte());d.position=a;break;case 3179:d.position-=6;m=d.readUshort();if(21611==m||21099==m)d.position+=4,this.waveHi=this.wave.pointer+d.readUshort();else if(21867==m||21355==
m)d.position+=4,this.waveLo=this.wave.pointer+d.readUshort();this.waveLen=21611>m?1:2;break;case 32256:case 32257:case 32258:case 32259:this.active=m&15;h=this.channels-1;if(this.active)for(this.voices[0].next=null,k=h;0<k;)this.voices[k].next=this.voices[--k];else for(this.voices[h].next=null,k=0;k<h;)this.voices[k].next=this.voices[++k];break;case 3176:d.position+=22;3089==d.readUshort()&&(this.variant=40);break;case 12845:a=d.position;m=d.readUshort();if(10==m||12==m)d.position-=8,17914==d.readUshort()&&
(this.periods=d.position+d.readUshort());d.position=a+2;break;case 1024:case 1088:case 1536:m=d.readUshort();192==m||64==m?(this.com2=192,this.com3=176,this.com4=160):m==this.com3?(d.position+=2,17914==d.readUshort()&&(this.volseqs=d.position+d.readUshort(),40>this.variant&&(this.variant=30))):m==this.com4&&(d.position+=2,17914==d.readUshort()&&(this.frqseqs=d.position+d.readUshort()));break;case 20211:d.position+=2;case 20178:f=d.position,d.position-=10,d.position+=d.readUshort(),a=d.position,d.position=
a+2,d.position=this.base+d.readUshort()+10,18964==d.readUshort()&&(this.variant=41),d.position=a+16,m=this.base+d.readUshort(),m>f&&m<a&&(d.position=m,m=d.readUshort(),20712==m?this.variant=21:5977==m&&(this.variant=11)),d.position=a+20,m=this.base+d.readUshort(),m>f&&m<a&&(d.position=m+2,18560!=d.readUshort()&&(this.variant=31)),d.position=a+26,m=d.readUshort(),m>f&&m<a&&(this.variant=32),this.frqseqs&&(d.position=d.length)}this.periods&&(this.com2-=256,this.com3-=256,this.com4-=256,this.stream=
d,this.version=1)}}}},process:{value:function(){var d,a,g,k,c,e=this.voices[this.active];if(this.slower&&0==--this.slowerCounter)this.slowerCounter=6;else if(255<(this.delayCounter+=this.delaySpeed))this.delayCounter-=256;else{if(this.fadeSpeed&&(0==--this.fadeCounter&&(this.fadeCounter=this.fadeSpeed,this.songvol--),!this.songvol))if(this.loopSong)this.initialize();else{this.mixer.complete=1;return}this.wave&&(this.waveDir?(this.mixer.memory[this.wavePos++]=this.waveRatePos,1<this.waveLen&&(this.mixer.memory[this.wavePos++]=
this.waveRatePos),(this.wavePos-=this.waveLen<<1)==this.waveLo&&(this.waveDir=0)):(this.mixer.memory[this.wavePos++]=this.waveRateNeg,1<this.waveLen&&(this.mixer.memory[this.wavePos++]=this.waveRateNeg),this.wavePos==this.waveHi&&(this.waveDir=1)));for(;e;){d=e.channel;this.stream.position=e.patternPos;k=e.sample;e.busy||(e.busy=1,0>k.loopPtr?(d.pointer=this.mixer.loopPtr,d.length=this.mixer.loopLen):(d.pointer=k.pointer+k.loopPtr,d.length=k.length-k.loopPtr));if(0==--e.tick)for(e.flags=0,a=1;0<a;)if(c=
this.stream.readByte(),0>c)if(-32<=c)e.speed=this.speed*(c+33);else if(c>=this.com2)c-=this.com2,e.sample=k=this.samples[c];else if(c>=this.com3)g=this.stream.position,this.stream.position=this.volseqs+(c-this.com3<<1),this.stream.position=this.base+this.stream.readUshort(),e.volseqPtr=this.stream.position,this.stream.position--,e.volseqSpeed=this.stream.readUbyte(),this.stream.position=g;else if(c>=this.com4)g=this.stream.position,this.stream.position=this.frqseqs+(c-this.com4<<1),e.frqseqPtr=this.base+
this.stream.readUshort(),e.frqseqPos=e.frqseqPtr,this.stream.position=g;else switch(c){case -128:this.stream.position=e.trackPtr+e.trackPos;(c=this.stream[this.readMix]())?(this.stream.position=this.base+c,e.trackPos+=this.readLen):(this.stream.position=e.trackPtr,this.stream.position=this.base+this.stream[this.readMix](),e.trackPos=this.readLen,this.loopSong||(this.complete&=~e.bitFlag,this.complete||(this.mixer.complete=1)));break;case -127:0<this.variant&&(e.portaDelta=0);e.portaSpeed=this.stream.readByte();
e.portaDelay=this.stream.readUbyte();e.flags|=2;break;case -126:e.tick=e.speed;e.patternPos=this.stream.position;41==this.variant?(e.busy=1,d.enabled=0):(d.pointer=this.mixer.loopPtr,d.length=this.mixer.loopLen);a=0;break;case -125:0<this.variant&&(e.tick=e.speed,e.patternPos=this.stream.position,d.enabled=1,a=0);break;case -124:this.mixer.complete=1;break;case -123:0<this.variant&&(this.transpose=this.stream.readByte());break;case -122:e.vibrato=-1;e.vibratoSpeed=this.stream.readUbyte();e.vibratoDepth=
this.stream.readUbyte();e.vibratoDelta=0;break;case -121:e.vibrato=0;break;case -120:21==this.variant?e.halve=1:11==this.variant?this.fadeSpeed=this.stream.readUbyte():e.transpose=this.stream.readByte();break;case -119:21==this.variant?e.halve=0:(e.trackPtr=this.base+this.stream.readUshort(),e.trackPos=0);break;case -118:31==this.variant?this.delaySpeed=this.stream.readUbyte():this.speed=this.stream.readUbyte();break;case -117:this.fadeCounter=this.fadeSpeed=this.stream.readUbyte();break;case -116:c=
this.stream.readUbyte(),32!=this.variant&&(this.songvol=c)}else e.patternPos=this.stream.position,e.note=c+=k.finetune,e.tick=e.speed,e.busy=0,20<=this.variant?(c=c+this.transpose+e.transpose&255,this.stream.position=e.volseqPtr,a=this.stream.readUbyte(),e.volseqPos=this.stream.position,e.volseqCounter=e.volseqSpeed,e.halve&&(a>>=1),a=a*this.songvol>>6):a=k.volume,d.pointer=k.pointer,d.length=k.length,d.volume=a,this.stream.position=this.periods+(c<<1),c=this.stream.readUshort()*k.relative>>10,10>
this.variant&&(e.portaDelta=c),d.period=c,d.enabled=1,a=0;else 1==e.tick?30>this.variant?d.enabled=0:(c=this.stream.readUbyte(),131!=c&&(40>this.variant||224>c||131!=this.stream.readUbyte())&&(d.enabled=0)):0==this.variant?e.flags&2&&(e.portaDelay?e.portaDelay--:(e.portaDelta-=e.portaSpeed,d.period=e.portaDelta)):(this.stream.position=e.frqseqPos,c=this.stream.readByte(),0>c&&(c&=127,this.stream.position=e.frqseqPtr),e.frqseqPos=this.stream.position,c=c+e.note+this.transpose+e.transpose&255,this.stream.position=
this.periods+(c<<1),c=this.stream.readUshort()*k.relative>>10,e.flags&2&&(e.portaDelay?e.portaDelay--:(e.portaDelta+=e.portaSpeed,c-=e.portaDelta)),e.vibrato&&(0<e.vibrato?(e.vibratoDelta-=e.vibratoSpeed,e.vibratoDelta||(e.vibrato^=2147483648)):(e.vibratoDelta+=e.vibratoSpeed,e.vibratoDelta==e.vibratoDepth&&(e.vibrato^=2147483648)),e.vibratoDelta||(e.vibrato^=1),c=e.vibrato&1?c+e.vibratoDelta:c-e.vibratoDelta),d.period=c,20<=this.variant&&0>--e.volseqCounter&&(this.stream.position=e.volseqPos,a=this.stream.readByte(),
0<=a&&(e.volseqPos=this.stream.position),e.volseqCounter=e.volseqSpeed,a&=127,e.halve&&(a>>=1),d.volume=a*this.songvol>>6));e=e.next}}}}});t.voices[0]=l(0,1);t.voices[1]=l(1,2);t.voices[2]=l(2,4);t.voices[3]=l(3,8);return Object.seal(t)}})();(function(){function p(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},soundTranspose:{value:0,
writable:!0},transpose:{value:0,writable:!0},patStep:{value:0,writable:!0},frqStep:{value:0,writable:!0},frqPos:{value:0,writable:!0},frqSustain:{value:0,writable:!0},frqTranspose:{value:0,writable:!0},volStep:{value:0,writable:!0},volPos:{value:0,writable:!0},volCtr:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},note:{value:0,writable:!0},pitch:{value:0,writable:!0},volume:{value:0,writable:!0},pitchBendFlag:{value:0,writable:!0},pitchBendSpeed:{value:0,writable:!0},
pitchBendTime:{value:0,writable:!0},portamentoFlag:{value:0,writable:!0},portamento:{value:0,writable:!0},volBendFlag:{value:0,writable:!0},volBendSpeed:{value:0,writable:!0},volBendTime:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibrato:{value:0,writable:!0},initialize:{value:function(){this.sample=null;this.volPos=this.volStep=this.frqTranspose=this.frqSustain=this.frqPos=this.frqStep=
this.patStep=this.transpose=this.soundTranspose=this.pattern=this.enabled=0;this.volSpeed=this.volCtr=1;this.vibrato=this.vibratoDelay=this.vibratoDepth=this.vibratoSpeed=this.vibratoFlag=this.volBendTime=this.volBendSpeed=this.volBendFlag=this.portamento=this.portamentoFlag=this.pitchBendTime=this.pitchBendSpeed=this.pitchBendFlag=this.volume=this.pitch=this.note=this.volSustain=0}},volumeBend:{value:function(){if(this.volBendFlag^=1)if(this.volBendTime--,this.volume+=this.volBendSpeed,0>this.volume||
64<this.volume)this.volBendTime=0}}})}var t=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,
240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113],d=[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,8,8,8,8,8,8,8,8,16,8,16,16,8,8,24,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,63,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,55,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,
-48,-56,-64,-72,47,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,39,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,31,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,23,15,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,15,7,-1,7,15,23,31,39,47,55,-64,
-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,7,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-1,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,7,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,15,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,
0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,23,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,31,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,39,47,55,-64,-64,-48,-40,-32,-24,-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,47,55,-64,-64,-48,-40,-32,-24,
-16,-8,0,-8,-16,-24,-32,-40,-48,-56,-64,-72,-80,-88,-96,-104,-112,-120,-128,-120,-112,-104,-96,-88,-80,55,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,
127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,
-127,-127,-127,-127,-127,-127,127,127,127,127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,-127,127,127,127,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,127,127,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,-128,
-128,-128,-128,127,-128,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,
-128,-128,127,127,127,127,127,127,127,127,127,127,127,127,127,127,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,0,16,32,48,64,80,96,112,69,69,121,125,122,119,112,102,97,88,83,77,44,32,24,18,4,-37,-45,-51,-58,-68,-75,-82,-88,-93,-99,-103,-109,-114,-117,-118,69,69,121,125,122,119,112,102,91,75,67,55,44,32,24,18,4,-8,-24,-37,-49,-58,-66,-80,-88,-92,-98,-102,-107,-108,-115,-125,0,0,64,96,127,96,64,
32,0,-32,-64,-96,-128,-96,-64,-32,0,0,64,96,127,96,64,32,0,-32,-64,-96,-128,-96,-64,-32,-128,-128,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,8,16,24,32,40,48,56,64,72,80,88,96,104,112,127,-128,-128,-96,-80,-64,-48,-32,-16,0,16,32,48,64,80,96,112];window.neoart.FCPlayer=function(a){a=B(a);Object.defineProperties(a,{id:{value:"FCPlayer"},seqs:{value:null,writable:!0},pats:{value:null,writable:!0},vols:{value:null,writable:!0},frqs:{value:null,writable:!0},length:{value:0,writable:!0},
samples:{value:[],writable:!0},voices:{value:[],writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.seqs.position=0;this.pats.position=0;this.vols.position=0;for(this.frqs.position=0;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.pattern=this.seqs.readUbyte()<<6,a.transpose=this.seqs.readByte(),a.soundTranspose=this.seqs.readByte(),a=a.next;this.speed=this.seqs.readUbyte();this.speed||(this.speed=3);this.tick=this.speed}},loader:{value:function(a){var k,c,
e,f,b,h,m,q,n;c=a.readString(4);if("SMOD"==c)this.version=1;else if("FC14"==c)this.version=2;else return;a.position=4;this.length=a.readUint();a.position=1==this.version?100:180;this.seqs=l(new ArrayBuffer(this.length));a.readBytes(this.seqs,0,this.length);this.length=this.length/13>>0;a.position=12;e=a.readUint();a.position=8;a.position=a.readUint();this.pats=l(new ArrayBuffer(e+1));a.readBytes(this.pats,0,e);a.position=20;e=a.readUint();a.position=16;a.position=a.readUint();this.frqs=l(new ArrayBuffer(e+
9));this.frqs.writeInt(16777216);this.frqs.writeInt(225);a.readBytes(this.frqs,8,e);this.frqs.position=this.frqs.length-1;this.frqs.writeByte(225);this.frqs.position=0;a.position=28;e=a.readUint();a.position=24;a.position=a.readUint();this.vols=l(new ArrayBuffer(e+8));this.vols.writeInt(16777216);this.vols.writeInt(225);a.readBytes(this.vols,8,e);a.position=32;m=a.readUint();a.position=40;1==this.version?(this.samples.length=57,f=0):(this.samples.length=200,f=2);for(k=0;10>k;++k)if(e=a.readUshort()<<
1,0<e)if(b=a.position,a.position=m,c=a.readString(4),"SSMP"==c){q=e;for(c=0;10>c;++c)a.readInt(),e=a.readUshort()<<1,0<e?(h=A(),h.length=e+2,h.loop=a.readUshort(),h.repeat=a.readUshort()<<1,h.loop+h.repeat>h.length&&(h.repeat=h.length-h.loop),m+h.length>a.length&&(h.length=a.length-m),h.pointer=this.mixer.store(a,h.length,m+n),h.loopPtr=h.pointer+h.loop,this.samples[100+10*k+c]=h,n+=h.length,a.position+=6):a.position+=10;m+=q+2;a.position=b+4}else a.position=b,h=A(),h.length=e+f,h.loop=a.readUshort(),
h.repeat=a.readUshort()<<1,h.loop+h.repeat>h.length&&(h.repeat=h.length-h.loop),m+h.length>a.length&&(h.length=a.length-m),h.pointer=this.mixer.store(a,h.length,m),h.loopPtr=h.pointer+h.loop,this.samples[k]=h,m+=h.length;else a.position+=4;if(1==this.version)for(f=0,q=47,k=10;57>k;++k)for(h=A(),h.length=d[f++]<<1,h.loop=0,h.repeat=h.length,b=this.mixer.memory.length,h.pointer=b,h.loopPtr=b,this.samples[k]=h,e=b+h.length,c=b;c<e;++c)this.mixer.memory[c]=d[q++];else for(a.position=36,m=a.readUint(),
a.position=100,k=10;90>k;++k)e=a.readUbyte()<<1,2>e||(h=A(),h.length=e,h.loop=0,h.repeat=h.length,m+h.length>a.length&&(h.length=a.length-m),h.pointer=this.mixer.store(a,h.length,m),h.loopPtr=h.pointer,this.samples[k]=h,m+=h.length);this.length*=13}},process:{value:function(){var a,d,c,e,f,b=this.voices[0];if(0==--this.tick){for(a=this.seqs.position;b;){d=b.channel;this.pats.position=b.pattern+b.patStep;f=this.pats.readUbyte();if(64<=b.patStep||73==f)this.seqs.position==this.length&&(this.seqs.position=
0,this.mixer.complete=1),b.patStep=0,b.pattern=this.seqs.readUbyte()<<6,b.transpose=this.seqs.readByte(),b.soundTranspose=this.seqs.readByte(),this.pats.position=b.pattern,f=this.pats.readUbyte();c=this.pats.readUbyte();this.frqs.position=0;this.vols.position=0;0!=f&&(b.note=f&127,b.pitch=0,b.portamento=0,b.enabled=d.enabled=0,f=8+((c&63)+b.soundTranspose<<6),0<=f&&f<this.vols.length&&(this.vols.position=f),b.volStep=0,b.volSpeed=b.volCtr=this.vols.readUbyte(),b.volSustain=0,b.frqPos=8+(this.vols.readUbyte()<<
6),b.frqStep=0,b.frqSustain=0,b.vibratoFlag=0,b.vibratoSpeed=this.vols.readUbyte(),b.vibratoDepth=b.vibrato=this.vols.readUbyte(),b.vibratoDelay=this.vols.readUbyte(),b.volPos=this.vols.position);c&64?b.portamento=0:c&128&&(b.portamento=this.pats[this.pats.position+1],1==this.version&&(b.portamento<<=1));b.patStep+=2;b=b.next}this.seqs.position!=a&&(f=this.seqs.readUbyte())&&(this.speed=f);this.tick=this.speed}for(b=this.voices[0];b;){d=b.channel;do{a=0;if(b.frqSustain){b.frqSustain--;break}this.frqs.position=
b.frqPos+b.frqStep;do{e=0;if(!this.frqs.bytesAvailable)break;c=this.frqs.readUbyte();if(225==c)break;224==c&&(b.frqStep=this.frqs.readUbyte()&63,this.frqs.position=b.frqPos+b.frqStep,c=this.frqs.readUbyte());switch(c){case 226:d.enabled=0,b.enabled=1,b.volCtr=1,b.volStep=0;case 228:(c=this.samples[this.frqs.readUbyte()])?(d.pointer=c.pointer,d.length=c.length):b.enabled=0;b.sample=c;b.frqStep+=2;break;case 233:f=100+10*this.frqs.readUbyte();if(c=this.samples[f+this.frqs.readUbyte()])d.enabled=0,d.pointer=
c.pointer,d.length=c.length,b.enabled=1;b.sample=c;b.volCtr=1;b.volStep=0;b.frqStep+=3;break;case 231:e=1;b.frqPos=8+(this.frqs.readUbyte()<<6);b.frqPos>=this.frqs.length&&(b.frqPos=0);b.frqStep=0;this.frqs.position=b.frqPos;break;case 234:b.pitchBendSpeed=this.frqs.readByte();b.pitchBendTime=this.frqs.readUbyte();b.frqStep+=3;break;case 232:a=1;b.frqSustain=this.frqs.readUbyte();b.frqStep+=2;break;case 227:b.vibratoSpeed=this.frqs.readUbyte(),b.vibratoDepth=this.frqs.readUbyte(),b.frqStep+=3}a||
e||(this.frqs.position=b.frqPos+b.frqStep,b.frqTranspose=this.frqs.readByte(),b.frqStep++)}while(e)}while(a);if(b.volSustain)b.volSustain--;else if(b.volBendTime)b.volumeBend();else if(0==--b.volCtr){b.volCtr=b.volSpeed;do{e=0;this.vols.position=b.volPos+b.volStep;if(!this.vols.bytesAvailable)break;c=this.vols.readUbyte();if(225==c)break;switch(c){case 234:b.volBendSpeed=this.vols.readByte();b.volBendTime=this.vols.readUbyte();b.volStep+=3;b.volumeBend();break;case 232:b.volSustain=this.vols.readUbyte();
b.volStep+=2;break;case 224:e=1;f=this.vols.readUbyte()&63;b.volStep=f-5;break;default:b.volume=c,b.volStep++}}while(e)}c=b.frqTranspose;0<=c&&(c+=b.note+b.transpose);c&=127;e=t[c];if(b.vibratoDelay)b.vibratoDelay--;else{f=b.vibrato;b.vibratoFlag?(a=b.vibratoDepth<<1,f+=b.vibratoSpeed,f>a&&(f=a,b.vibratoFlag=0)):(f-=b.vibratoSpeed,0>f&&(f=0,b.vibratoFlag=1));b.vibrato=f;f-=b.vibratoDepth;for(a=(c<<1)+160;256>a;)f<<=1,a+=24;e+=f}b.portamentoFlag^=1;b.portamentoFlag&&b.portamento&&(b.pitch=31<b.portamento?
b.pitch+(b.portamento&31):b.pitch-b.portamento);b.pitchBendFlag^=1;b.pitchBendFlag&&b.pitchBendTime&&(b.pitchBendTime--,b.pitch-=b.pitchBendSpeed);e+=b.pitch;113>e?e=113:3424<e&&(e=3424);d.period=e;d.volume=b.volume;b.sample&&(c=b.sample,d.enabled=b.enabled,d.pointer=c.loopPtr,d.length=c.repeat);b=b.next}}}});a.voices[0]=p(0);a.voices[0].next=a.voices[1]=p(1);a.voices[1].next=a.voices[2]=p(2);a.voices[2].next=a.voices[3]=p(3);return Object.seal(a)}})();(function(){function p(d,a){return Object.create(null,
{index:{value:d,writable:!0},bitFlag:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},synth:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},envelopePos:{value:0,writable:!0},sustainTime:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},arpeggioSpeed:{value:0,
writable:!0},portamento:{value:0,writable:!0},portaCounter:{value:0,writable:!0},portaDelay:{value:0,writable:!0},portaFlag:{value:0,writable:!0},portaLimit:{value:0,writable:!0},portaNote:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoFlag:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pulseCounter:{value:0,writable:!0},pulseDelay:{value:0,
writable:!0},pulseDir:{value:0,writable:!0},pulsePos:{value:0,writable:!0},pulseSpeed:{value:0,writable:!0},blendCounter:{value:0,writable:!0},blendDelay:{value:0,writable:!0},blendDir:{value:0,writable:!0},blendPos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.patternPos=this.trackPos=0;this.busy=this.tick=1;this.blendPos=this.blendDir=this.blendDelay=this.blendCounter=this.pulseSpeed=this.pulsePos=this.pulseDir=this.pulseDelay=this.pulseCounter=this.vibratoSpeed=
this.vibratoFlag=this.vibratoDepth=this.vibratoDelay=this.vibrato=this.portaSpeed=this.portaPeriod=this.portaNote=this.portaLimit=this.portaFlag=this.portaDelay=this.portaCounter=this.portamento=this.arpeggioSpeed=this.arpeggioPos=this.sustainTime=this.envelopePos=this.volume=this.period=this.note=0}}})}var t=[8192,7728,7296,6888,6504,6136,5792,5464,5160,4872,4600,4336,4096,3864,3648,3444,3252,3068,2896,2732,2580,2436,2300,2168,2048,1932,1824,1722,1626,1534,1448,1366,1290,1218,1150,1084,1024,966,
912,861,813,767,724,683,645,609,575,542,512,483,456,430,406,383,362,341,322,304,287,271,256,241,228,215,203,191,181,170,161,152,143,135];window.neoart.FEPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"FEPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},patterns:{value:null,writable:!0},song:{value:null,writable:!0},voices:{value:[],writable:!0},complete:{value:0,writable:!0},sampFlag:{value:0,writable:!0},initialize:{value:function(){var a,d,k=this.voices[3];this.reset();
this.song=this.songs[this.playSong];this.speed=this.song.speed;for(this.complete=15;k;){k.initialize();k.channel=this.mixer.channels[k.index];k.patternPos=this.song.tracks[k.index][0];a=k.synth;for(d=a+64;a<d;++a)this.mixer.memory[a]=0;k=k.next}}},loader:{value:function(a){for(var d,k,c,e,f,b,h,m,q,n;16>a.position;)if(h=a.readUshort(),a.position+=2,20218!=h)return;for(;1024>a.position;)if(h=a.readUshort(),4666==h)a.position+=2,h=a.readUshort(),45057==h&&(a.position-=4,k=a.position+a.readUshort()-
2197);else if(8522==h&&(a.position+=2,h=a.readUshort(),18426==h)){d=a.position+a.readShort();this.version=1;break}if(this.version){a.position=k+2210;b=a.readUint();a.position=d+b;this.samples=[];for(b=2147483647;b>a.position;){if(h=a.readUint()){if(h<a.position||h>=a.length){a.position-=4;break}h<b&&(b=d+h)}e=Object.create(null,{pointer:{value:0,writable:!0},loopPtr:{value:0,writable:!0},length:{value:0,writable:!0},relative:{value:0,writable:!0},type:{value:0,writable:!0},synchro:{value:0,writable:!0},
envelopeVol:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},attackVol:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayVol:{value:0,writable:!0},sustainTime:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseVol:{value:0,writable:!0},arpeggio:{value:null,writable:!0},arpeggioLimit:{value:0,writable:!0},arpeggioSpeed:{value:0,writable:!0},vibratoDelay:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pulseCounter:{value:0,writable:!0},
pulseDelay:{value:0,writable:!0},pulsePosL:{value:0,writable:!0},pulsePosH:{value:0,writable:!0},pulseSpeed:{value:0,writable:!0},pulseRateNeg:{value:0,writable:!0},pulseRatePos:{value:0,writable:!0},blendCounter:{value:0,writable:!0},blendDelay:{value:0,writable:!0},blendRate:{value:0,writable:!0}});e.pointer=h;e.loopPtr=a.readShort();e.length=a.readUshort()<<1;e.relative=a.readUshort();e.vibratoDelay=a.readUbyte();a.position++;e.vibratoSpeed=a.readUbyte();e.vibratoDepth=a.readUbyte();e.envelopeVol=
a.readUbyte();e.attackSpeed=a.readUbyte();e.attackVol=a.readUbyte();e.decaySpeed=a.readUbyte();e.decayVol=a.readUbyte();e.sustainTime=a.readUbyte();e.releaseSpeed=a.readUbyte();e.releaseVol=a.readUbyte();e.arpeggio=new Int8Array(16);for(c=0;16>c;++c)e.arpeggio[c]=a.readByte();e.arpeggioSpeed=a.readUbyte();e.type=a.readByte();e.pulseRateNeg=a.readByte();e.pulseRatePos=a.readUbyte();e.pulseSpeed=a.readUbyte();e.pulsePosL=a.readUbyte();e.pulsePosH=a.readUbyte();e.pulseDelay=a.readUbyte();e.synchro=a.readUbyte();
e.blendRate=a.readUbyte();e.blendDelay=a.readUbyte();e.pulseCounter=a.readUbyte();e.blendCounter=a.readUbyte();e.arpeggioLimit=a.readUbyte();a.position+=12;this.samples.push(e);if(!a.bytesAvailable)break}if(2147483647!=b)for(this.mixer.store(a,a.length-b),f=this.samples.length,c=0;c<f;++c)e=this.samples[c],e.pointer&&(e.pointer-=d+b);b=this.mixer.memory.length;this.mixer.memory.length+=256;this.mixer.loopLen=100;for(c=0;4>c;++c)this.voices[c].synth=b,b+=64;a.position=k+2210;f=a.readUint();b=a.readUint();
a.position=d+b;this.patterns=l(new ArrayBuffer(f-b));a.readBytes(this.patterns,0,f-b);b+=d;a.position=k+2197;this.lastSong=f=a.readUbyte();this.songs=[];this.songs.length=++f;d=k+2830;n=b-d;for(c=b=0;c<f;++c){q=Object.create(null,{speed:{value:0,writable:!0},length:{value:0,writable:!0},tracks:{value:[],writable:!0}});q.tracks=[];for(e=0;4>e;++e){a.position=d+b;h=a.readUshort();m=3==e&&c==f-1?n:a.readUshort();m=m-h>>1;m>q.length&&(q.length=m);q.tracks[e]=new Uint32Array(m);a.position=d+h;for(h=0;h<
m;++h)q.tracks[e][h]=a.readUshort();b+=2}a.position=k+2199+c;q.speed=a.readUbyte();this.songs[c]=q}a.clear()}}},process:{value:function(){for(var a,d,k,c,e,f,b=this.voices[3];b;){a=b.channel;e=0;do if(this.patterns.position=b.patternPos,f=b.sample,this.sampFlag=0,b.busy||(b.busy=1,0==f.loopPtr?(a.pointer=this.mixer.loopPtr,a.length=this.mixer.loopLen):0<f.loopPtr&&(a.pointer=f.type?b.synth:f.pointer+f.loopPtr,a.length=f.length-f.loopPtr)),0==--b.tick)for(e=2;1<e;)if(k=this.patterns.readByte(),0>k)switch(k){case -125:b.sample=
f=this.samples[this.patterns.readUbyte()];this.sampFlag=1;b.patternPos=this.patterns.position;break;case -126:this.speed=this.patterns.readUbyte();b.patternPos=this.patterns.position;break;case -127:k=f?f.relative:428;b.portaSpeed=this.patterns.readUbyte()*this.speed;b.portaNote=this.patterns.readUbyte();b.portaLimit=t[b.portaNote]*k>>10;b.portamento=0;b.portaDelay=this.patterns.readUbyte()*this.speed;b.portaFlag=1;b.patternPos=this.patterns.position;break;case -124:a.enabled=0;b.tick=this.speed;
b.busy=1;b.patternPos=this.patterns.position;e=0;break;case -128:for(b.trackPos++;;)if(k=this.song.tracks[b.index][b.trackPos],65535==k)this.mixer.complete=1;else if(32767<k)b.trackPos=(k^32768)>>1,this.loopSong||(this.complete&=~b.bitFlag,this.complete||(this.mixer.complete=1));else{b.patternPos=k;e=b.tick=1;break}break;default:b.tick=this.speed*-k,b.patternPos=this.patterns.position,e=0}else{e=0;b.patternPos=this.patterns.position;b.note=k;b.arpeggioPos=0;b.vibratoFlag=-1;b.vibrato=0;b.arpeggioSpeed=
f.arpeggioSpeed;b.vibratoDelay=f.vibratoDelay;b.vibratoSpeed=f.vibratoSpeed;b.vibratoDepth=f.vibratoDepth;if(1==f.type){if(this.sampFlag||f.synchro&2){b.pulseCounter=f.pulseCounter;b.pulseDelay=f.pulseDelay;b.pulseDir=0;b.pulsePos=f.pulsePosL;b.pulseSpeed=f.pulseSpeed;d=b.synth;for(c=d+f.pulsePosL;d<c;++d)this.mixer.memory[d]=f.pulseRateNeg;for(c+=f.length-f.pulsePosL;d<c;++d)this.mixer.memory[d]=f.pulseRatePos}a.pointer=b.synth}else if(2==f.type){b.blendCounter=f.blendCounter;b.blendDelay=f.blendDelay;
b.blendDir=0;b.blendPos=1;d=f.pointer;k=b.synth;for(c=d+31;d<c;++d)this.mixer.memory[k++]=this.mixer.memory[d];a.pointer=b.synth}else a.pointer=f.pointer;b.tick=this.speed;b.busy=0;b.period=t[b.note]*f.relative>>10;b.volume=0;b.envelopePos=0;b.sustainTime=f.sustainTime;a.length=f.length;a.period=b.period;a.volume=0;a.enabled=1;b.portaFlag&&!b.portamento&&(b.portamento=b.period,b.portaCounter=1,b.portaPeriod=b.portaLimit-b.period)}else 1==b.tick&&(k=this.patterns.readAt(b.patternPos)-160&255,127<k&&
(a.enabled=0));while(0<e);if(a.enabled){k=b.note+f.arpeggio[b.arpeggioPos];0==--b.arpeggioSpeed&&(b.arpeggioSpeed=f.arpeggioSpeed,++b.arpeggioPos==f.arpeggioLimit&&(b.arpeggioPos=0));b.period=t[k]*f.relative>>10;b.portaFlag&&(b.portaDelay?b.portaDelay--:(b.period+=b.portaCounter*b.portaPeriod/b.portaSpeed,++b.portaCounter>b.portaSpeed&&(b.note=b.portaNote,b.portaFlag=0)));b.vibratoDelay?b.vibratoDelay--:b.vibratoFlag&&(0>b.vibratoFlag?(b.vibrato+=b.vibratoSpeed,b.vibrato==b.vibratoDepth&&(b.vibratoFlag^=
2147483648)):(b.vibrato-=b.vibratoSpeed,0==b.vibrato&&(b.vibratoFlag^=2147483648)),0==b.vibrato&&(b.vibratoFlag^=1),b.period=b.vibratoFlag&1?b.period+b.vibrato:b.period-b.vibrato);a.period=b.period;switch(b.envelopePos){case 0:b.volume+=f.attackSpeed;b.volume>=f.attackVol&&(b.volume=f.attackVol,b.envelopePos=1);break;case 1:b.volume-=f.decaySpeed;b.volume<=f.decayVol&&(b.volume=f.decayVol,b.envelopePos=2);break;case 2:b.sustainTime?b.sustainTime--:b.envelopePos=3;break;case 3:b.volume-=f.releaseSpeed,
b.volume<=f.releaseVol&&(b.volume=f.releaseVol,b.envelopePos=4)}k=f.envelopeVol<<12;k>>=8;k>>=4;k*=b.volume;k>>=8;k>>=1;a.volume=k;if(1==f.type)if(b.pulseDelay)b.pulseDelay--;else if(b.pulseSpeed)b.pulseSpeed--;else{if(b.pulseCounter||!(f.synchro&1)){b.pulseSpeed=f.pulseSpeed;if(b.pulseDir&4)for(;;){if(b.pulsePos>=f.pulsePosL){e=1;break}b.pulseDir&=-5;b.pulsePos++;b.pulseCounter--;if(b.pulsePos<=f.pulsePosH){e=2;break}b.pulseDir|=4;b.pulsePos--;b.pulseCounter--}else for(;;){if(b.pulsePos<=f.pulsePosH){e=
2;break}b.pulseDir|=4;b.pulsePos--;b.pulseCounter--;if(b.pulsePos>=f.pulsePosL){e=1;break}b.pulseDir&=-5;b.pulsePos++;b.pulseCounter++}a=b.synth+b.pulsePos;1==e?(this.mixer.memory[a]=f.pulseRatePos,b.pulsePos--):(this.mixer.memory[a]=f.pulseRateNeg,b.pulsePos++)}}else if(2==f.type)if(b.blendDelay)b.blendDelay--;else if(b.blendCounter||!(f.synchro&4))for(b.blendDir?1!=b.blendPos?b.blendPos--:(b.blendDir^=1,b.blendCounter--):b.blendPos!=f.blendRate<<1?b.blendPos++:(b.blendDir^=1,b.blendCounter--),d=
f.pointer,c=d+31,a=c+1;d<c;++d)k=b.blendPos*this.mixer.memory[a++]>>f.blendRate,this.mixer.memory[a++]=k+this.mixer.memory[d]}b=b.next}}}});d.voices[3]=p(3,8);d.voices[3].next=d.voices[2]=p(2,4);d.voices[2].next=d.voices[1]=p(1,2);d.voices[1].next=d.voices[0]=p(0,1);return Object.seal(d)}})();(function(){function l(d){return Object.create(null,{index:{value:d,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,
writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},last:{value:0,writable:!0},slideCtr:{value:0,writable:!0},slideDir:{value:0,writable:!0},slideParam:{value:0,writable:!0},slidePeriod:{value:0,writable:!0},slideSpeed:{value:0,writable:!0},stepPeriod:{value:0,writable:!0},stepSpeed:{value:0,writable:!0},stepWanted:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.stepWanted=this.stepSpeed=this.stepPeriod=this.slideSpeed=
this.slidePeriod=this.slideParam=this.slideDir=this.slideCtr=this.last=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var t=[1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,113,-1];window.neoart.FXPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"FXPlayer"},
standard:{value:0,writable:!0},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},delphine:{value:0,writable:!0},force:{set:function(a){1>a?a=1:4<a&&(a=4);this.version=a}},ntsc:{set:function(a){this.standard=a;this.frequency(a);a=this.sampleRate/1E3*(a?20.44952532:20.637767904)/120;this.mixer.samplesTick=
this.tempo/122*a>>0}},initialize:{value:function(){var a=this.voices[0];this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var d=0,k,c,e,f,b=0,h;if(!(1686>a.length)){a.position=60;k=a.readString(4);if("SONG"!=k){a.position=124;k=a.readString(4);if("SO31"!=k||2350>a.length)return;e=544;this.samples.length=c=32;this.version=4}else e=
0,this.samples.length=c=16,this.version=1;this.tempo=a.readUshort();a.position=0;for(k=1;k<c;++k)(h=a.readUint())?(f=A(),f.pointer=b,b+=h,this.samples[k]=f):this.samples[k]=null;a.position+=20;for(k=1;k<c;++k)(f=this.samples[k])?(f.name=a.readString(22),f.length=a.readUshort()<<1,f.volume=a.readUshort(),f.loop=a.readUshort(),f.repeat=a.readUshort()<<1):a.position+=30;a.position=530+e;this.length=c=a.readUbyte();a.position++;for(k=0;k<c;++k)h=a.readUbyte()<<8,this.track[k]=h,h>d&&(d=h);e&&(e+=4);a.position=
660+e;d+=256;this.patterns.length=d;c=this.samples.length;for(k=0;k<d;++k){e=D();e.note=a.readShort();h=a.readUbyte();e.param=a.readUbyte();e.effect=h&15;e.sample=h>>4;this.patterns[k]=e;if(4==this.version)e.note&4096&&(e.sample+=16,0<e.note&&(e.note&=61439));else{if(9==e.effect||856<e.note)this.version=2;-3>e.note&&(this.version=3)}if(e.sample>=c||null==this.samples[e.sample])e.sample=0}this.mixer.store(a,b);for(k=1;k<c;++k)if(f=this.samples[k])for(f.loop?f.loopPtr=f.pointer+f.loop:(f.loopPtr=this.mixer.memory.length,
f.repeat=2),b=f.pointer+4,d=f.pointer;d<b;++d)this.mixer.memory[d]=0;f=A();f.pointer=f.loopPtr=this.mixer.memory.length;f.length=f.repeat=2;this.samples[0]=f;for(k=a.position=d=this.delphine=0;265>k;++k)d+=a.readUshort();switch(d){case 172662:case 1391423:case 1458300:case 1706977:case 1920077:case 1920694:case 1677853:case 1931956:case 1926836:case 1385071:case 1720635:case 1714491:case 1731874:case 1437490:this.delphine=1}}}},process:{value:function(){var a,d,k,c=this.voices[0];if(this.tick)for(;c;){a=
c.channel;if(2!=this.version||-3!=c.period)if(c.stepSpeed)c.stepPeriod+=c.stepSpeed,0>c.stepSpeed?c.stepPeriod<c.stepWanted&&(c.stepPeriod=c.stepWanted,2<this.version&&(c.stepSpeed=0)):c.stepPeriod>c.stepWanted&&(c.stepPeriod=c.stepWanted,2<this.version&&(c.stepSpeed=0)),2<this.version&&(c.last=c.stepPeriod),a.period=c.stepPeriod;else{if(c.slideSpeed&&(k=c.slideParam&15))if(++c.slideCtr==k)c.slideCtr=0,k=c.slideParam<<4<<3,c.slideDir?(c.slidePeriod-=8,a.period=c.slidePeriod,k-=c.slideSpeed,k==c.slidePeriod&&
(c.slideDir=0)):(c.slidePeriod+=8,a.period=c.slidePeriod,k+=c.slideSpeed,k==c.slidePeriod&&(c.slideDir=1));else{c=c.next;continue}k=0;switch(c.effect){case 1:k=this.tick%3;d=0;if(2==k){a.period=c.last;c=c.next;continue}for(k=1==k?c.param&15:c.param>>4;c.last!=t[d];)d++;a.period=t[d+k];break;case 2:k=c.param>>4;c.period=k?c.period+k:c.period-(c.param&15);a.period=c.period;break;case 3:this.mixer.filter.active=1;break;case 4:this.mixer.filter.active=0;break;case 8:k=-1;case 7:c.stepSpeed=c.param&15;
c.stepPeriod=2<this.version?c.last:c.period;0>k&&(c.stepSpeed=-c.stepSpeed);for(d=0;;){a=t[d];if(a==c.stepPeriod)break;if(0>a){d=-1;break}else d++}-1<d?(a=c.param>>4,-1<k&&(a=-a),d+=a,0>d&&(d=0),c.stepWanted=t[d]):c.stepWanted=c.period;break;case 9:c.slideSpeed=c.slidePeriod=c.period,c.slideParam=c.param,c.slideDir=0,c.slideCtr=0}}c=c.next}else for(k=this.track[this.trackPos]+this.patternPos;c;){a=c.channel;c.enabled=0;d=this.patterns[k+c.index];c.period=d.note;c.effect=d.effect;c.param=d.param;if(-3==
d.note)c.effect=0;else if(d.sample?(d=c.sample=this.samples[d.sample],c.volume=d.volume,5==c.effect?c.volume+=c.param:6==c.effect&&(c.volume-=c.param),a.volume=c.volume):d=c.sample,c.period){c.last=c.period;c.slideSpeed=0;c.stepSpeed=0;c.enabled=1;a.enabled=0;switch(c.period){case -2:a.volume=0;break;case -4:this.jumpFlag=1;break;case -5:break;default:a.pointer=d.pointer,a.length=d.length,a.period=this.delphine?c.period<<1:c.period}c.enabled&&(a.enabled=1);a.pointer=d.loopPtr;a.length=d.repeat}c=
c.next}++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag)&&(this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}}});d.voices[0]=l(0);d.voices[0].next=d.voices[1]=l(1);d.voices[1].next=d.voices[2]=l(2);d.voices[2].next=d.voices[3]=l(3);d.track=new Uint16Array(128);return Object.seal(d)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,
writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume1:{value:0,writable:!0},volume2:{value:0,writable:!0},handler:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=
null;this.wavePos=this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.handler=this.volume2=this.volume1=this.param=this.effect=this.period=this.enabled=0}}})}function t(){var a=A();Object.defineProperties(a,{finetune:{value:0,writable:!0},restart:{value:0,writable:!0},waveLen:{value:0,writable:!0},waves:{value:null,writable:!0},volumes:{value:null,writable:!0}});return Object.seal(a)}var d=[0,3,7,12,15,12,7,3,0,3,7,12,15,12,7,3,0,4,7,12,16,12,7,4,0,4,7,12,16,12,7,
4,0,3,8,12,15,12,8,3,0,3,8,12,15,12,8,3,0,4,8,12,16,12,8,4,0,4,8,12,16,12,8,4,0,5,8,12,17,12,8,5,0,5,8,12,17,12,8,5,0,5,9,12,17,12,9,5,0,5,9,12,17,12,9,5,12,0,7,0,3,0,7,0,12,0,7,0,3,0,7,0,12,0,7,0,4,0,7,0,12,0,7,0,4,0,7,0,0,3,7,3,7,12,7,12,15,12,7,12,7,3,7,3,0,4,7,4,7,12,7,12,16,12,7,12,7,4,7,4,31,27,24,19,15,12,7,3,0,3,7,12,15,19,24,27,31,28,24,19,16,12,7,4,0,4,7,12,16,19,24,28,0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,0,12,24,12,0,12,24,12,0,12,24,12,0,12,24,12,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,4,
0,4,0,4,0,4,0,4,0,4,0,4,0,4],a=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],g=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.HMPlayer=function(k){k=B(k);Object.defineProperties(k,{id:{value:"HMPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,
writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},initialize:{value:function(){var c=this.voices[0];this.reset();this.speed=6;this.jumpFlag=this.patternPos=this.trackPos=0;for(this.mixer.samplesTick=884;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[0],c=c.next}},loader:{value:function(c){var e=0,a=0,b,d,g,k=0,l=0,p;if(!(2106>c.length)&&(c.position=
1080,d=c.readString(4),"FEST"==d)){c.position=950;this.length=c.readUbyte();this.restart=c.readUbyte();for(b=0;128>b;++b)this.track[b]=c.readUbyte();c.position=0;this.title=c.readString(20);for(b=this.version=1;32>b;++b){this.samples[b]=null;d=c.readString(4);if("Mupp"==d){p=c.readUbyte();e=p-a++;for(g=0;128>g;++g)this.track[g]&&this.track[g]>=e&&this.track[g]--;e=t();e.name=d;e.length=e.repeat=32;e.restart=c.readUbyte();e.waveLen=c.readUbyte();c.position+=17;e.finetune=c.readByte();e.volume=c.readUbyte();
d=c.position+4;p=1084+(p<<10);c.position=p;e.pointer=this.mixer.memory.length;e.waves=new Uint16Array(64);e.volumes=new Uint8Array(64);this.mixer.store(c,896);for(g=0;64>g;++g)e.waves[g]=c.readUbyte()<<5;for(g=0;64>g;++g)e.volumes[g]=c.readUbyte()&127;c.position=p;c.writeInt(1718382436);c.position=d;k+=896}else{d=d.substr(0,2);"El"==d?c.position+=18:(c.position-=4,d=c.readString(22));p=c.readUshort();if(!p){c.position+=6;continue}e=t();e.name=d;e.pointer=l;e.length=p<<1;e.finetune=c.readByte();e.volume=
c.readUbyte();e.loop=c.readUshort()<<1;e.repeat=c.readUshort()<<1;l+=e.length}this.samples[b]=e}for(b=0;128>b;++b)p=this.track[b]<<8,this.track[b]=p,p>a&&(a=p);c.position=1084;a+=256;this.patterns.length=a;for(b=0;b<a;++b){for(p=c.readUint();1718382436==p;)c.position+=1020,p=c.readUint();g=D();g.note=p>>16&4095;g.sample=p>>24&240|p>>12&15;g.effect=p>>8&15;g.param=p&255;if(31<g.sample||!this.samples[g.sample])g.sample=0;this.patterns[b]=g}this.mixer.store(c,l);for(b=1;32>b;++b)if(e=this.samples[b],
null!=e&&"Mupp"!=e.name)for(e.pointer+=k,e.loop?(e.loopPtr=e.pointer+e.loop,e.length=e.loop+e.repeat):(e.loopPtr=this.mixer.memory.length,e.repeat=2),l=e.pointer+4,g=e.pointer;g<l;++g)this.mixer.memory[g]=0;e=t();e.pointer=e.loopPtr=this.mixer.memory.length;e.length=e.repeat=2;this.samples[0]=e}}},process:{value:function(){var c,e,a,b,d,g=this.voices[0];if(this.tick)for(;g;)this.effects(g),this.handler(g),b=g.sample,g.channel.pointer=b.loopPtr,g.channel.length=b.repeat,g=g.next;else for(e=this.track[this.trackPos]+
this.patternPos;g;){c=g.channel;g.enabled=0;a=this.patterns[e+g.index];g.effect=a.effect;g.param=a.param;a.sample?(b=g.sample=this.samples[a.sample],g.volume2=b.volume,"Mupp"==b.name?(b.loopPtr=b.pointer+b.waves[0],g.handler=1,g.volume1=b.volumes[0]):(g.handler=0,g.volume1=64)):b=g.sample;a.note&&(3==g.effect||5==g.effect?a.note<g.period?(g.portaDir=1,g.portaPeriod=a.note):a.note>g.period?(g.portaDir=0,g.portaPeriod=a.note):g.portaPeriod=0:(g.period=a.note,g.vibratoPos=0,g.wavePos=0,g.enabled=1,c.enabled=
0,d=g.period*b.finetune>>8,c.period=g.period+d,g.handler?(c.pointer=b.loopPtr,c.length=b.repeat):(c.pointer=b.pointer,c.length=b.length)));switch(g.effect){case 11:this.trackPos=g.param-1;this.jumpFlag=1;break;case 12:g.volume2=g.param;64<g.volume2&&(g.volume2=64);break;case 13:this.jumpFlag=1;break;case 14:this.mixer.filter.active=g.param^1;break;case 15:d=g.param,1>d?d=1:31<d&&(d=31),this.speed=d,this.tick=0}a.note||this.effects(g);this.handler(g);g.enabled&&(c.enabled=1);c.pointer=b.loopPtr;c.length=
b.repeat;g=g.next}++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag)&&(this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1))}},effects:{value:function(c){var e=c.channel,f,b,k=c.period&4095,m,l;if(c.effect||c.param)switch(c.effect){case 0:l=this.tick%3;if(!l)break;l=1==l?c.param>>4:c.param&15;b=37-l;for(f=0;f<b;++f)if(k>=a[f]){k=a[f+l];break}break;case 1:c.period-=
c.param;113>c.period&&(c.period=113);k=c.period;break;case 2:c.period+=c.param;856<c.period&&(c.period=856);k=c.period;break;case 3:case 5:5==c.effect?m=1:c.param&&(c.portaSpeed=c.param,c.param=0);c.portaPeriod&&(c.portaDir?(c.period-=c.portaSpeed,c.period<c.portaPeriod&&(c.period=c.portaPeriod,c.portaPeriod=0)):(c.period+=c.portaSpeed,c.period>c.portaPeriod&&(c.period=c.portaPeriod,c.portaPeriod=0)));k=c.period;break;case 4:case 6:6==c.effect?m=1:c.param&&(c.vibratoSpeed=c.param);l=g[c.vibratoPos>>
2&31];l=(c.vibratoSpeed&15)*l>>7;k=127<c.vibratoPos?k-l:k+l;l=c.vibratoSpeed>>2&60;c.vibratoPos=c.vibratoPos+l&255;break;case 7:l=d[(c.vibratoPos&15)+((c.param&15)<<4)];c.vibratoPos++;for(f=0;37>f&&!(k>=a[f]);++f);l+=f;35<l&&(l-=12);k=a[l];break;case 10:m=1}e.period=k+(k*c.sample.finetune>>8);m&&(l=c.param>>4,c.volume2=l?c.volume2+l:c.volume2-(c.param&15),64<c.volume2?c.volume2=64:0>c.volume2&&(c.volume2=0))}},handler:{value:function(c){var e;c.handler&&(e=c.sample,e.loopPtr=e.pointer+e.waves[c.wavePos],
c.volume1=e.volumes[c.wavePos],++c.wavePos>e.waveLen&&(c.wavePos=e.restart));c.channel.volume=c.volume1*c.volume2>>6}}});k.voices[0]=l(0);k.voices[0].next=k.voices[1]=l(1);k.voices[1].next=k.voices[2]=l(2);k.voices[2].next=k.voices[3]=l(3);k.track=new Uint16Array(128);return Object.seal(k)}})();(function(){function l(d){return Object.create(null,{index:{value:d,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},enabled:{value:0,writable:!0},cosoCounter:{value:0,writable:!0},
cosoSpeed:{value:0,writable:!0},trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},trackTransp:{value:0,writable:!0},patternPtr:{value:0,writable:!0},patternPos:{value:0,writable:!0},frqseqPtr:{value:0,writable:!0},frqseqPos:{value:0,writable:!0},volseqPtr:{value:0,writable:!0},volseqPos:{value:0,writable:!0},sample:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,writable:!0},tick:{value:0,writable:!0},note:{value:0,writable:!0},transpose:{value:0,writable:!0},info:{value:0,
writable:!0},infoPrev:{value:0,writable:!0},volume:{value:0,writable:!0},volCounter:{value:0,writable:!0},volSpeed:{value:0,writable:!0},volSustain:{value:0,writable:!0},volTransp:{value:0,writable:!0},volFade:{value:0,writable:!0},portaDelta:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibDelay:{value:0,writable:!0},vibDelta:{value:0,writable:!0},vibDepth:{value:0,writable:!0},vibSpeed:{value:0,writable:!0},slide:{value:0,writable:!0},sldActive:{value:0,writable:!0},sldDone:{value:0,writable:!0},
sldCounter:{value:0,writable:!0},sldSpeed:{value:0,writable:!0},sldDelta:{value:0,writable:!0},sldPointer:{value:0,writable:!0},sldLen:{value:0,writable:!0},sldEnd:{value:0,writable:!0},sldLoopPtr:{value:0,writable:!0},initialize:{value:function(){this.channel=null;this.trackPtr=this.cosoSpeed=this.cosoCounter=this.enabled=0;this.trackPos=12;this.volseqPos=this.volseqPtr=this.frqseqPos=this.frqseqPtr=this.patternPos=this.patternPtr=this.trackTransp=0;this.sample=-1;this.volume=this.infoPrev=this.info=
this.transpose=this.note=this.tick=this.repeat=this.loopPtr=0;this.volSpeed=this.volCounter=1;this.volTransp=this.volSustain=0;this.volFade=100;this.sldLoopPtr=this.sldEnd=this.sldLen=this.sldPointer=this.sldDelta=this.sldSpeed=this.sldCounter=this.sldDone=this.sldActive=this.slide=this.vibSpeed=this.vibDepth=this.vibDelta=this.vibDelay=this.vibrato=this.portaDelta=0}}})}var p=[1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,906,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,
339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,113,113,113,113,113,113,113,113,113,113,113,113,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1812,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3624];window.neoart.JHPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"JHPlayer"},songs:{value:[],writable:!0},samples:{value:[],writable:!0},stream:{value:null,writable:!0},base:{value:0,writable:!0},patterns:{value:0,writable:!0},patternLen:{value:0,
writable:!0},periods:{value:0,writable:!0},frqseqs:{value:0,writable:!0},volseqs:{value:0,writable:!0},samplesData:{value:0,writable:!0},song:{value:null,writable:!0},voices:{value:[],writable:!0},coso:{value:0,writable:!0},variant:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.song=this.songs[this.playSong];this.speed=this.song.speed;for(this.tick=this.coso||1<this.variant?1:this.speed;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.trackPtr=
this.song.pointer+3*a.index,this.coso?(a.trackPos=0,a.patternPos=8):(this.stream.position=a.trackPtr,a.patternPtr=this.patterns+this.stream.readUbyte()*this.patternLen,a.trackTransp=this.stream.readByte(),a.volTransp=this.stream.readByte(),a.frqseqPtr=this.base,a.volseqPtr=this.base),a=a.next}},loader:{value:function(a){var d,k,c,e,f,b,h;this.base=this.periods=d=0;if(this.coso="COSO"==a.readString(4)){for(k=0;7>k;++k)d+=a.readInt();16942==d&&(a.position=47,d+=a.readUbyte());switch(d){case 22666:case 18842:case 30012:case 22466:case 3546:this.variant=
1;break;case 16948:case 18332:case 13698:this.variant=2;break;case 18546:case 13926:case 8760:case 17242:case 11394:case 14494:case 14392:case 13576:case 6520:this.variant=3;break;default:this.variant=4}this.version=2;a.position=4;this.frqseqs=a.readUint();this.volseqs=a.readUint();this.patterns=a.readUint();h=a.readUint();b=a.readUint();d=a.readUint();this.samplesData=a.readUint();a.position=0;a.writeInt(16777216);a.writeInt(225);a.writeShort(65535);e=(this.samplesData-d)/10-1;this.lastSong=(d-b)/
6}else{for(;12<a.bytesAvailable;)switch(d=a.readUshort(),d){case 576:d=a.readUshort();127==d&&(a.position+=2,this.periods=a.position+a.readUshort());break;case 28674:case 28675:this.channels=d&255;d=a.readUshort();30208==d&&(d=a.readUshort());16890==d&&(a.position+=4,this.base=a.position+a.readUshort());break;case 21574:d=a.readUshort(),19800==d&&(c=a.position-4,a.position=a.length)}if(!c||!this.base||!this.periods)return;this.version=1;a.position=c+4;this.frqseqs=k=c+32;d=a.readUshort();this.volseqs=
k+=++d<<6;d=a.readUshort();this.patterns=k+=++d<<6;d=a.readUshort();a.position+=2;this.patternLen=a.readUshort();h=k+=++d*this.patternLen;a.position-=4;d=a.readUshort();b=k+=12*++d;a.position=c+16;this.lastSong=a.readUshort();d=k+=6*++this.lastSong;e=a.readUshort();this.samplesData=k+30*e}a.position=d;this.samples=[];for(k=d=0;k<e;++k)f=A(),this.coso||(f.name=a.readString(18)),f.pointer=a.readUint(),f.length=a.readUshort()<<1,this.coso||(f.volume=a.readUshort()),f.loopPtr=a.readUshort()+f.pointer,
f.repeat=a.readUshort()<<1,f.loopPtr&1&&f.loopPtr--,d+=f.length,this.samples[k]=f;a.position=this.samplesData;this.mixer.store(a,d);a.position=b;this.songs=[];for(k=d=0;k<this.lastSong;++k)e=Object.create(null,{pointer:{value:0,writable:!0},speed:{value:0,writable:!0},length:{value:0,writable:!0}}),e.pointer=a.readUshort(),e.length=a.readUshort()-e.pointer+1,e.speed=a.readUshort(),e.pointer=12*e.pointer+h,e.length*=12,12<e.length&&(this.songs[d++]=e);this.lastSong=this.songs.length-1;if(!this.coso)for(a.position=
0,this.variant=1;a.position<c;)if(d=a.readUshort(),45116==d||3072==d){if(d=a.readUshort(),229==d||230==d||233==d){this.variant=2;break}}else if(20219==d){this.variant=3;break}this.stream=a}},process:{value:function(){var a,d,k,c,e,f,b=this.voices[0];if(0==--this.tick){for(this.tick=this.speed;b;){a=b.channel;if(this.coso){if(0>--b.cosoCounter){b.cosoCounter=b.cosoSpeed;do{this.stream.position=b.patternPos;do d=0,f=this.stream.readByte(),-1==f?(b.trackPos==this.song.length&&(b.trackPos=0,this.mixer.complete=
1),this.stream.position=b.trackPtr+b.trackPos,f=this.stream.readUbyte(),b.trackTransp=this.stream.readByte(),k=this.stream.readAt(this.stream.position),3<this.variant&&127<k?(c=k>>4&15,k&=15,15==c?(c=100,k&&(c=15-k+1,k=c<<=1,c<<=1,c+=k),b.volFade=c):8==c?this.mixer.complete=1:14==c&&(this.speed=k)):b.volTransp=this.stream.readByte(),this.stream.position=this.patterns+(f<<1),b.patternPos=this.stream.readUshort(),b.trackPos+=12,d=1):-2==f?(b.cosoCounter=b.cosoSpeed=this.stream.readUbyte(),d=3):-3==
f?(b.cosoCounter=b.cosoSpeed=this.stream.readUbyte(),b.patternPos=this.stream.position):(b.note=f,b.info=this.stream.readByte(),b.info&224&&(b.infoPrev=this.stream.readByte()),b.patternPos=this.stream.position,b.portaDelta=0,0<=f&&(1==this.variant&&(a.enabled=0),f=(b.info&31)+b.volTransp,this.stream.position=this.volseqs+(f<<1),this.stream.position=this.stream.readUshort(),b.volCounter=b.volSpeed=this.stream.readUbyte(),b.volSustain=0,f=this.stream.readByte(),b.vibSpeed=this.stream.readByte(),b.vibrato=
64,b.vibDepth=b.vibDelta=this.stream.readByte(),b.vibDelay=this.stream.readUbyte(),b.volseqPtr=this.stream.position,b.volseqPos=0,-128!=f&&(1<this.variant&&b.info&64&&(f=b.infoPrev),this.stream.position=this.frqseqs+(f<<1),b.frqseqPtr=this.stream.readUshort(),b.frqseqPos=0,b.tick=0)));while(2<d)}while(0<d)}}else{this.stream.position=b.patternPtr+b.patternPos;f=this.stream.readByte();if(b.patternPos==this.patternLen||1==(f&127))b.trackPos==this.song.length&&(b.trackPos=0,this.mixer.complete=1),this.stream.position=
b.trackPtr+b.trackPos,f=this.stream.readUbyte(),b.trackTransp=this.stream.readByte(),b.volTransp=this.stream.readByte(),-128==b.volTransp&&(this.mixer.complete=1),b.patternPtr=this.patterns+f*this.patternLen,b.patternPos=0,b.trackPos+=12,this.stream.position=b.patternPtr,f=this.stream.readByte();f&127&&(b.note=f&127,b.portaDelta=0,k=this.stream.position,b.patternPos||(this.stream.position+=this.patternLen),this.stream.position-=2,b.infoPrev=this.stream.readByte(),this.stream.position=k,b.info=this.stream.readByte(),
0<=f&&(1==this.variant&&(a.enabled=0),f=(b.info&31)+b.volTransp,this.stream.position=this.volseqs+(f<<6),b.volCounter=b.volSpeed=this.stream.readUbyte(),b.volSustain=0,f=this.stream.readByte(),b.vibSpeed=this.stream.readByte(),b.vibrato=64,b.vibDepth=b.vibDelta=this.stream.readByte(),b.vibDelay=this.stream.readUbyte(),b.volseqPtr=this.stream.position,b.volseqPos=0,1<this.variant&&b.info&64&&(f=b.infoPrev),b.frqseqPtr=this.frqseqs+(f<<6),b.frqseqPos=0,b.tick=0));b.patternPos+=2}b=b.next}b=this.voices[0]}for(;b;){a=
b.channel;b.enabled=0;do if(d=0,b.tick)b.tick--;else{this.stream.position=b.frqseqPtr+b.frqseqPos;do{f=this.stream.readByte();if(-31==f)break;d=3;3==this.variant&&this.coso&&(-27==f?f=-30:-26==f&&(f=-28));switch(f){case -32:b.frqseqPos=this.stream.readUbyte()&63;this.stream.position=b.frqseqPtr+b.frqseqPos;break;case -30:e=this.samples[this.stream.readUbyte()];b.sample=-1;b.loopPtr=e.loopPtr;b.repeat=e.repeat;b.enabled=1;a.enabled=0;a.pointer=e.pointer;a.length=e.length;b.volseqPos=0;b.volCounter=
1;b.slide=0;b.frqseqPos+=2;break;case -29:b.vibSpeed=this.stream.readByte();b.vibDepth=this.stream.readByte();b.frqseqPos+=3;break;case -28:e=this.samples[this.stream.readUbyte()];b.loopPtr=e.loopPtr;b.repeat=e.repeat;a.pointer=e.pointer;a.length=e.length;b.slide=0;b.frqseqPos+=2;break;case -27:if(2>this.variant)break;e=this.samples[this.stream.readUbyte()];a.enabled=0;b.enabled=1;2==this.variant?(k=this.stream.readUbyte()*e.length,b.loopPtr=e.loopPtr+k,b.repeat=e.repeat,a.pointer=e.pointer+k,a.length=
e.length,b.frqseqPos+=3):(b.sldPointer=e.pointer,b.sldEnd=e.pointer+e.length,f=this.stream.readUshort(),b.sldLoopPtr=65535==f?e.length:f<<1,b.sldLen=this.stream.readUshort()<<1,b.sldDelta=this.stream.readShort()<<1,b.sldActive=0,b.sldCounter=0,b.sldSpeed=this.stream.readUbyte(),b.slide=1,b.sldDone=0,b.frqseqPos+=9);b.volseqPos=0;b.volCounter=1;break;case -26:if(3>this.variant)break;b.sldLen=this.stream.readUshort()<<1;b.sldDelta=this.stream.readShort()<<1;b.sldActive=0;b.sldCounter=0;b.sldSpeed=this.stream.readUbyte();
b.sldDone=0;b.frqseqPos+=6;break;case -25:1==this.variant?(b.frqseqPtr=this.frqseqs+(this.stream.readUbyte()<<6),b.frqseqPos=0,this.stream.position=b.frqseqPtr,d=3):(f=this.stream.readUbyte(),f!=b.sample&&(e=this.samples[f],b.sample=f,b.loopPtr=e.loopPtr,b.repeat=e.repeat,b.enabled=1,a.enabled=0,a.pointer=e.pointer,a.length=e.length),b.volseqPos=0,b.volCounter=1,b.slide=0,b.frqseqPos+=2);break;case -24:b.tick=this.stream.readUbyte();b.frqseqPos+=2;d=1;break;case -23:if(2>this.variant)break;e=this.samples[this.stream.readUbyte()];
b.sample=-1;b.enabled=1;c=this.stream.readUbyte();k=this.stream.position;a.enabled=0;this.stream.position=this.samplesData+e.pointer+4;f=24*this.stream.readUshort()+(this.stream.readUshort()<<2);this.stream.position+=24*c;b.loopPtr=this.stream.readUint()&4294967294;a.length=(this.stream.readUint()&4294967294)-b.loopPtr;b.loopPtr+=e.pointer+f+8;a.pointer=b.loopPtr;b.repeat=2;this.stream.position=k;k=b.loopPtr+1;this.mixer.memory[k]=this.mixer.memory[b.loopPtr];b.volseqPos=0;b.volCounter=1;b.slide=
0;b.frqseqPos+=3;break;default:b.transpose=f,b.frqseqPos++,d=0}}while(2<d)}while(0<d);b.slide&&!b.sldDone&&0>--b.sldCounter&&(b.sldCounter=b.sldSpeed,b.sldActive?(f=b.sldLoopPtr+b.sldDelta,0>f?(b.sldDone=1,f=b.sldLoopPtr-b.sldDelta):(k=b.sldPointer+b.sldLen+f,k>b.sldEnd&&(b.sldDone=1,f=b.sldLoopPtr-b.sldDelta)),b.sldLoopPtr=f):b.sldActive=1,b.loopPtr=b.sldPointer+b.sldLoopPtr,b.repeat=b.sldLen,a.pointer=b.loopPtr,a.length=b.repeat);do if(d=0,b.volSustain)b.volSustain--;else{if(--b.volCounter)break;
b.volCounter=b.volSpeed;do{this.stream.position=b.volseqPtr+b.volseqPos;f=this.stream.readByte();if(-25>=f&&-31<=f)break;switch(f){case -24:b.volSustain=this.stream.readUbyte();b.volseqPos+=2;d=1;break;case -32:b.volseqPos=(this.stream.readUbyte()&63)-5;d=3;break;default:b.volume=f,b.volseqPos++,d=0}}while(2<d)}while(0<d);f=b.transpose;0<=f&&(f+=b.note+b.trackTransp);f&=127;this.coso?(83<f&&(f=0),d=p[f],f<<=1):(f<<=1,this.stream.position=this.periods+f,d=this.stream.readUshort());if(b.vibDelay)b.vibDelay--;
else if(3<this.variant)b.vibrato&32?(f=b.vibDelta+b.vibSpeed,f>b.vibDepth&&(b.vibrato&=-33,f=b.vibDepth)):(f=b.vibDelta-b.vibSpeed,0>f&&(b.vibrato|=32,f=0)),b.vibDelta=f,f=(f-(b.vibDepth>>1))*d,d+=f>>10;else if(2<this.variant)f=b.vibSpeed,0>f&&(f&=127,b.vibrato^=1),b.vibrato&1||(b.vibrato&32?(b.vibDelta+=f,k=b.vibDepth<<1,b.vibDelta>k&&(b.vibrato&=-33,b.vibDelta=k)):(b.vibDelta-=f,0>b.vibDelta&&(b.vibrato|=32,b.vibDelta=0))),d+=f-b.vibDepth;else{if(0<=b.vibrato||!(b.vibrato&1))b.vibrato&32?(b.vibDelta+=
b.vibSpeed,k=b.vibDepth<<1,b.vibDelta>=k&&(b.vibrato&=-33,b.vibDelta=k)):(b.vibDelta-=b.vibSpeed,0>b.vibDelta&&(b.vibrato|=32,b.vibDelta=0));if(k=b.vibDelta-b.vibDepth){for(f+=160;256>f;)k+=k,f+=24;d+=k}}3>this.variant&&(b.vibrato^=1);b.info&32&&(f=b.infoPrev,3<this.variant?0>f?(b.portaDelta+=-f,f=b.portaDelta*d,d+=f>>10):(b.portaDelta+=f,f=b.portaDelta*d,d-=f>>10):0>f?(b.portaDelta+=-f<<11,d+=b.portaDelta>>16):(b.portaDelta+=f<<11,d-=b.portaDelta>>16));f=3<this.variant?b.volFade*b.volume/100:b.volume;
a.period=d;a.volume=f;b.enabled&&(a.enabled=1,a.pointer=b.loopPtr,a.length=b.repeat);b=b.next}}}});d.voices[0]=l(0);d.voices[0].next=d.voices[1]=l(1);d.voices[1].next=d.voices[2]=l(2);d.voices[2].next=d.voices[3]=l(3);return Object.seal(d)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},
param:{value:0,writable:!0},volume:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.vibratoSpeed=this.vibratoPos=this.portaSpeed=this.portaPeriod=this.portaDir=this.volume=this.param=this.effect=this.period=this.enabled=0}}})}var p=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,
320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0],d=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24];window.neoart.MKPlayer=function(a){a=B(a);Object.defineProperties(a,{id:{value:"MKPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},restart:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},
patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},restartSave:{value:0,writable:!0},force:{set:function(a){1>a?a=1:5<a&&(a=5);this.version=a;this.vibratoDepth=5==a?6:7;3==a?(this.restartSave=this.restart,this.restart=0):(this.restart=this.restartSave,this.restartSave=0)}},initialize:{value:function(){var a=this.voices[0];this.reset();this.force=this.version;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;a;)a.initialize(),a.channel=this.mixer.channels[a.index],
a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var d=0,c,e,f=0,b;if(!(2106>a.length)&&(a.position=1080,c=a.readString(4),"M.K."==c||"FLT4"==c)){a.position=0;this.title=a.readString(20);this.version=1;a.position+=22;for(c=1;32>c;++c)(b=a.readUshort())?(e=A(),a.position-=24,e.name=a.readString(22),e.length=b<<1,a.position+=3,e.volume=a.readUbyte(),e.loop=a.readUshort()<<1,e.repeat=a.readUshort()<<1,a.position+=22,e.pointer=f,f+=e.length,this.samples[c]=e,32768<e.length&&(this.version=
2)):(this.samples[c]=null,a.position+=28);a.position=950;this.length=a.readUbyte();b=a.readUbyte();this.restart=b<length?b:0;for(c=0;128>c;++c)b=a.readUbyte()<<8,this.track[c]=b,b>d&&(d=b);a.position=1084;d+=256;this.patterns.length=d;for(c=0;c<d;++c){e=D();b=a.readUint();e.note=b>>16&4095;e.effect=b>>8&15;e.sample=b>>24&240|b>>12&15;e.param=b&255;this.patterns[c]=e;if(31<e.sample||!this.samples[e.sample])e.sample=0;if(3==e.effect||4==e.effect)this.version=3;if(5==e.effect||6==e.effect)this.version=
5;if(6<e.effect&&10>e.effect){this.version=0;return}}this.mixer.store(a,f);for(c=1;32>c;++c)if(e=this.samples[c])for(-1<e.name.indexOf("2.0")&&(this.version=5),e.loop?(e.loopPtr=e.pointer+e.loop,e.length=e.loop+e.repeat):(e.loopPtr=this.mixer.memory.length,e.repeat=2),f=e.pointer+4,a=e.pointer;a<f;++a)this.mixer.memory[a]=0;e=A();e.pointer=e.loopPtr=this.mixer.memory.length;e.length=e.repeat=2;this.samples[0]=e;5>this.version&&127!=this.restart&&(this.version=4)}}},process:{value:function(){var a,
k,c,e,f,b,h=this.voices[0];if(this.tick)for(;h;){a=h.channel;if(h.effect||h.param){switch(h.effect){case 0:f=this.tick%3;if(!f){a.period=h.period;h=h.next;continue}f=1==f?h.param>>4:h.param&15;e=h.period&4095;c=37-f;for(k=0;k<c;++k)if(e>=p[k]){a.period=p[k+f];break}break;case 1:h.period-=h.param;113>h.period&&(h.period=113);a.period=h.period;break;case 2:h.period+=h.param;856<h.period&&(h.period=856);a.period=h.period;break;case 3:case 5:5==h.effect?b=1:h.param&&(h.portaSpeed=h.param,h.param=0);h.portaPeriod&&
(h.portaDir?(h.period-=h.portaSpeed,h.period<=h.portaPeriod&&(h.period=h.portaPeriod,h.portaPeriod=0)):(h.period+=h.portaSpeed,h.period>=h.portaPeriod&&(h.period=h.portaPeriod,h.portaPeriod=0)));a.period=h.period;break;case 4:case 6:6==h.effect?b=1:h.param&&(h.vibratoSpeed=h.param);f=h.vibratoPos>>2&31;f=(h.vibratoSpeed&15)*d[f]>>this.vibratoDepth;a.period=127<h.vibratoPos?h.period-f:h.period+f;f=h.vibratoSpeed>>2&60;h.vibratoPos=h.vibratoPos+f&255;break;case 10:b=1}b&&(f=h.param>>4,b=0,h.volume=
f?h.volume+f:h.volume-(h.param&15),0>h.volume?h.volume=0:64<h.volume&&(h.volume=64),a.volume=h.volume)}else a.period=h.period;h=h.next}else for(k=this.track[this.trackPos]+this.patternPos;h;){a=h.channel;h.enabled=0;f=this.patterns[k+h.index];h.effect=f.effect;h.param=f.param;f.sample?(c=h.sample=this.samples[f.sample],a.volume=h.volume=c.volume):c=h.sample;f.note&&(3==h.effect||5==h.effect?f.note<h.period?(h.portaDir=1,h.portaPeriod=f.note):f.note>h.period?(h.portaDir=0,h.portaPeriod=f.note):h.portaPeriod=
0:(h.enabled=1,h.vibratoPos=0,a.enabled=0,a.pointer=c.pointer,a.length=c.length,a.period=h.period=f.note));switch(h.effect){case 11:this.trackPos=h.param-1;this.jumpFlag^=1;break;case 12:a.volume=h.param;5==this.version&&(h.volume=h.param);break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=h.param^1;break;case 15:f=h.param,1>f?f=1:31<f&&(f=31),this.speed=f,this.tick=0}h.enabled&&(a.enabled=1);a.pointer=c.loopPtr;a.length=c.repeat;h=h.next}if(++this.tick==this.speed){this.tick=0;
this.patternPos+=4;if(256==this.patternPos||this.jumpFlag)this.patternPos=this.jumpFlag=0,this.trackPos=++this.trackPos&127,this.trackPos==this.length&&(this.trackPos=this.restart,this.mixer.complete=1);SeniorDads.Music.pattern_position=this.patternPos;SeniorDads.Music.track_position=this.trackPos;SeniorDads.Music.CheckForBreakPoint()}}}});a.voices[0]=l(0);a.voices[0].next=a.voices[1]=l(1);a.voices[1].next=a.voices[2]=l(2);a.voices[2].next=a.voices[3]=l(3);a.track=new Uint16Array(128);return Object.seal(a)}})();
(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},loopCtr:{value:0,writable:!0},loopPos:{value:0,writable:!0},step:{value:0,writable:!0},period:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},volume:{value:0,writable:!0},pointer:{value:0,writable:!0},length:{value:0,writable:!0},loopPtr:{value:0,writable:!0},repeat:{value:0,
writable:!0},finetune:{value:0,writable:!0},offset:{value:0,writable:!0},portaDir:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,writable:!0},tremoloParam:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloWave:{value:0,writable:!0},vibratoParam:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoWave:{value:0,writable:!0},funkPos:{value:0,writable:!0},funkSpeed:{value:0,writable:!0},funkWave:{value:0,writable:!0},initialize:{value:function(){this.sample=
this.channel=null;this.funkWave=this.funkSpeed=this.funkPos=this.vibratoWave=this.vibratoPos=this.vibratoParam=this.tremoloWave=this.tremoloPos=this.tremoloParam=this.glissando=this.portaSpeed=this.portaPeriod=this.portaDir=this.offset=this.finetune=this.repeat=this.loopPtr=this.length=this.pointer=this.volume=this.param=this.effect=this.period=this.step=this.loopPos=this.loopCtr=this.enabled=0}}})}function p(){var a=A();Object.defineProperties(a,{finetune:{value:0,writable:!0},realLen:{value:0,writable:!0}});
return Object.seal(a)}var d=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,850,802,757,715,674,637,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,239,225,213,201,189,179,169,159,150,142,134,126,119,113,0,844,796,752,709,670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,224,211,199,188,177,167,158,149,141,133,125,118,112,0,838,791,746,704,665,628,592,559,528,
498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,111,0,832,785,741,699,660,623,588,555,524,495,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,124,117,110,0,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,109,0,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,
193,183,172,163,154,145,137,129,122,115,109,0,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,204,192,181,171,161,152,144,136,128,121,114,108,0,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,0,900,850,802,757,715,675,636,601,567,535,505,477,450,425,401,379,357,337,318,300,284,268,253,238,225,212,200,189,179,169,159,150,142,134,126,119,0,894,844,796,752,709,
670,632,597,563,532,502,474,447,422,398,376,355,335,316,298,282,266,251,237,223,211,199,188,177,167,158,149,141,133,125,118,0,887,838,791,746,704,665,628,592,559,528,498,470,444,419,395,373,352,332,314,296,280,264,249,235,222,209,198,187,176,166,157,148,140,132,125,118,0,881,832,785,741,699,660,623,588,555,524,494,467,441,416,392,370,350,330,312,294,278,262,247,233,220,208,196,185,175,165,156,147,139,131,123,117,0,875,826,779,736,694,655,619,584,551,520,491,463,437,413,390,368,347,328,309,292,276,
260,245,232,219,206,195,184,174,164,155,146,138,130,123,116,0,868,820,774,730,689,651,614,580,547,516,487,460,434,410,387,365,345,325,307,290,274,258,244,230,217,205,193,183,172,163,154,145,137,129,122,115,0,862,814,768,725,684,646,610,575,543,513,484,457,431,407,384,363,342,323,305,288,272,256,242,228,216,203,192,181,171,161,152,144,136,128,121,114,0],a=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,212,197,180,161,141,120,97,74,49,24],g=[0,5,6,7,8,10,11,13,16,
19,22,26,32,43,64,128];window.neoart.PTPlayer=function(k){k=B(k);Object.defineProperties(k,{id:{value:"PTPlayer"},track:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternBreak:{value:0,writable:!0},patternDelay:{value:0,writable:!0},breakPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},force:{set:function(c){1>
c?c=1:3<c&&(c=3);this.version=c;this.vibratoDepth=2>c?6:7}},initialize:{value:function(){var c=this.voices[0];this.tempo=125;this.speed=6;this.jumpFlag=this.breakPos=this.patternDelay=this.patternBreak=this.patternPos=this.trackPos=0;this.reset();for(this.force=this.version;c;)c.initialize(),c.channel=this.mixer.channels[c.index],c.sample=this.samples[0],c=c.next}},loader:{value:function(c){var a=0,d,b,g=0,k;if(!(2106>c.length)&&(c.position=1080,d=c.readString(4),"M.K."==d||"M!K!"==d)){c.position=
0;this.title=c.readString(20);this.version=1;c.position+=22;for(d=1;32>d;++d)(k=c.readUshort())?(b=p(),c.position-=24,b.name=c.readString(22),b.length=b.realLen=k<<1,c.position+=2,b.finetune=37*c.readUbyte(),b.volume=c.readUbyte(),b.loop=c.readUshort()<<1,b.repeat=c.readUshort()<<1,c.position+=22,b.pointer=g,g+=b.length,this.samples[d]=b):(this.samples[d]=null,c.position+=28);c.position=950;this.length=c.readUbyte();c.position++;for(d=0;128>d;++d)k=c.readUbyte()<<8,this.track[d]=k,k>a&&(a=k);c.position=
1084;a+=256;this.patterns.length=a;for(d=0;d<a;++d){k=D();Object.defineProperties(k,{step:{value:0,writable:!0}});b=Object.seal(k);b.step=k=c.readUint();b.note=k>>16&4095;b.effect=k>>8&15;b.sample=k>>24&240|k>>12&15;b.param=k&255;this.patterns[d]=b;if(31<b.sample||!this.samples[b.sample])b.sample=0;15==b.effect&&31<b.param&&(this.version=2);8==b.effect&&(this.version=3)}this.mixer.store(c,g);for(d=1;32>d;++d)if(b=this.samples[d])for(b.loop||4<b.repeat?(b.loopPtr=b.pointer+b.loop,b.length=b.loop+b.repeat):
(b.loopPtr=this.mixer.memory.length,b.repeat=2),g=b.pointer+2,c=b.pointer;c<g;++c)this.mixer.memory[c]=0;b=p();b.pointer=b.loopPtr=this.mixer.memory.length;b.length=b.repeat=2;this.samples[0]=b}}},process:{value:function(){var c,a,f,b,g,k=this.voices[0];if(this.tick)this.effects();else if(this.patternDelay)this.effects();else{for(f=this.track[this.trackPos]+this.patternPos;k;){c=k.channel;k.enabled=0;k.step||(c.period=k.period);b=this.patterns[f+k.index];k.step=b.step;k.effect=b.effect;k.param=b.param;
b.sample&&(a=k.sample=this.samples[b.sample],k.pointer=a.pointer,k.length=a.length,k.loopPtr=k.funkWave=a.loopPtr,k.repeat=a.repeat,k.finetune=a.finetune,c.volume=k.volume=a.volume);if(b.note){if(3664==(k.step&4080))k.finetune=37*(k.param&15);else if(3==k.effect||5==k.effect)if(b.note==k.period)k.portaPeriod=0;else{a=k.finetune;for(g=a+37;a<g&&!(b.note>=d[a]);++a);0<a&&(g=k.finetune/37>>0&8)&&a--;k.portaPeriod=d[a];k.portaDir=b.note>k.portaPeriod?0:1}else 9==k.effect&&this.moreEffects(k);for(a=0;37>
a&&!(b.note>=d[a]);++a);k.period=d[k.finetune+a];3792==(k.step&4080)?(k.funkSpeed&&this.updateFunk(k),this.extended(k)):(4>k.vibratoWave&&(k.vibratoPos=0),4>k.tremoloWave&&(k.tremoloPos=0),c.enabled=0,c.pointer=k.pointer,c.length=k.length,c.period=k.period,k.enabled=1,this.moreEffects(k))}else this.moreEffects(k);k=k.next}for(k=this.voices[0];k;)c=k.channel,k.enabled&&(c.enabled=1),c.pointer=k.loopPtr,c.length=k.repeat,k=k.next}if(++this.tick==this.speed){this.tick=0;this.patternPos+=4;this.patternDelay&&
--this.patternDelay&&(this.patternPos-=4);this.patternBreak&&(this.patternBreak=0,this.patternPos=this.breakPos,this.breakPos=0);if(256==this.patternPos||this.jumpFlag)this.patternPos=this.breakPos,this.jumpFlag=this.breakPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1);SeniorDads.Music.pattern_position=this.patternPos;SeniorDads.Music.track_position=this.trackPos;SeniorDads.Music.CheckForBreakPoint()}}},effects:{value:function(){for(var c,e,f,b,k,g=this.voices[0];g;){c=
g.channel;g.funkSpeed&&this.updateFunk(g);if(0==(g.step&4095))c.period=g.period;else{switch(g.effect){case 0:k=this.tick%3;if(!k){c.period=g.period;g=g.next;continue}k=1==k?g.param>>4:g.param&15;e=g.finetune;for(f=e+37;e<f;++e)if(g.period>=d[e]){c.period=d[e+k];break}break;case 1:g.period-=g.param;113>g.period&&(g.period=113);c.period=g.period;break;case 2:g.period+=g.param;856<g.period&&(g.period=856);c.period=g.period;break;case 3:case 5:5==g.effect?b=1:(g.portaSpeed=g.param,g.param=0);if(g.portaPeriod)if(g.portaDir?
(g.period-=g.portaSpeed,g.period<=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)):(g.period+=g.portaSpeed,g.period>=g.portaPeriod&&(g.period=g.portaPeriod,g.portaPeriod=0)),g.glissando){e=g.finetune;for(k=e+37;e<k&&!(g.period>=d[e]);++e);e==k&&e--;c.period=d[e]}else c.period=g.period;break;case 4:case 6:if(6==g.effect)b=1;else if(g.param){if(k=g.param&15)g.vibratoParam=g.vibratoParam&240|k;if(k=g.param&240)g.vibratoParam=g.vibratoParam&15|k}f=g.vibratoPos>>2&31;(e=g.vibratoWave&3)?(k=255,
f<<=3,1==e&&(k=127<g.vibratoPos?k-f:f)):k=a[f];k=(g.vibratoParam&15)*k>>this.vibratoDepth;c.period=127<g.vibratoPos?g.period-k:g.period+k;k=g.vibratoParam>>2&60;g.vibratoPos=g.vibratoPos+k&255;break;case 7:c.period=g.period;if(g.param){if(k=g.param&15)g.tremoloParam=g.tremoloParam&240|k;if(k=g.param&240)g.tremoloParam=g.tremoloParam&15|k}f=g.tremoloPos>>2&31;(e=g.tremoloWave&3)?(k=255,f<<=3,1==e&&(k=127<g.tremoloPos?k-f:f)):k=a[f];k=(g.tremoloParam&15)*k>>6;c.volume=127<g.tremoloPos?g.volume-k:g.volume+
k;k=g.tremoloParam>>2&60;g.tremoloPos=g.tremoloPos+k&255;break;case 10:b=1;break;case 14:this.extended(g)}b&&(b=0,k=g.param>>4,g.volume=k?g.volume+k:g.volume-(g.param&15),0>g.volume?g.volume=0:64<g.volume&&(g.volume=64),c.volume=g.volume)}g=g.next}}},moreEffects:{value:function(c){var a=c.channel;c.funkSpeed&&this.updateFunk(c);switch(c.effect){case 9:c.param&&(c.offset=c.param);a=c.offset<<8;a>=c.length?c.length=2:(c.pointer+=a,c.length-=a);break;case 11:this.trackPos=c.param-1;this.breakPos=0;this.jumpFlag=
1;break;case 12:c.volume=c.param;64<c.volume&&(c.volume=64);a.volume=c.volume;break;case 13:this.breakPos=10*(c.param>>4)+(c.param&15);this.breakPos=63<this.breakPos?0:this.breakPos<<2;this.jumpFlag=1;break;case 14:this.extended(c);break;case 15:if(!c.param)break;32>c.param?this.speed=c.param:this.mixer.samplesTick=2.5*this.sampleRate/c.param>>0;this.tick=0}}},extended:{value:function(c){var a=c.channel,d;d=c.param&15;switch(c.param>>4){case 0:this.mixer.filter.active=d;break;case 1:if(this.tick)break;
c.period-=d;113>c.period&&(c.period=113);a.period=c.period;break;case 2:if(this.tick)break;c.period+=d;856<c.period&&(c.period=856);a.period=c.period;break;case 3:c.glissando=d;break;case 4:c.vibratoWave=d;break;case 5:c.finetune=37*d;break;case 6:if(this.tick)break;d?(c.loopCtr?c.loopCtr--:c.loopCtr=d,c.loopCtr&&(this.breakPos=c.loopPos<<2,this.patternBreak=1)):c.loopPos=this.patternPos>>2;break;case 7:c.tremoloWave=d;break;case 8:a=c.length-2;d=this.mixer.memory;for(c=c.loopPtr;c<a;)d[c]=.5*(d[c]+
d[++c]);d[++c]=.5*(d[c]+d[0]);break;case 9:if(this.tick||!d||!c.period)break;if(this.tick%d)break;a.enabled=0;a.pointer=c.pointer;a.length=c.length;a.delay=30;a.enabled=1;a.pointer=c.loopPtr;a.length=c.repeat;a.period=c.period;break;case 10:if(this.tick)break;c.volume+=d;64<c.volume&&(c.volume=64);a.volume=c.volume;break;case 11:if(this.tick)break;c.volume-=d;0>c.volume&&(c.volume=0);a.volume=c.volume;break;case 12:this.tick==d&&(a.volume=c.volume=0);break;case 13:if(this.tick!=d||!c.period)break;
a.enabled=0;a.pointer=c.pointer;a.length=c.length;a.delay=30;a.enabled=1;a.pointer=c.loopPtr;a.length=c.repeat;a.period=c.period;break;case 14:if(this.tick||this.patternDelay)break;this.patternDelay=++d;break;case 15:if(this.tick)break;(c.funkSpeed=d)&&this.updateFunk(c)}}},updateFunk:{value:function(c){var a=c.channel,d,b;c.funkPos+=g[c.funkSpeed];128>c.funkPos||(c.funkPos=0,1==this.version?(d=c.pointer+c.sample.realLen-c.repeat,b=c.funkWave+c.repeat,b>d&&(b=c.loopPtr,a.length=c.repeat),a.pointer=
c.funkWave=b):(d=c.loopPtr+c.repeat,b=c.funkWave+1,b>=d&&(b=c.loopPtr),this.mixer.memory[b]=-this.mixer.memory[b]))}}});k.voices[0]=l(0);k.voices[0].next=k.voices[1]=l(1);k.voices[1].next=k.voices[2]=l(2);k.voices[2].next=k.voices[3]=l(3);k.track=new Uint16Array(128);return Object.seal(k)}})();(function(){function l(d,a){return Object.create(null,{index:{value:d,writable:!0},bitFlag:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},
trackPtr:{value:0,writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},tick:{value:0,writable:!0},busy:{value:0,writable:!0},flags:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},vibratoPtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},synthPos:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.patternPos=this.trackPos=this.trackPtr=0;this.busy=
this.tick=1;this.synthPos=this.vibratoPos=this.vibratoPtr=this.portaSpeed=this.volume=this.period=this.note=this.flags=0}}})}function p(){var d=A();Object.defineProperties(d,{relative:{value:0,writable:!0},divider:{value:0,writable:!0},vibrato:{value:0,writable:!0},hiPos:{value:0,writable:!0},loPos:{value:0,writable:!0},wave:{value:[],writable:!0}});return Object.seal(d)}window.neoart.RHPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"RHPlayer"},songs:{value:[],writable:!0},samples:{value:[],
writable:!0},song:{value:null,writable:!0},periods:{value:0,writable:!0},vibrato:{value:0,writable:!0},voices:{value:[],writable:!0},stream:{value:null,writable:!0},complete:{value:0,writable:!0},variant:{value:0,writable:!0},initialize:{value:function(){var a,d,k,c=this.voices[3];this.reset();this.song=this.songs[this.playSong];this.complete=15;for(a=0;a<this.samples.length;++a)if(k=this.samples[a],k.wave.length)for(d=0;d<k.length;++d)this.mixer.memory[k.pointer+d]=k.wave[d];for(;c;)c.initialize(),
c.channel=this.mixer.channels[c.index],c.trackPtr=this.song.tracks[c.index],c.trackPos=4,this.stream.position=c.trackPtr,c.patternPos=this.stream.readUint(),c=c.next}},loader:{value:function(a){var d,k,c,e,f,b,h,l;for(a.position=44;1024>a.position;)if(f=a.readUshort(),32272==f||32288==f)f=a.readUshort(),16890==f&&(d=a.position+a.readUshort(),f=a.readUshort(),53756==f?(b=d+a.readUint(),this.mixer.loopLen=64,a.position+=2):(b=d,this.mixer.loopLen=512),c=a.position+a.readUshort(),f=a.readUbyte(),114==
f&&(k=a.readUbyte()));else if(20937==f){if(a.position+=2,f=a.readUshort(),17914==f)for(l=a.position+a.readUshort(),a.position+=2;;)if(f=a.readUshort(),19450==f){e=a.position+a.readUshort();break}}else if(49404==f)a.position+=2,f=a.readUshort(),16875==f&&(h=a.readUshort());else if(13421==f)a.position+=2,f=a.readUshort(),18938==f&&(this.vibrato=a.position+a.readUshort());else if(16960==f&&(f=a.readUshort(),17914==f)){this.periods=a.position+a.readUshort();break}if(c&&b&&k&&h){a.position=b;this.samples=
[];k++;for(d=0;d<k;++d)f=p(),f.length=a.readUint(),f.relative=parseInt(3579545/a.readUshort()),f.pointer=this.mixer.store(a,f.length),this.samples[d]=f;a.position=c;for(d=0;d<k;++d)f=this.samples[d],a.position+=4,f.loopPtr=a.readInt(),a.position+=6,f.volume=a.readUshort(),e&&(f.divider=a.readUshort(),f.vibrato=a.readUshort(),f.hiPos=a.readUshort(),f.loPos=a.readUshort(),a.position+=8);if(e){a.position=e;d=e-c>>5;c=d+3;this.variant=1;if(d>=k)for(;k<d;++k)this.samples[k]=p();for(;d<c;++d){f=p();a.position+=
4;f.loopPtr=a.readInt();f.length=a.readUshort();f.relative=a.readUshort();a.position+=2;f.volume=a.readUshort();f.divider=a.readUshort();f.vibrato=a.readUshort();f.hiPos=a.readUshort();f.loPos=a.readUshort();e=a.position;a.position=l;a.position=a.readInt();f.pointer=this.mixer.memory.length;this.mixer.memory.length+=f.length;for(k=0;k<f.length;++k)f.wave[k]=a.readByte();this.samples[d]=f;l+=4;a.position=e}}a.position=h;this.songs=[];for(f=65536;;){h=Object.create(null,{speed:{value:0,writable:!0},
tracks:{value:null,writable:!0}});a.position++;h.tracks=new Uint32Array(4);h.speed=a.readUbyte();for(d=0;4>d;++d)k=a.readUint(),k<f&&(f=k),h.tracks[d]=k;this.songs.push(h);if(18>f-a.position)break}this.lastSong=this.songs.length-1;a.length=b;for(a.position=352;512>a.position;)f=a.readUshort(),45116==f&&(f=a.readUshort(),133==f?this.variant=2:134==f?this.variant=4:135==f&&(this.variant=3));this.stream=a;this.version=1}}},process:{value:function(){for(var a,d,k,c,e=this.voices[3];e;){a=e.channel;this.stream.position=
e.patternPos;k=e.sample;e.busy||(e.busy=1,0==k.loopPtr?(a.pointer=this.mixer.loopPtr,a.length=this.mixer.loopLen):0<k.loopPtr&&(a.pointer=k.pointer+k.loopPtr,a.length=k.length-k.loopPtr));if(0==--e.tick)for(e.flags=0,d=1;d;)if(c=this.stream.readByte(),0>c)switch(c){case -121:3==this.variant&&(e.volume=this.stream.readUbyte());break;case -122:4==this.variant&&(e.volume=this.stream.readUbyte());break;case -123:1<this.variant&&(this.mixer.complete=1);break;case -124:this.stream.position=e.trackPtr+e.trackPos;
c=this.stream.readUint();e.trackPos+=4;c||(this.stream.position=e.trackPtr,c=this.stream.readUint(),e.trackPos=4,this.loopSong||(this.complete&=~e.bitFlag,this.complete||(this.mixer.complete=1)));this.stream.position=c;break;case -125:4==this.variant&&(e.flags|=4);break;case -126:e.tick=this.song.speed*this.stream.readByte();e.patternPos=this.stream.position;a.pointer=this.mixer.loopPtr;a.length=this.mixer.loopLen;d=0;break;case -127:e.portaSpeed=this.stream.readByte();e.flags|=1;break;case -128:c=
this.stream.readByte(),0>c&&(c=0),e.sample=k=this.samples[c],e.vibratoPtr=this.vibrato+k.vibrato,e.vibratoPos=e.vibratoPtr}else e.tick=this.song.speed*c,e.note=this.stream.readByte(),e.patternPos=this.stream.position,e.synthPos=k.loPos,e.vibratoPos=e.vibratoPtr,a.pointer=k.pointer,a.length=k.length,a.volume=e.volume?e.volume:k.volume,this.stream.position=this.periods+(e.note<<1),c=this.stream.readUshort()*k.relative,a.period=e.period=c>>10,a.enabled=1,e.busy=d=0;else 1!=e.tick||4==this.variant&&e.flags&
4||(a.enabled=0),e.flags&1&&(a.period=e.period+=e.portaSpeed),k.divider&&(this.stream.position=e.vibratoPos,c=this.stream.readByte(),-124==c&&(this.stream.position=e.vibratoPtr,c=this.stream.readByte()),e.vibratoPos=this.stream.position,c*=parseInt(e.period/k.divider),a.period=e.period+c);k.hiPos&&(c=0,e.flags&2?(e.synthPos--,e.synthPos<=k.loPos&&(e.flags&=-3,c=60)):(e.synthPos++,e.synthPos>k.hiPos&&(e.flags|=2,c=60)),this.mixer.memory[k.pointer+e.synthPos]=c);e=e.next}}}});d.voices[3]=l(3,8);d.voices[3].next=
d.voices[2]=l(2,4);d.voices[2].next=d.voices[1]=l(1,2);d.voices[1].next=d.voices[0]=l(0,1);return Object.seal(d)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},step:{value:0,writable:!0},row:{value:0,writable:!0},sample:{value:0,writable:!0},samplePtr:{value:0,writable:!0},sampleLen:{value:0,writable:!0},note:{value:0,writable:!0},noteTimer:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,
writable:!0},bendTo:{value:0,writable:!0},bendSpeed:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},envelopeCtr:{value:0,writable:!0},pitchCtr:{value:0,writable:!0},pitchFallCtr:{value:0,writable:!0},sustainCtr:{value:0,writable:!0},phaseTimer:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},wavePos:{value:0,writable:!0},waveList:{value:0,writable:!0},waveTimer:{value:0,writable:!0},waitCtr:{value:0,writable:!0},initialize:{value:function(){this.sample=this.row=this.step=0;this.samplePtr=
-1;this.noteTimer=this.note=this.sampleLen=0;this.period=39321;this.waitCtr=this.waveTimer=this.waveList=this.wavePos=this.phaseSpeed=this.phaseTimer=this.sustainCtr=this.pitchFallCtr=this.pitchCtr=this.envelopeCtr=this.arpeggioCtr=this.bendSpeed=this.bendTo=this.volume=0}}})}function p(){var a=A();Object.defineProperties(a,{waveform:{value:0,writable:!0},arpeggio:{value:null,writable:!0},attackSpeed:{value:0,writable:!0},attackMax:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},decayMin:{value:0,
writable:!0},sustain:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0},releaseMin:{value:0,writable:!0},phaseShift:{value:0,writable:!0},phaseSpeed:{value:0,writable:!0},finetune:{value:0,writable:!0},pitchFall:{value:0,writable:!0}});a.arpeggio=new Uint8Array(16);return Object.seal(a)}var d=[1166,408,908],a=[0,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,
640,604,570,538,508,480,452,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,0,0,0,0,0,0,0,4028,3806,3584,3394,3204,3013,2855,2696,2538,2395,2268,2141,2014,1903,1792,1697,1602,1507,1428,1348,1269,1198,1134,1071,1007,952,896,849,801,754,714,674,635,599,567,536,504,476,448,425,401,377,357,337,310,300,284,268,252,238,224,213,201,189,179,169,159,150,142,134,0,0,0,0,0,0,0,3993,3773,3552,3364,3175,2987,2830,2672,2515,2374,2248,2122,1997,1887,1776,1682,1588,1494,1415,
1336,1258,1187,1124,1061,999,944,888,841,794,747,708,668,629,594,562,531,500,472,444,421,397,374,354,334,315,297,281,266,250,236,222,211,199,187,177,167,158,149,141,133,0,0,0,0,0,0,0,3957,3739,3521,3334,3147,2960,2804,2648,2493,2353,2228,2103,1979,1870,1761,1667,1574,1480,1402,1324,1247,1177,1114,1052,990,935,881,834,787,740,701,662,624,589,557,526,495,468,441,417,394,370,351,331,312,295,279,263,248,234,221,209,197,185,176,166,156,148,140,132,0,0,0,0,0,0,0,3921,3705,3489,3304,3119,2933,2779,2625,
2470,2331,2208,2084,1961,1853,1745,1652,1560,1467,1390,1313,1235,1166,1104,1042,981,927,873,826,780,734,695,657,618,583,552,521,491,464,437,413,390,367,348,329,309,292,276,261,246,232,219,207,195,184,174,165,155,146,138,131,0,0,0,0,0,0,0,3886,3671,3457,3274,3090,2907,2754,2601,2448,2310,2188,2065,1943,1836,1729,1637,1545,1454,1377,1301,1224,1155,1094,1033,972,918,865,819,773,727,689,651,612,578,547,517,486,459,433,410,387,364,345,326,306,289,274,259,243,230,217,205,194,182,173,163,153,145,137,130,
0,0,0,0,0,0,0,3851,3638,3426,3244,3062,2880,2729,2577,2426,2289,2168,2047,1926,1819,1713,1622,1531,1440,1365,1289,1213,1145,1084,1024,963,910,857,811,766,720,683,645,607,573,542,512,482,455,429,406,383,360,342,323,304,287,271,256,241,228,215,203,192,180,171,162,152,144,136,128,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,452,
428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127];window.neoart.S1Player=function(g){g=B(g);Object.defineProperties(g,{id:{value:"S1Player"},tracksPtr:{value:null,writable:!0},tracks:{value:[],writable:!0},patternsPtr:{value:null,writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},waveLists:{value:null,writable:!0},speedDef:{value:0,writable:!0},patternDef:{value:0,writable:!0},mix1Speed:{value:0,writable:!0},mix2Speed:{value:0,writable:!0},
mix1Dest:{value:0,writable:!0},mix2Dest:{value:0,writable:!0},mix1Source1:{value:0,writable:!0},mix1Source2:{value:0,writable:!0},mix2Source1:{value:0,writable:!0},mix2Source2:{value:0,writable:!0},doFilter:{value:0,writable:!0},doReset:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},trackEnd:{value:0,writable:!0},trackLen:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternEnd:{value:0,writable:!0},patternLen:{value:0,writable:!0},mix1Ctr:{value:0,writable:!0},
mix2Ctr:{value:0,writable:!0},mix1Pos:{value:0,writable:!0},mix2Pos:{value:0,writable:!0},audPtr:{value:0,writable:!0},audLen:{value:0,writable:!0},audPer:{value:0,writable:!0},audVol:{value:0,writable:!0},initialize:{value:function(){var a,c,d=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.trackPos=1;this.trackEnd=0;this.patternPos=-1;this.patternEnd=0;this.patternLen=this.patternDef;for(this.mix2Ctr=this.mix2Pos=this.mix1Ctr=this.mix1Pos=0;d;)d.initialize(),a=this.mixer.channels[d.index],
d.channel=a,d.step=this.tracksPtr[d.index],c=this.tracks[d.step],d.row=this.patternsPtr[c.pattern],d.sample=this.patterns[d.row].sample,a.length=32,a.period=d.period,a.enabled=1,d=d.next}},loader:{value:function(a){for(var c,e,f,b,g,l,q,n,u,r,C,I;8<a.bytesAvailable;)if(n=a.readUshort(),16890==n&&(f=a.readUshort(),n=a.readUshort(),53736==n&&(n=a.readUshort(),65492==n))){I=4076==f?4090:5222==f?5188:f;l=f+a.position-6;break}if(l&&(a.position=l,e=a.readString(32)," SID-MON BY R.v.VLIET  (c) 1988 "==e)){a.position=
l-44;n=a.readUint();for(e=1;4>e;++e)this.tracksPtr[e]=(a.readUint()-n)/6>>0;a.position=l-8;n=a.readUint();g=a.readUint();g<n&&(g=a.length-l);u=g-n>>2;this.patternsPtr=new Uint32Array(u);a.position=l+n+4;for(e=1;e<u;++e){n=a.readUint()/5>>0;if(0==n){u=e;break}this.patternsPtr[e]=n}this.patternsPtr.length=u;a.position=l-44;n=a.readUint();a.position=l-28;g=(a.readUint()-n)/6>>0;this.tracks.length=g;a.position=l+n;for(e=0;e<g;++e){n=E();n.pattern=a.readUint();n.pattern>=u&&(n.pattern=0);a.readByte();
n.transpose=a.readByte();if(-99>n.transpose||99<n.transpose)n.transpose=0;this.tracks[e]=n}a.position=l-24;n=a.readUint();C=a.readUint()-n;for(e=0;32>e;++e)this.mixer.memory[e]=0;this.mixer.store(a,C,l+n);C>>=5;a.position=l-16;n=a.readUint();g=a.readUint()-n+16;f=C+2<<4;this.waveLists=new Uint8Array(g<f?f:g);a.position=l+n;for(e=0;e<f;)this.waveLists[e++]=e>>4,this.waveLists[e++]=255,this.waveLists[e++]=255,this.waveLists[e++]=16,e+=12;for(e=16;e<g;++e)this.waveLists[e]=a.readUbyte();a.position=l-
20;a.position=l+a.readUint();this.mix1Source1=a.readUint();this.mix2Source1=a.readUint();this.mix1Source2=a.readUint();this.mix2Source2=a.readUint();this.mix1Dest=a.readUint();this.mix2Dest=a.readUint();this.patternDef=a.readUint();this.trackLen=a.readUint();this.speedDef=a.readUint();this.mix1Speed=a.readUint();this.mix2Speed=a.readUint();this.mix1Source1>C&&(this.mix1Source1=0);this.mix2Source1>C&&(this.mix2Source1=0);this.mix1Source2>C&&(this.mix1Source2=0);this.mix2Source2>C&&(this.mix2Source2=
0);this.mix1Dest>C&&(this.mix1Speed=0);this.mix2Dest>C&&(this.mix2Speed=0);0==this.speedDef&&(this.speedDef=4);a.position=l-28;f=a.readUint();u=a.readUint()-f>>5;63<u&&(u=63);g=u+1;a.position=l-4;n=a.readUint();if(1==n){a.position=1820;n=a.readUshort();if(19962!=n&&(a.position=1788,n=a.readUshort(),19962!=n)){this.version=0;return}a.position+=a.readUshort();this.samples.length=g+3;for(e=0;3>e;++e)q=p(),q.waveform=16+e,q.length=d[e],q.pointer=this.mixer.store(a,q.length),q.loop=q.loopPtr=0,q.repeat=
4,q.volume=64,this.samples[g+e]=q,a.position+=q.length}else this.samples.length=g,a.position=l+n,c=a.readUint(),r=(c>>5)+15,b=a.position,c+=b;q=p();this.samples[0]=q;a.position=l+f;for(e=1;e<g;++e){q=p();q.waveform=a.readUint();for(f=0;16>f;++f)q.arpeggio[f]=a.readUbyte();q.attackSpeed=a.readUbyte();q.attackMax=a.readUbyte();q.decaySpeed=a.readUbyte();q.decayMin=a.readUbyte();q.sustain=a.readUbyte();a.readByte();q.releaseSpeed=a.readUbyte();q.releaseMin=a.readUbyte();q.phaseShift=a.readUbyte();q.phaseSpeed=
a.readUbyte();q.finetune=a.readUbyte();q.pitchFall=a.readByte();5188==I?(q.pitchFall=q.finetune,q.finetune=0):(15<q.finetune&&(q.finetune=0),q.finetune*=67);q.phaseShift>C&&(q.phaseShift=0,q.phaseSpeed=0);if(15<q.waveform)if(15<r&&q.waveform>r)q.waveform=0;else{n=b+(q.waveform-16<<5);if(n>=a.length)continue;f=a.position;a.position=n;q.pointer=a.readUint();q.loop=a.readUint();q.length=a.readUint();q.name=a.readString(20);0==q.loop||99999==q.loop||199999==q.loop||q.loop>=q.length?(q.loop=0,q.repeat=
4090==I?2:4):(q.repeat=q.length-q.loop,q.loop-=q.pointer);q.length-=q.pointer;q.length<q.loop+q.repeat&&(q.length=q.loop+q.repeat);q.pointer=this.mixer.store(a,q.length,c+q.pointer);q.loopPtr=6>q.repeat||0==q.loop?0:q.pointer+q.loop;a.position=f}else q.waveform>C&&(q.waveform=0);this.samples[e]=q}a.position=l-12;n=a.readUint();g=(a.readUint()-n)/5>>0;this.patterns.length=g;a.position=l+n;for(e=0;e<g;++e)c=D(),Object.defineProperties(c,{speed:{value:0,writable:!0}}),c=Object.seal(c),c.note=a.readUbyte(),
c.sample=a.readUbyte(),c.effect=a.readUbyte(),c.param=a.readUbyte(),c.speed=a.readUbyte(),5188==I?(0<c.note&&255>c.note&&(c.note+=469),0<c.effect&&255>c.effect&&(c.effect+=469),59<c.sample&&(c.sample=u+(c.sample-60))):c.sample>u&&(c.sample=0),this.patterns[e]=c;4464==I||4550==I||5188==I?(4464==I&&(this.mix1Speed=this.mix2Speed=0),this.doReset=this.doFilter=0):this.doReset=this.doFilter=1;this.version=1}}},process:{value:function(){var d,c,e,f=this.mixer.memory,b,g;for(g=this.voices[0];g;){d=g.channel;
this.audPtr=-1;this.audLen=this.audPer=this.audVol=0;if(0==this.tick)if(this.patternEnd&&(this.trackEnd?g.step=this.tracksPtr[g.index]:g.step++,e=this.tracks[g.step],g.row=this.patternsPtr[e.pattern],this.doReset&&(g.noteTimer=0)),0==g.noteTimer){b=this.patterns[g.row];0==b.sample?b.note&&(g.noteTimer=b.speed,g.waitCtr&&(c=this.samples[g.sample],this.audPtr=c.pointer,this.audLen=c.length,g.samplePtr=c.loopPtr,g.sampleLen=c.repeat,g.waitCtr=1,d.enabled=0)):(c=this.samples[b.sample],g.waitCtr&&(d.enabled=
g.waitCtr=0),15<c.waveform?(this.audPtr=c.pointer,this.audLen=c.length,g.samplePtr=c.loopPtr,g.sampleLen=c.repeat,g.waitCtr=1):(g.wavePos=0,g.waveList=c.waveform,e=g.waveList<<4,this.audPtr=this.waveLists[e]<<5,this.audLen=32,g.waveTimer=this.waveLists[++e]),g.noteTimer=b.speed,g.sample=b.sample,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=0);if(b.note&&(g.noteTimer=b.speed,255!=b.note))switch(c=this.samples[g.sample],e=this.tracks[g.step],g.note=b.note+e.transpose,g.period=this.audPer=a[1+c.finetune+
g.note],g.phaseSpeed=c.phaseSpeed,g.bendSpeed=g.volume=0,g.envelopeCtr=g.pitchCtr=g.pitchFallCtr=0,b.effect){case 0:if(0==b.param)break;c.attackSpeed=b.param;c.attackMax=b.param;g.waveTimer=0;break;case 2:this.speed=b.param;g.waveTimer=0;break;case 3:this.patternLen=b.param;g.waveTimer=0;break;default:g.bendTo=b.effect+e.transpose,g.bendSpeed=b.param}g.row++}else g.noteTimer--;c=this.samples[g.sample];this.audVol=g.volume;switch(g.envelopeCtr){case 0:this.audVol+=c.attackSpeed;this.audVol>c.attackMax&&
(this.audVol=c.attackMax,g.envelopeCtr+=2);break;case 2:this.audVol-=c.decaySpeed;if(this.audVol<=c.decayMin||-256>this.audVol)this.audVol=c.decayMin,g.envelopeCtr+=2,g.sustainCtr=c.sustain;break;case 4:g.sustainCtr--;if(0==g.sustainCtr||-256==g.sustainCtr)g.envelopeCtr+=2;break;case 6:if(this.audVol-=c.releaseSpeed,this.audVol<=c.releaseMin||-256>this.audVol)this.audVol=c.releaseMin,g.envelopeCtr=8}g.volume=this.audVol;g.arpeggioCtr=++g.arpeggioCtr&15;e=c.finetune+c.arpeggio[g.arpeggioCtr]+g.note;
g.period=this.audPer=a[e];g.bendSpeed&&(b=a[c.finetune+g.bendTo],e=~g.bendSpeed+1,-128>e&&(e&=255),g.pitchCtr+=e,g.period+=g.pitchCtr,0>e&&g.period<=b||0<e&&g.period>=b)&&(g.note=g.bendTo,g.period=b,g.bendSpeed=0,g.pitchCtr=0);c.phaseShift&&(g.phaseSpeed?g.phaseSpeed--:(g.phaseTimer=++g.phaseTimer&31,e=(c.phaseShift<<5)+g.phaseTimer,g.period+=f[e]>>2));g.pitchFallCtr-=c.pitchFall;-256>g.pitchFallCtr&&(g.pitchFallCtr+=256);g.period+=g.pitchFallCtr;0==g.waitCtr&&(g.waveTimer?g.waveTimer--:16>g.wavePos&&
(e=(g.waveList<<4)+g.wavePos,b=this.waveLists[e++],255==b?g.wavePos=this.waveLists[e]&254:(this.audPtr=b<<5,g.waveTimer=this.waveLists[e],g.wavePos+=2)));-1<this.audPtr&&(d.pointer=this.audPtr);0!=this.audPer&&(d.period=g.period);0!=this.audLen&&(d.length=this.audLen);d.volume=c.volume?c.volume:this.audVol>>2;d.enabled=1;g=g.next}this.trackEnd=this.patternEnd=0;++this.tick>this.speed&&(this.tick=0,++this.patternPos==this.patternLen&&(this.patternPos=0,this.patternEnd=1,++this.trackPos==this.trackLen&&
(this.trackPos=this.trackEnd=this.mixer.complete=1)));if(this.mix1Speed){if(0==this.mix1Ctr)for(this.mix1Ctr=this.mix1Speed,e=this.mix1Pos=++this.mix1Pos&31,d=(this.mix1Dest<<5)+31,g=(this.mix1Source1<<5)+31,b=this.mix1Source2<<5,c=31;-1<c;--c)f[d--]=f[g--]+f[b+e]>>1,e=--e&31;this.mix1Ctr--}if(this.mix2Speed){if(0==this.mix2Ctr)for(this.mix2Ctr=this.mix2Speed,e=this.mix2Pos=++this.mix2Pos&31,d=(this.mix2Dest<<5)+31,g=(this.mix2Source1<<5)+31,b=this.mix2Source2<<5,c=31;-1<c;--c)f[d--]=f[g--]+f[b+e]>>
1,e=--e&31;this.mix2Ctr--}this.doFilter&&(e=this.mix1Pos+32,f[e]=~f[e]+1);for(g=this.voices[0];g;)d=g.channel,1==g.waitCtr?g.waitCtr++:2==g.waitCtr&&(g.waitCtr++,d.pointer=g.samplePtr,d.length=g.sampleLen),g=g.next}}});g.voices[0]=l(0);g.voices[0].next=g.voices[1]=l(1);g.voices[1].next=g.voices[2]=l(2);g.voices[2].next=g.voices[3]=l(3);g.tracksPtr=new Uint32Array(4);return Object.seal(g)}})();(function(){function l(a){return Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},
channel:{value:null,writable:!0},step:{value:null,writable:!0},row:{value:null,writable:!0},instr:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},pattern:{value:0,writable:!0},instrument:{value:0,writable:!0},note:{value:0,writable:!0},period:{value:0,writable:!0},volume:{value:0,writable:!0},original:{value:0,writable:!0},adsrPos:{value:0,writable:!0},sustainCtr:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendCtr:{value:0,writable:!0},noteSlideTo:{value:0,
writable:!0},noteSlideSpeed:{value:0,writable:!0},waveCtr:{value:0,writable:!0},wavePos:{value:0,writable:!0},arpeggioCtr:{value:0,writable:!0},arpeggioPos:{value:0,writable:!0},vibratoCtr:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},speed:{value:0,writable:!0},initialize:{value:function(){this.sample=this.instr=this.row=this.step=null;this.speed=this.vibratoPos=this.vibratoCtr=this.arpeggioPos=this.arpeggioCtr=this.wavePos=this.waveCtr=this.noteSlideSpeed=this.noteSlideTo=this.pitchBendCtr=
this.pitchBend=this.sustainCtr=this.adsrPos=this.original=this.volume=this.period=this.note=this.instrument=this.pattern=this.enabled=0}}})}function p(){return Object.create(null,{wave:{value:0,writable:!0},waveLen:{value:0,writable:!0},waveDelay:{value:0,writable:!0},waveSpeed:{value:0,writable:!0},arpeggio:{value:0,writable:!0},arpeggioLen:{value:0,writable:!0},arpeggioDelay:{value:0,writable:!0},arpeggioSpeed:{value:0,writable:!0},vibrato:{value:0,writable:!0},vibratoLen:{value:0,writable:!0},
vibratoDelay:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},pitchBend:{value:0,writable:!0},pitchBendDelay:{value:0,writable:!0},attackMax:{value:0,writable:!0},attackSpeed:{value:0,writable:!0},decayMin:{value:0,writable:!0},decaySpeed:{value:0,writable:!0},sustain:{value:0,writable:!0},releaseMin:{value:0,writable:!0},releaseSpeed:{value:0,writable:!0}})}var d=[0,5760,5424,5120,4832,4560,4304,4064,3840,3616,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1808,1712,1616,1524,1440,
1356,1280,1208,1140,1076,1016,960,904,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,107,101,95];window.neoart.S2Player=function(a){a=B(a);Object.defineProperties(a,{id:{value:"S2Player"},tracks:{value:[],writable:!0},patterns:{value:[],writable:!0},instruments:{value:[],writable:!0},samples:{value:[],writable:!0},arpeggios:{value:null,writable:!0},vibratos:{value:null,writable:!0},waves:{value:null,writable:!0},
length:{value:0,writable:!0},speedDef:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},patternLen:{value:0,writable:!0},arpeggioFx:{value:null,writable:!0},arpeggioPos:{value:0,writable:!0},initialize:{value:function(){var a=this.voices[0];this.reset();this.tick=this.speed=this.speedDef;this.patternPos=this.trackPos=0;for(this.patternLen=64;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.instr=this.instruments[0],this.arpeggioFx[a.index]=
0,a=a.next}},loader:{value:function(a){var d=0,c=0,e,f,b,l=0,m,q,n;a.position=58;if("SIDMON II - THE MIDI VERSION"==a.readString(28)){a.position=2;this.length=a.readUbyte();this.speedDef=a.readUbyte();this.samples.length=a.readUshort()>>6;a.position=14;b=a.readUint();this.tracks.length=b;for(a.position=90;c<b;++c)e=E(),Object.defineProperties(e,{soundTranspose:{value:0,writable:!0}}),e=Object.seal(e),e.pattern=a.readUbyte(),e.pattern>d&&(d=e.pattern),this.tracks[c]=e;for(c=0;c<b;++c)e=this.tracks[c],
e.transpose=a.readByte();for(c=0;c<b;++c)e=this.tracks[c],e.soundTranspose=a.readByte();e=a.position;a.position=26;b=a.readUint()>>5;this.instruments.length=++b;a.position=e;this.instruments[0]=p();for(c=0;++c<b;)e=p(),e.wave=a.readUbyte()<<4,e.waveLen=a.readUbyte(),e.waveSpeed=a.readUbyte(),e.waveDelay=a.readUbyte(),e.arpeggio=a.readUbyte()<<4,e.arpeggioLen=a.readUbyte(),e.arpeggioSpeed=a.readUbyte(),e.arpeggioDelay=a.readUbyte(),e.vibrato=a.readUbyte()<<4,e.vibratoLen=a.readUbyte(),e.vibratoSpeed=
a.readUbyte(),e.vibratoDelay=a.readUbyte(),e.pitchBend=a.readByte(),e.pitchBendDelay=a.readUbyte(),a.readByte(),a.readByte(),e.attackMax=a.readUbyte(),e.attackSpeed=a.readUbyte(),e.decayMin=a.readUbyte(),e.decaySpeed=a.readUbyte(),e.sustain=a.readUbyte(),e.releaseMin=a.readUbyte(),e.releaseSpeed=a.readUbyte(),this.instruments[c]=e,a.position+=9;e=a.position;a.position=30;b=a.readUint();this.waves=new Uint8Array(b);a.position=e;for(c=0;c<b;++c)this.waves[c]=a.readUbyte();e=a.position;a.position=34;
b=a.readUint();this.arpeggios=new Int8Array(b);a.position=e;for(c=0;c<b;++c)this.arpeggios[c]=a.readByte();e=a.position;a.position=38;b=a.readUint();this.vibratos=new Int8Array(b);a.position=e;for(c=0;c<b;++c)this.vibratos[c]=a.readByte();b=this.samples.length;for(c=e=0;c<b;++c)q=A(),Object.defineProperties(q,{negStart:{value:0,writable:!0},negLen:{value:0,writable:!0},negSpeed:{value:0,writable:!0},negDir:{value:0,writable:!0},negOffset:{value:0,writable:!0},negPos:{value:0,writable:!0},negCtr:{value:0,
writable:!0},negToggle:{value:0,writable:!0}}),q=Object.seal(q),a.readUint(),q.length=a.readUshort()<<1,q.loop=a.readUshort()<<1,q.repeat=a.readUshort()<<1,q.negStart=e+(a.readUshort()<<1),q.negLen=a.readUshort()<<1,q.negSpeed=a.readUshort(),q.negDir=a.readUshort(),q.negOffset=a.readShort(),q.negPos=a.readUint(),q.negCtr=a.readUshort(),a.position+=6,q.name=a.readString(32),q.pointer=e,q.loopPtr=e+q.loop,e+=q.length,this.samples[c]=q;q=e;b=++d;d=new Uint16Array(++d);for(c=0;c<b;++c)d[c]=a.readUshort();
e=a.position;a.position=50;b=a.readUint();this.patterns=[];a.position=e;f=1;for(c=0;c<b;++c)m=D(),Object.defineProperties(m,{speed:{value:0,writable:!0}}),m=Object.seal(m),(n=a.readByte())?0>n?m.speed=~n:112>n?(m.note=n,n=a.readByte(),c++,0>n?m.speed=~n:112>n?(m.sample=n,n=a.readByte(),c++,0>n?m.speed=~n:(m.effect=n,m.param=a.readUbyte(),c++)):(m.effect=n,m.param=a.readUbyte(),c++)):(m.effect=n,m.param=a.readUbyte(),c++):(m.effect=a.readByte(),m.param=a.readUbyte(),c+=2),this.patterns[l++]=m,e+d[f]==
a.position&&(d[f++]=l);d[f]=this.patterns.length;0!=(a.position&1)&&a.position++;this.mixer.store(a,q);b=this.tracks.length;for(c=0;c<b;++c)e=this.tracks[c],e.pattern=d[e.pattern];this.length++;this.version=2}}},process:{value:function(){var a,k,c,e,f,b=this.voices[0];this.arpeggioPos=++this.arpeggioPos&3;if(++this.tick>=this.speed){for(this.tick=0;b;)a=b.channel,b.enabled=b.note=0,this.patternPos||(b.step=this.tracks[this.trackPos+b.index*this.length],b.pattern=b.step.pattern,b.speed=0),0>--b.speed&&
(b.row=c=this.patterns[b.pattern++],b.speed=c.speed,c.note&&(b.enabled=1,b.note=c.note+b.step.transpose,a.enabled=0)),b.pitchBend=0,b.note&&(b.waveCtr=b.sustainCtr=0,b.arpeggioCtr=b.arpeggioPos=0,b.vibratoCtr=b.vibratoPos=0,b.pitchBendCtr=b.noteSlideSpeed=0,b.adsrPos=4,b.volume=0,c.sample&&(b.instrument=c.sample,b.instr=this.instruments[b.instrument+b.step.soundTranspose],b.sample=this.samples[this.waves[b.instr.wave]]),b.original=b.note+this.arpeggios[b.instr.arpeggio],a.period=b.period=d[b.original],
e=b.sample,a.pointer=e.pointer,a.length=e.length,a.enabled=b.enabled,a.pointer=e.loopPtr,a.length=e.repeat),b=b.next;++this.patternPos==this.patternLen&&(this.patternPos=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}for(b=this.voices[0];b;){if(b.sample&&(e=b.sample,!e.negToggle))if(e.negToggle=1,e.negCtr)e.negCtr=--e.negCtr&31;else{e.negCtr=e.negSpeed;if(!e.negDir){b=b.next;continue}f=e.negStart+e.negPos;this.mixer.memory[f]=~this.mixer.memory[f];e.negPos+=e.negOffset;f=
e.negLen-1;0>e.negPos?2==e.negDir?e.negPos=f:(e.negOffset=-e.negOffset,e.negPos+=e.negOffset):f<e.negPos&&(1==e.negDir?e.negPos=0:(e.negOffset=-e.negOffset,e.negPos+=e.negOffset))}b=b.next}for(b=this.voices[0];b;)b.sample&&(b.sample.negToggle=0),b=b.next;for(b=this.voices[0];b;){a=b.channel;k=b.instr;switch(b.adsrPos){case 4:b.volume+=k.attackSpeed;k.attackMax<=b.volume&&(b.volume=k.attackMax,b.adsrPos--);break;case 3:k.decaySpeed?(b.volume-=k.decaySpeed,k.decayMin>=b.volume&&(b.volume=k.decayMin,
b.adsrPos--)):b.adsrPos--;break;case 2:b.sustainCtr==k.sustain?b.adsrPos--:b.sustainCtr++;break;case 1:b.volume-=k.releaseSpeed,k.releaseMin>=b.volume&&(b.volume=k.releaseMin,b.adsrPos--)}a.volume=b.volume>>2;k.waveLen&&(b.waveCtr==k.waveDelay?(b.waveCtr=k.waveDelay-k.waveSpeed,b.wavePos==k.waveLen?b.wavePos=0:b.wavePos++,b.sample=e=this.samples[this.waves[k.wave+b.wavePos]],a.pointer=e.pointer,a.length=e.length):b.waveCtr++);k.arpeggioLen&&(b.arpeggioCtr==k.arpeggioDelay?(b.arpeggioCtr=k.arpeggioDelay-
k.arpeggioSpeed,b.arpeggioPos==k.arpeggioLen?b.arpeggioPos=0:b.arpeggioPos++,f=b.original+this.arpeggios[k.arpeggio+b.arpeggioPos],b.period=d[f]):b.arpeggioCtr++);c=b.row;if(this.tick)switch(c.effect){case 112:this.arpeggioFx[0]=c.param>>4;this.arpeggioFx[2]=c.param&15;f=b.original+this.arpeggioFx[this.arpeggioPos];b.period=d[f];break;case 113:b.pitchBend=~c.param+1;break;case 114:b.pitchBend=c.param;break;case 115:if(0!=b.adsrPos)break;0!=b.instrument&&(b.volume=k.attackMax);b.volume+=c.param<<2;
256<=b.volume&&(b.volume=-1);break;case 116:if(0!=b.adsrPos)break;0!=b.instrument&&(b.volume=k.attackMax);b.volume-=c.param<<2;0>b.volume&&(b.volume=0)}switch(c.effect){case 117:k.attackMax=c.param;k.attackSpeed=c.param;break;case 118:this.patternLen=c.param;break;case 124:a.volume=c.param;b.volume=c.param<<2;255<=b.volume&&(b.volume=255);break;case 127:if(f=c.param&15)this.speed=f}k.vibratoLen&&(b.vibratoCtr==k.vibratoDelay?(b.vibratoCtr=k.vibratoDelay-k.vibratoSpeed,b.vibratoPos==k.vibratoLen?b.vibratoPos=
0:b.vibratoPos++,b.period+=this.vibratos[k.vibrato+b.vibratoPos]):b.vibratoCtr++);k.pitchBend&&(b.pitchBendCtr==k.pitchBendDelay?b.pitchBend+=k.pitchBend:b.pitchBendCtr++);c.param&&c.effect&&112>c.effect&&(b.noteSlideTo=d[c.effect+b.step.transpose],f=c.param,0>b.noteSlideTo-b.period&&(f=-f),b.noteSlideSpeed=f);b.noteSlideTo&&b.noteSlideSpeed&&(b.period+=b.noteSlideSpeed,0>b.noteSlideSpeed&&b.period<b.noteSlideTo||0<b.noteSlideSpeed&&b.period>b.noteSlideTo)&&(b.noteSlideSpeed=0,b.period=b.noteSlideTo);
b.period+=b.pitchBend;95>b.period?b.period=95:5760<b.period&&(b.period=5760);a.period=b.period;b=b.next}}}});a.voices[0]=l(0);a.voices[0].next=a.voices[1]=l(1);a.voices[1].next=a.voices[2]=l(2);a.voices[2].next=a.voices[3]=l(3);a.arpeggioFx=new Uint8Array(4);return Object.seal(a)}})();(function(){function l(d){return Object.create(null,{index:{value:d,writable:!0},next:{value:null,writable:!0},channel:{value:null,writable:!0},sample:{value:null,writable:!0},enabled:{value:0,writable:!0},period:{value:0,
writable:!0},last:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0},initialize:{value:function(){this.sample=this.channel=null;this.param=this.effect=this.last=this.period=this.enabled=0}}})}var p=[856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,226,214,202,190,180,170,160,151,143,135,127,120,113,0,0,0];window.neoart.STPlayer=function(d){d=B(d);Object.defineProperties(d,{id:{value:"STPlayer"},standard:{value:0,writable:!0},track:{value:null,
writable:!0},patterns:{value:[],writable:!0},samples:{value:[],writable:!0},length:{value:0,writable:!0},voices:{value:[],writable:!0},trackPos:{value:0,writable:!0},patternPos:{value:0,writable:!0},jumpFlag:{value:0,writable:!0},force:{set:function(a){1>a?a=1:4<a&&(a=4);this.version=a}},ntsc:{set:function(a){this.standard=a;this.frequency(a);2>this.version&&(a=this.sampleRate/1E3*(a?20.44952532:20.637767904)/120,this.mixer.samplesTick=(240-this.tempo)*a>>0)}},initialize:{value:function(){var a=this.voices[0];
this.reset();this.ntsc=this.standard;this.speed=6;for(this.jumpFlag=this.patternPos=this.trackPos=0;a;)a.initialize(),a.channel=this.mixer.channels[a.index],a.sample=this.samples[0],a=a.next}},loader:{value:function(a){var d=0,k,c,e=0,f=0,b;if(!(1626>a.length)){this.title=a.readString(20);e+=this.isLegal(this.title);this.version=1;a.position=42;for(k=1;16>k;++k)(b=a.readUshort())?(c=A(),a.position-=24,c.name=a.readString(22),c.length=b<<1,a.position+=3,c.volume=a.readUbyte(),c.loop=a.readUshort(),
c.repeat=a.readUshort()<<1,a.position+=22,c.pointer=f,f+=c.length,this.samples[k]=c,e+=this.isLegal(c.name),9999<c.length&&(this.version=3)):(this.samples[k]=null,a.position+=28);a.position=470;this.length=a.readUbyte();this.tempo=a.readUbyte();for(k=0;128>k;++k)b=a.readUbyte()<<8,16384<b&&e--,this.track[k]=b,b>d&&(d=b);a.position=600;d+=256;this.patterns.length=d;k=a.length-f-600>>2;d>k&&(d=k);for(k=0;k<d;++k){c=D();c.note=a.readUshort();b=a.readUbyte();c.param=a.readUbyte();c.effect=b&15;c.sample=
b>>4;this.patterns[k]=c;2<c.effect&&11>c.effect&&e--;c.note&&(113>c.note||856<c.note)&&e--;c.sample&&(15<c.sample||!this.samples[c.sample])&&(15<c.sample&&e--,c.sample=0);if(2<c.effect||!c.effect&&0!=c.param)this.version=2;if(11==c.effect||13==c.effect)this.version=4}this.mixer.store(a,f);for(k=1;16>k;++k)if(c=this.samples[k])for(c.loop?(c.loopPtr=c.pointer+c.loop,c.pointer=c.loopPtr,c.length=c.repeat):(c.loopPtr=this.mixer.memory.length,c.repeat=2),f=c.pointer+4,a=c.pointer;a<f;++a)this.mixer.memory[a]=
0;c=A();c.pointer=c.loopPtr=this.mixer.memory.length;c.length=c.repeat=2;this.samples[0]=c;1>e&&(this.version=0)}}},process:{value:function(){var a,d,k,c=this.voices[0];if(this.tick)for(;c;){if(c.param)if(a=c.channel,1==this.version)1==c.effect?this.arpeggio(c):2==c.effect&&(k=c.param>>4,c.period=k?c.period+k:c.period-(c.param&15),a.period=c.period);else{switch(c.effect){case 0:this.arpeggio(c);break;case 1:c.last-=c.param&15;113>c.last&&(c.last=113);a.period=c.last;break;case 2:c.last+=c.param&15,
856<c.last&&(c.last=856),a.period=c.last}if(2!=(this.version&2)){c=c.next;continue}switch(c.effect){case 12:a.volume=c.param;break;case 13:this.mixer.filter.active=0;break;case 14:this.speed=c.param&15}}c=c.next}else for(k=this.track[this.trackPos]+this.patternPos;c;){a=c.channel;c.enabled=0;d=this.patterns[k+c.index];c.period=d.note;c.effect=d.effect;c.param=d.param;d.sample?(d=c.sample=this.samples[d.sample],a.volume=2==(this.version&2)&&12==c.effect?c.param:d.volume):d=c.sample;c.period&&(c.enabled=
1,a.enabled=0,a.pointer=d.pointer,a.length=d.length,a.period=c.last=c.period);c.enabled&&(a.enabled=1);a.pointer=d.loopPtr;a.length=d.repeat;if(!(4>this.version))switch(c.effect){case 11:this.trackPos=c.param-1;this.jumpFlag^=1;break;case 12:a.volume=c.param;break;case 13:this.jumpFlag^=1;break;case 14:this.mixer.filter.active=c.param^1;break;case 15:if(!c.param)break;this.speed=c.param&15;this.tick=0}c=c.next}++this.tick==this.speed&&(this.tick=0,this.patternPos+=4,256==this.patternPos||this.jumpFlag)&&
(this.patternPos=this.jumpFlag=0,++this.trackPos==this.length&&(this.trackPos=0,this.mixer.complete=1))}},arpeggio:{value:function(a){var d=a.channel,k=0,c=this.tick%3;if(c){for(c=1==c?a.param>>4:a.param&15;a.last!=p[k];)k++;d.period=p[k+c]}else d.period=a.last}},isLegal:{value:function(a){var d,k=0,c=a.length;if(!c)return 0;for(;k<c;++k)if((d=a.charCodeAt(k))&&(32>d||127<d))return 0;return 1}}});d.voices[0]=l(0);d.voices[0].next=d.voices[1]=l(1);d.voices[1].next=d.voices[2]=l(2);d.voices[2].next=
d.voices[3]=l(3);d.track=new Uint16Array(128);return Object.seal(d)}})();(function(){function l(a){a=Object.create(null,{index:{value:a,writable:!0},next:{value:null,writable:!0},flags:{value:0,writable:!0},delay:{value:0,writable:!0},channel:{value:null,writable:!0},patternLoop:{value:0,writable:!0},patternLoopRow:{value:0,writable:!0},playing:{value:null,writable:!0},note:{value:0,writable:!0},keyoff:{value:0,writable:!0},period:{value:0,writable:!0},finetune:{value:0,writable:!0},arpDelta:{value:0,
writable:!0},vibDelta:{value:0,writable:!0},instrument:{value:null,writable:!0},autoVibratoPos:{value:0,writable:!0},autoSweep:{value:0,writable:!0},autoSweepPos:{value:0,writable:!0},sample:{value:null,writable:!0},sampleOffset:{value:0,writable:!0},volume:{value:0,writable:!0},volEnabled:{value:0,writable:!0},volEnvelope:{value:null,writable:!0},volDelta:{value:0,writable:!0},volSlide:{value:0,writable:!0},volSlideMaster:{value:0,writable:!0},fineSlideU:{value:0,writable:!0},fineSlideD:{value:0,
writable:!0},fadeEnabled:{value:0,writable:!0},fadeDelta:{value:0,writable:!0},fadeVolume:{value:0,writable:!0},panning:{value:0,writable:!0},panEnabled:{value:0,writable:!0},panEnvelope:{value:null,writable:!0},panSlide:{value:0,writable:!0},portaU:{value:0,writable:!0},portaD:{value:0,writable:!0},finePortaU:{value:0,writable:!0},finePortaD:{value:0,writable:!0},xtraPortaU:{value:0,writable:!0},xtraPortaD:{value:0,writable:!0},portaPeriod:{value:0,writable:!0},portaSpeed:{value:0,writable:!0},glissando:{value:0,
writable:!0},glissPeriod:{value:0,writable:!0},vibratoPos:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0},vibratoReset:{value:0,writable:!0},tremoloPos:{value:0,writable:!0},tremoloSpeed:{value:0,writable:!0},tremoloDepth:{value:0,writable:!0},waveControl:{value:0,writable:!0},tremorPos:{value:0,writable:!0},tremorOn:{value:0,writable:!0},tremorOff:{value:0,writable:!0},tremorVolume:{value:0,writable:!0},retrigx:{value:0,writable:!0},retrigy:{value:0,writable:!0},
reset:{value:function(){this.volume=this.sample.volume;this.panning=this.sample.panning;this.finetune=this.sample.finetune>>3<<2;this.fadeDelta=this.fadeEnabled=this.volDelta=this.keyoff=0;this.fadeVolume=65536;this.autoVibratoPos=0;this.autoSweep=1;this.vibratoReset=this.vibDelta=this.autoSweepPos=0;4>(this.waveControl&15)&&(this.vibratoPos=0);4>this.waveControl>>4&&(this.tremoloPos=0)}},autoVibrato:{value:function(){var a;this.autoVibratoPos=this.autoVibratoPos+this.playing.vibratoSpeed&255;switch(this.playing.vibratoType){case 0:a=
h[this.autoVibratoPos];break;case 1:a=128>this.autoVibratoPos?-64:64;break;case 2:a=(64+(this.autoVibratoPos>>1)&127)-64;break;case 3:a=(64-(this.autoVibratoPos>>1)&127)-64}a*=this.playing.vibratoDepth;this.autoSweep&&(this.playing.vibratoSweep?this.autoSweepPos>this.playing.vibratoSweep?(this.autoSweepPos&2&&(a*=this.autoSweepPos/this.playing.vibratoSweep),this.autoSweep=0):a*=++this.autoSweepPos/this.playing.vibratoSweep:this.autoSweep=0);this.flags|=f;return a>>6}},tonePortamento:{value:function(){this.glissPeriod||
(this.glissPeriod=this.period);this.period<this.portaPeriod?(this.glissPeriod+=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period>=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=this.portaPeriod=0)):this.period>this.portaPeriod&&(this.glissPeriod-=this.portaSpeed<<2,this.period=this.glissando?Math.round(this.glissPeriod/64)<<6:this.glissPeriod,this.period<=this.portaPeriod&&(this.period=this.portaPeriod,this.glissPeriod=
this.portaPeriod=0));this.flags|=f}},tremolo:{value:function(){var a=255,c=this.tremoloPos&31;switch(this.waveControl>>4&3){case 0:a=m[c];break;case 1:a=c<<3}this.volDelta=a*this.tremoloDepth>>6;31<this.tremoloPos&&(this.volDelta=-this.volDelta);this.tremoloPos=this.tremoloPos+this.tremoloSpeed&63;this.flags|=b}},tremor:{value:function(){this.tremorPos==this.tremorOn?(this.tremorVolume=this.volume,this.volume=0):(this.tremorPos=0,this.volume=this.tremorVolume);this.flags|=b;this.tremorPos++}},vibrato:{value:function(){var a=
255,b=this.vibratoPos&31;switch(this.waveControl&3){case 0:a=m[b];break;case 1:a=b<<3,31<this.vibratoPos&&(a=255-a)}this.vibDelta=a*this.vibratoDepth>>7;31<this.vibratoPos&&(this.vibDelta=-this.vibDelta);this.vibratoPos=this.vibratoPos+this.vibratoSpeed&63;this.flags|=f}}});a.volEnvelope=d();a.panEnvelope=d();return Object.seal(a)}function p(){return Object.create(null,{points:{value:[],writable:!0},total:{value:0,writable:!0},sustain:{value:0,writable:!0},loopStart:{value:0,writable:!0},loopEnd:{value:0,
writable:!0},flags:{value:0,writable:!0}})}function d(){return Object.create(null,{value:{value:0,writable:!0},position:{value:0,writable:!0},frame:{value:0,writable:!0},delta:{value:0,writable:!0},fraction:{value:0,writable:!0},stopped:{value:0,writable:!0},reset:{value:function(){this.stopped=this.fraction=this.delta=this.frame=this.position=this.value=0}}})}function a(){var a=Object.create(null,{name:{value:"",writable:!0},samples:{value:[],writable:!0},noteSamples:{value:null,writable:!0},fadeout:{value:0,
writable:!0},volData:{value:null,writable:!0},volEnabled:{value:0,writable:!0},panData:{value:null,writable:!0},panEnabled:{value:0,writable:!0},vibratoType:{value:0,writable:!0},vibratoSweep:{value:0,writable:!0},vibratoSpeed:{value:0,writable:!0},vibratoDepth:{value:0,writable:!0}});a.noteSamples=new Uint8Array(96);a.volData=p();a.panData=p();return Object.seal(a)}function g(a,b){var c=Object.create(null,{rows:{value:[],writable:!0},length:{value:0,writable:!0},size:{value:0,writable:!0}});c.rows.length=
c.size=a*b;c.length=a;return Object.seal(c)}function k(a,b){var c=Object.create(null,{frame:{value:0,writable:!0},value:{value:0,writable:!0}});c.frame=a||0;c.value=b||0;return Object.seal(c)}function c(){return Object.create(null,{note:{value:0,writable:!0},instrument:{value:0,writable:!0},volume:{value:0,writable:!0},effect:{value:0,writable:!0},param:{value:0,writable:!0}})}function e(){var a=L();Object.defineProperties(a,{finetune:{value:0,writable:!0},panning:{value:0,writable:!0},relative:{value:0,
writable:!0}});return Object.seal(a)}var f=1,b=2,h=[0,-2,-3,-5,-6,-8,-9,-11,-12,-14,-16,-17,-19,-20,-22,-23,-24,-26,-27,-29,-30,-32,-33,-34,-36,-37,-38,-39,-41,-42,-43,-44,-45,-46,-47,-48,-49,-50,-51,-52,-53,-54,-55,-56,-56,-57,-58,-59,-59,-60,-60,-61,-61,-62,-62,-62,-63,-63,-63,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-64,-63,-63,-63,-62,-62,-62,-61,-61,-60,-60,-59,-59,-58,-57,-56,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-39,-38,-37,-36,-34,-33,-32,-30,-29,-27,-26,-24,-23,-22,
-20,-19,-17,-16,-14,-12,-11,-9,-8,-6,-5,-3,-2,0,2,3,5,6,8,9,11,12,14,16,17,19,20,22,23,24,26,27,29,30,32,33,34,36,37,38,39,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,56,57,58,59,59,60,60,61,61,62,62,62,63,63,63,64,64,64,64,64,64,64,64,64,64,64,63,63,63,62,62,62,61,61,60,60,59,59,58,57,56,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,39,38,37,36,34,33,32,30,29,27,26,24,23,22,20,19,17,16,14,12,11,9,8,6,5,3,2],m=[0,24,49,74,97,120,141,161,180,197,212,224,235,244,250,253,255,253,250,244,235,224,
212,197,180,161,141,120,97,74,49,24],q=[0,.04417,.062489,.076523,.088371,.098821,.108239,.116927,.124977,.132572,.139741,.146576,.153077,.159335,.16535,.171152,.176772,.18221,.187496,.19263,.197643,.202503,.207273,.211951,.216477,.220943,.225348,.229631,.233854,.237985,.242056,.246066,.249985,.253873,.25767,.261437,.265144,.268819,.272404,.275989,.279482,.282976,.286409,.289781,.293153,.296464,.299714,.302965,.306185,.309344,.312473,.315602,.318671,.321708,.324746,.327754,.3307,.333647,.336563,.339449,
.342305,.345161,.347986,.350781,.353545,.356279,.359013,.361717,.364421,.367094,.369737,.37238,.374992,.377574,.380157,.382708,.38526,.387782,.390303,.392794,.395285,.397746,.400176,.402606,.405037,.407437,.409836,.412206,.414576,.416915,.419254,.421563,.423841,.42618,.428458,.430737,.432985,.435263,.437481,.439729,.441916,.444134,.446321,.448508,.450665,.452852,.455009,.457136,.459262,.461389,.463485,.465611,.467708,.469773,.471839,.473935,.47597,.478036,.480072,.482077,.484112,.486117,.488122,.490127,
.492101,.494106,.496051,.498025,.5,.501944,.503888,.505802,.507746,.50966,.511574,.513488,.515371,.517255,.519138,.521022,.522905,.524758,.526611,.528465,.530318,.53214,.533993,.535816,.537639,.539462,.541254,.543046,.544839,.546631,.548423,.550216,.551978,.553739,.555501,.557263,.558995,.560757,.562489,.56422,.565952,.567683,.569384,.571116,.572817,.574518,.57622,.57789,.579592,.581262,.582964,.584634,.586305,.587946,.589617,.591257,.592928,.594568,.596209,.597849,.599459,.6011,.60271,.60435,.60596,
.60757,.60915,.61076,.61237,.61395,.61556,.617139,.618719,.620268,.621848,.623428,.624977,.626557,.628106,.629655,.631205,.632754,.634303,.635822,.637372,.63889,.64044,.641959,.643478,.644966,.646485,.648004,.649523,.651012,.6525,.653989,.655477,.656966,.658454,.659943,.661431,.66289,.664378,.665836,.667294,.668783,.670241,.671699,.673127,.674585,.676043,.677471,.678929,.680357,.681785,.683213,.684641,.686068,.687496,.688894,.690321,.691749,.693147,.694574,.695972,.697369,.698767,.700164,.701561,
.702928,.704326,.705723,.70711],n=[0,.005863,.013701,.021569,.029406,.037244,.045082,.052919,.060757,.068625,.076463,.0843,.092138,.099976,.107844,.115681,.123519,.131357,.139194,.147032,.1549,.162738,.170575,.178413,.186251,.194119,.201956,.209794,.217632,.225469,.233307,.241175,.249013,.25685,.264688,.272526,.280394,.288231,.296069,.303907,.311744,.319582,.32745,.335288,.343125,.350963,.3588,.366669,.374506,.382344,.390182,.398019,.405857,.413725,.421563,.4294,.437238,.445076,.452944,.460781,.468619,
.476457,.484294,.492132,.5],u=[29024,27392,25856,24384,23040,21696,20480,19328,18240,17216,16256,15360,14512,13696,12928,12192,11520,10848,10240,9664,9120,8608,8128,7680,7256,6848,6464,6096,5760,5424,5120,4832,4560,4304,4064,3840,3628,3424,3232,3048,2880,2712,2560,2416,2280,2152,2032,1920,1814,1712,1616,1524,1440,1356,1280,1208,1140,1076,1016,960,907,856,808,762,720,678,640,604,570,538,508,480,453,428,404,381,360,339,320,302,285,269,254,240,227,214,202,190,180,169,160,151,142,134,127,120,113,107,
101,95,90,85,80,75,71,67,63,60,57,53,50,48,45,42,40,38,36,34,32,30,28];window.neoart.F2Player=function(d){d=G(d);Object.defineProperties(d,{id:{value:"F2Player"},patterns:{value:[],writable:!0},instruments:{value:[],writable:!0},voices:{value:[],writable:!0},linear:{value:0,writable:!0},complete:{value:0,writable:!0},order:{value:0,writable:!0},position:{value:0,writable:!0},nextOrder:{value:0,writable:!0},nextPosition:{value:0,writable:!0},pattern:{value:null,writable:!0},patternDelay:{value:0,writable:!0},
patternOffset:{value:0,writable:!0},timer:{value:0,writable:!0},initialize:{value:function(){var a=0,b;this.reset();this.timer=this.speed;this.position=this.order=0;this.nextPosition=this.nextOrder=-1;this.complete=this.patternOffset=this.patternDelay=0;this.master=64;for(this.voices.length=this.channels;a<this.channels;++a)b=l(a),b.channel=this.mixer.channels[a],b.playing=this.instruments[0],b.sample=b.playing.samples[0],this.voices[a]=b,a&&(this.voices[a-1].next=b)}},loader:{value:function(b){var d,
f,l,m,h,n,q,M=22,r,u;if(!(360>b.length)){b.position=17;this.title=b.readString(20);b.position++;f=b.readString(20);if("FastTracker v2.00   "==f||"FastTracker v 2.00  "==f)this.version=1;else if("Sk@le Tracker"==f)this.version=M=2;else if("MadTracker 2.0"==f)this.version=3;else if("MilkyTracker        "==f)this.version=4;else if("DigiBooster Pro 2.18"==f)this.version=5;else if(-1!=f.indexOf("OpenMPT"))this.version=6;else return;b.readUshort();d=b.readUint();this.length=b.readUshort();this.restart=
b.readUshort();this.channels=b.readUshort();u=r=b.readUshort();this.instruments=[];this.instruments.length=b.readUshort()+1;this.linear=b.readUshort();this.speed=b.readUshort();this.tempo=b.readUshort();this.track=new Uint8Array(this.length);for(f=0;f<this.length;++f)l=b.readUbyte(),l>=u&&(r=l+1),this.track[f]=l;this.patterns=[];this.patterns.length=r;if(r!=u){m=g(64,this.channels);l=m.size;for(f=0;f<l;++f)m.rows[f]=c();this.patterns[--r]=m}b.position=q=d+60;n=u;for(f=0;f<n;++f){d=b.readUint();b.position++;
m=g(b.readUshort(),this.channels);r=m.size;u=b.readUshort();b.position=q+d;h=b.position+u;if(u)for(l=0;l<r;++l)d=c(),u=b.readUbyte(),u&128?(u&1&&(d.note=b.readUbyte()),u&2&&(d.instrument=b.readUbyte()),u&4&&(d.volume=b.readUbyte()),u&8&&(d.effect=b.readUbyte()),u&16&&(d.param=b.readUbyte())):(d.note=u,d.instrument=b.readUbyte(),d.volume=b.readUbyte(),d.effect=b.readUbyte(),d.param=b.readUbyte()),97!=d.note&&96<d.note&&(d.note=0),m.rows[l]=d;else for(l=0;l<r;++l)m.rows[l]=c();this.patterns[f]=m;q=
b.position;q!=h&&(q=b.position=h)}h=b.position;n=this.instruments.length;for(f=1;f<n;++f){l=b.readUint();if(b.position+l>=b.length)break;m=a();m.name=b.readString(22);b.position++;u=b.readUshort();16<u&&(u=16);d=b.readUint();2==M&&64!=d&&(d=64);if(u){m.samples=[];m.samples.length=u;for(l=0;96>l;++l)m.noteSamples[l]=b.readUbyte();for(l=0;12>l;++l)m.volData.points[l]=k(b.readUshort(),b.readUshort());for(l=0;12>l;++l)m.panData.points[l]=k(b.readUshort(),b.readUshort());m.volData.total=b.readUbyte();
m.panData.total=b.readUbyte();m.volData.sustain=b.readUbyte();m.volData.loopStart=b.readUbyte();m.volData.loopEnd=b.readUbyte();m.panData.sustain=b.readUbyte();m.panData.loopStart=b.readUbyte();m.panData.loopEnd=b.readUbyte();m.volData.flags=b.readUbyte();m.panData.flags=b.readUbyte();m.volData.flags&1&&(m.volEnabled=1);m.panData.flags&1&&(m.panEnabled=1);m.vibratoType=b.readUbyte();m.vibratoSweep=b.readUbyte();m.vibratoDepth=b.readUbyte();m.vibratoSpeed=b.readUbyte();m.fadeout=b.readUshort()<<1;
b.position+=M;q=b.position;this.instruments[f]=m;for(l=0;l<u;++l)h=e(),h.length=b.readUint(),h.loopStart=b.readUint(),h.loopLen=b.readUint(),h.volume=b.readUbyte(),h.finetune=b.readByte(),h.loopMode=b.readUbyte(),h.panning=b.readUbyte(),h.relative=b.readByte(),b.position++,h.name=b.readString(22),m.samples[l]=h,b.position=q+=d;for(l=0;l<u;++l)h=m.samples[l],h.length&&(q=b.position+h.length,h.loopMode&16&&(h.bits=16,h.loopMode^=16,h.length>>=1,h.loopStart>>=1,h.loopLen>>=1),h.loopLen||(h.loopMode=
0),h.store(b),h.loopMode&&(h.length=h.loopStart+h.loopLen),b.position=q)}else b.position=h+l;h=b.position;if(h>=b.length)break}m=a();m.volData=p();m.panData=p();m.samples=[];for(f=0;12>f;++f)m.volData.points[f]=k(),m.panData.points[f]=k();h=e();h.length=220;h.data=new Float32Array(220);for(f=0;220>f;++f)h.data[f]=0;m.samples[0]=h;this.instruments[0]=m}}},process:{value:function(){var a,c,d,e,g,k,l,m,h=this.voices[0];if(this.tick)for(;h;){k=this.pattern.rows[this.position+h.index];if(h.delay)if((k.param&
15)==this.tick)h.flags=h.delay,h.delay=0;else{h=h.next;continue}if(k.volume)switch(c=k.volume>>4,d=k.volume&15,c){case 6:h.volume-=d;0>h.volume&&(h.volume=0);h.flags|=b;break;case 7:h.volume+=d;64<h.volume&&(h.volume=64);h.flags|=b;break;case 11:h.vibrato();break;case 13:h.panning-=d;0>h.panning&&(h.panning=0);h.flags|=4;break;case 14:h.panning+=d;255<h.panning&&(h.panning=255);h.flags|=4;break;case 15:h.portaPeriod&&h.tonePortamento()}c=k.param>>4;d=k.param&15;switch(k.effect){case 0:if(!k.param)break;
m=(this.tick-this.timer)%3;0>m&&(m+=3);2==this.tick&&18==this.timer&&(m=0);m?1==m?this.linear?h.arpDelta=-(d<<6):(m=this.amiga(h.note+d,h.finetune),h.arpDelta=m-h.period):this.linear?h.arpDelta=-(c<<6):(m=this.amiga(h.note+c,h.finetune),h.arpDelta=m-h.period):h.arpDelta=0;h.flags|=f;break;case 1:h.period-=h.portaU;0>h.period&&(h.period=0);h.flags|=f;break;case 2:h.period+=h.portaD;9212<h.period&&(h.period=9212);h.flags|=f;break;case 3:h.portaPeriod&&h.tonePortamento();break;case 4:c&&(h.vibratoSpeed=
c);d&&(h.vibratoDepth=d<<2);h.vibrato();break;case 5:g=1;h.portaPeriod&&h.tonePortamento();break;case 6:g=1;h.vibrato();break;case 7:h.tremolo();break;case 10:g=1;break;case 14:switch(c){case 9:0==this.tick%d&&(h.volEnvelope.reset(),h.panEnvelope.reset(),h.flags=h.flags|b|12);break;case 12:this.tick==d&&(h.volume=0,h.flags|=b)}break;case 17:c=h.volSlideMaster>>4;d=h.volSlideMaster&15;c?(this.master+=c,64<this.master&&(this.master=64),h.flags|=b):d&&(this.master-=d,0>this.master&&(this.master=0),h.flags|=
b);break;case 20:this.tick==k.param&&(h.fadeEnabled=1,h.keyoff=1);break;case 24:c=h.panSlide>>4;d=h.panSlide&15;c?(h.panning+=c,255<h.panning&&(h.panning=255),h.flags|=4):d&&(h.panning-=d,0>h.panning&&(h.panning=0),h.flags|=4);break;case 27:a=this.tick;k.volume||a++;if(a%h.retrigy)break;(!k.volume||80<k.volume)&&h.retrigx&&this.retrig(h);h.flags|=8;break;case 29:h.tremor()}g&&(c=h.volSlide>>4,d=h.volSlide&15,g=0,c?(h.volume+=c,h.flags|=b):d&&(h.volume-=d,h.flags|=b));h=h.next}else for(0<=this.nextOrder&&
(this.order=this.nextOrder),0<=this.nextPosition&&(this.position=this.nextPosition),this.nextOrder=this.nextPosition=-1,this.pattern=this.patterns[this.track[this.order]];h;){k=this.pattern.rows[this.position+h.index];a=k.volume>>4;g=3==k.effect||5==k.effect||15==a;c=k.param>>4;h.keyoff=0;h.arpDelta&&(h.arpDelta=0,h.flags|=f);if(k.instrument)h.instrument=k.instrument<this.instruments.length?this.instruments[k.instrument]:null,h.volEnvelope.reset(),h.panEnvelope.reset(),h.flags=h.flags|b|36;else if(97==
k.note||20==k.effect&&!k.param)h.fadeEnabled=1,h.keyoff=1;k.note&&97!=k.note?h.instrument?(d=h.instrument,m=k.note-1,l=d.samples[d.noteSamples[m]],m+=l.relative,0<=m&&118>=m&&(g||(h.note=m,h.sample=l,k.instrument?(h.volEnabled=d.volEnabled,h.panEnabled=d.panEnabled,h.flags|=15):h.flags=h.flags|f|8),k.instrument?(h.reset(),h.fadeDelta=d.fadeout):h.finetune=l.finetune>>3<<2,14==k.effect&&5==c&&(h.finetune=(k.param&15)-8<<3),m=this.linear?(120-m<<6)-h.finetune:this.amiga(m,h.finetune),g?h.portaPeriod=
m:(h.period=m,h.glissPeriod=0))):(h.volume=0,h.flags=b|32):h.vibratoReset&&4!=k.effect&&6!=k.effect&&(h.vibDelta=0,h.vibratoReset=0,h.flags|=f);if(k.volume)if(16<=k.volume&&80>=k.volume)h.volume=k.volume-16,h.flags=h.flags|b|32;else switch(d=k.volume&15,a){case 6:h.volume-=d;0>h.volume&&(h.volume=0);h.flags|=b;break;case 7:h.volume+=d;64<h.volume&&(h.volume=64);h.flags|=b;break;case 10:d&&(h.vibratoSpeed=d);break;case 11:d&&(h.vibratoDepth=d<<2);break;case 12:h.panning=d<<4;h.flags|=4;break;case 15:d&&
(h.portaSpeed=d<<4)}if(k.effect)switch(d=k.param&15,k.effect){case 1:k.param&&(h.portaU=k.param<<2);break;case 2:k.param&&(h.portaD=k.param<<2);break;case 3:k.param&&15!=a&&(h.portaSpeed=k.param);break;case 4:h.vibratoReset=1;break;case 5:k.param&&(h.volSlide=k.param);break;case 6:k.param&&(h.volSlide=k.param);h.vibratoReset=1;break;case 7:c&&(h.tremoloSpeed=c);d&&(h.tremoloDepth=d);break;case 8:h.panning=k.param;h.flags|=4;break;case 9:k.param&&(h.sampleOffset=k.param<<8);h.sampleOffset>=h.sample.length&&
(h.volume=0,h.sampleOffset=0,h.flags&=~(f|8),h.flags=h.flags|b|32);break;case 10:k.param&&(h.volSlide=k.param);break;case 11:this.nextOrder=k.param;this.nextOrder>=this.length?this.complete=1:this.nextPosition=0;e=1;this.patternOffset=0;break;case 12:h.volume=k.param;h.flags=h.flags|b|32;break;case 13:this.nextPosition=(10*c+d)*this.channels;this.patternOffset=0;e||(this.nextOrder=this.order+1,this.nextOrder>=this.length&&(this.complete=1,this.nextPosition=-1));break;case 14:switch(c){case 1:d&&(h.finePortaU=
d<<2);h.period-=h.finePortaU;h.flags|=f;break;case 2:d&&(h.finePortaD=d<<2);h.period+=h.finePortaD;h.flags|=f;break;case 3:h.glissando=d;break;case 4:h.waveControl=h.waveControl&240|d;break;case 6:d?(h.patternLoop?h.patternLoop--:h.patternLoop=d,h.patternLoop&&(this.nextPosition=h.patternLoopRow)):h.patternLoopRow=this.patternOffset=this.position;break;case 7:h.waveControl=h.waveControl&15|d<<4;break;case 10:d&&(h.fineSlideU=d);h.volume+=h.fineSlideU;h.flags|=b;break;case 11:d&&(h.fineSlideD=d);h.volume-=
h.fineSlideD;h.flags|=b;break;case 13:h.delay=h.flags;h.flags=0;break;case 14:this.patternDelay=d*this.timer}break;case 15:if(!k.param)break;32>k.param?this.timer=k.param:this.mixer.samplesTick=2.5*this.sampleRate/k.param>>0;break;case 16:this.master=k.param;64<this.master&&(this.master=64);h.flags|=b;break;case 17:k.param&&(h.volSlideMaster=k.param);break;case 21:if(!h.instrument||!h.instrument.volEnabled)break;d=h.instrument;m=k.param;c=d.volData.total;for(a=0;a<c&&!(m<d.volData.points[a].frame);a++);
h.volEnvelope.position=--a;c--;d.volData.flags&4&&a==d.volData.loopEnd&&(a=h.volEnvelope.position=d.volData.loopStart,m=d.volData.points[a].frame,h.volEnvelope.frame=m);a>=c?(h.volEnvelope.value=d.volData.points[c].value,h.volEnvelope.stopped=1):(h.volEnvelope.stopped=0,h.volEnvelope.frame=m,m>d.volData.points[a].frame&&h.volEnvelope.position++,c=d.volData.points[a],a=d.volData.points[++a],m=a.frame-c.frame,h.volEnvelope.delta=(m?(a.value-c.value<<8)/m>>0:0)||0,h.volEnvelope.fraction=c.value<<8);
break;case 24:k.param&&(h.panSlide=k.param);break;case 27:c&&(h.retrigx=c);d&&(h.retrigy=d);if(!k.volume&&h.retrigy){a=this.tick+1;if(a%h.retrigy)break;80<k.volume&&h.retrigx&&this.retrig(h)}break;case 29:k.param&&(h.tremorOn=++c,h.tremorOff=++d+c);break;case 33:1==c?(d&&(h.xtraPortaU=d),h.period-=h.xtraPortaU,h.flags|=f):2==c&&(d&&(h.xtraPortaD=d),h.period+=h.xtraPortaD,h.flags|=f)}h=h.next}++this.tick>=this.timer+this.patternDelay&&(this.patternDelay=this.tick=0,0>this.nextPosition&&(this.nextPosition=
this.position+this.channels,this.nextPosition>=this.pattern.size||this.complete))&&(this.nextOrder=this.order+1,this.nextPosition=this.patternOffset,this.nextOrder>=this.length&&(this.nextOrder=this.restart,this.mixer.complete=1))}},fast:{value:function(){for(var a,c,d,e,g,h=this.voices[0],k;h;)a=h.channel,d=h.flags,h.flags=0,d&8&&(a.index=h.sampleOffset,a.pointer=-1,a.dir=0,a.fraction=0,a.sample=h.sample,a.length=h.sample.length,a.enabled=a.sample.data?1:0,h.playing=h.instrument,h.sampleOffset=0),
e=h.playing,c=e.vibratoSpeed?h.autoVibrato():0,k=h.volume+h.volDelta,e.volEnabled?(h.volEnabled&&!h.volEnvelope.stopped&&this.envelope(h,h.volEnvelope,e.volData),k=k*h.volEnvelope.value>>6,d|=b,h.fadeEnabled&&(h.fadeVolume-=h.fadeDelta,0>h.fadeVolume?(k=0,h.fadeVolume=0,h.fadeEnabled=0,h.volEnvelope.value=0,h.volEnvelope.stopped=1,h.panEnvelope.stopped=1):k=k*h.fadeVolume>>16)):h.keyoff&&(k=0,d|=b),g=h.panning,e.panEnabled&&(h.panEnabled&&!h.panEnvelope.stopped&&this.envelope(h,h.panEnvelope,e.panData),
g=h.panEnvelope.value<<2,d|=4,0>g?g=0:255<g&&(g=255)),d&b&&(0>k?k=0:64<k&&(k=64),a.volume=n[k*this.master>>6],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),d&4&&(a.panning=g,a.lpan=q[256-g],a.rpan=q[g],a.lvol=a.volume*a.lpan,a.rvol=a.volume*a.rpan),d&f&&(c+=h.period+h.arpDelta+h.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-c)/768)/this.sampleRate>>0)/65536:(14317456/c*65536/this.sampleRate>>0)/65536,a.delta=a.speed>>0,a.speed-=a.delta),h=h.next}},accurate:{value:function(){for(var a,
c,d,e,g,h,k,l=this.voices[0];l;)a=l.channel,d=l.flags,l.flags=0,d&8&&(a.sample&&(d|=32,a.mixCounter=220,a.oldSample=null,a.oldPointer=-1,a.enabled&&(a.oldDir=a.dir,a.oldFraction=a.fraction,a.oldSpeed=a.speed,a.oldSample=a.sample,a.oldPointer=a.pointer,a.oldLength=a.length,a.lmixRampD=a.lvol,a.lmixDeltaD=a.lvol/220,a.rmixRampD=a.rvol,a.rmixDeltaD=a.rvol/220)),a.dir=1,a.fraction=0,a.sample=l.sample,a.pointer=l.sampleOffset,a.length=l.sample.length,a.enabled=a.sample.data?1:0,l.playing=l.instrument,
l.sampleOffset=0),e=l.playing,c=e.vibratoSpeed?l.autoVibrato():0,g=l.volume+l.volDelta,e.volEnabled?(l.volEnabled&&!l.volEnvelope.stopped&&this.envelope(l,l.volEnvelope,e.volData),g=g*l.volEnvelope.value>>6,d|=b,l.fadeEnabled&&(l.fadeVolume-=l.fadeDelta,0>l.fadeVolume?(g=0,l.fadeVolume=0,l.fadeEnabled=0,l.volEnvelope.value=0,l.volEnvelope.stopped=1,l.panEnvelope.stopped=1):g=g*l.fadeVolume>>16)):l.keyoff&&(g=0,d|=b),h=l.panning,e.panEnabled&&(l.panEnabled&&!l.panEnvelope.stopped&&this.envelope(l,
l.panEnvelope,e.panData),h=l.panEnvelope.value<<2,d|=4,0>h?h=0:255<h&&(h=255)),a.enabled?(d&b&&(0>g?g=0:64<g&&(g=64),g=n[g*this.master>>6],e=g*q[256-h],k=g*q[h],g==a.volume||a.mixCounter?(a.lvol=e,a.rvol=k):(a.volCounter=d&32?220:this.mixer.samplesTick,a.lvolDelta=(e-a.lvol)/a.volCounter,a.rvolDelta=(k-a.rvol)/a.volCounter),a.volume=g),d&4&&(g=q[256-h],e=q[h],h==a.panning||a.mixCounter||a.volCounter?(a.lpan=g,a.rpan=e):(a.panCounter=this.mixer.samplesTick,a.lpanDelta=(g-a.lpan)/a.panCounter,a.rpanDelta=
(e-a.rpan)/a.panCounter),a.panning=h),d&f&&(c+=l.period+l.arpDelta+l.vibDelta,a.speed=this.linear?(548077568*Math.pow(2,(4608-c)/768)/this.sampleRate>>0)/65536:(14317456/c*65536/this.sampleRate>>0)/65536),a.mixCounter&&(a.lmixRampU=0,a.lmixDeltaU=a.lvol/220,a.rmixRampU=0,a.rmixDeltaU=a.rvol/220)):(a.volCounter=0,a.panCounter=0),l=l.next}},envelope:{value:function(a,b,c){var d=b.position,e=c.points[d];if(b.frame==e.frame){c.flags&4&&d==c.loopEnd&&(d=b.position=c.loopStart,e=c.points[d],b.frame=e.frame);
if(d==c.total-1){b.value=e.value;b.stopped=1;return}if(c.flags&2&&d==c.sustain&&!a.fadeEnabled){b.value=e.value;return}b.position++;a=c.points[b.position];b.delta=(a.value-e.value<<8)/(a.frame-e.frame)>>0||0;b.fraction=e.value<<8}else b.fraction+=b.delta;b.value=b.fraction>>8;b.frame++}},amiga:{value:function(a,b){var c=0,d=u[++a];0>b?c=(u[--a]-d)/64:0<b&&(c=(d-u[++a])/64);return d-c*b>>0}},retrig:{value:function(a){switch(a.retrigx){case 1:a.volume--;break;case 2:a.volume++;break;case 3:a.volume-=
4;break;case 4:a.volume-=8;break;case 5:a.volume-=16;break;case 6:a.volume=(a.volume<<1)/3;break;case 7:a.volume>>=1;break;case 8:a.volume=a.sample.volume;break;case 9:a.volume++;break;case 10:a.volume+=2;break;case 11:a.volume+=4;break;case 12:a.volume+=8;break;case 13:a.volume+=16;break;case 14:a.volume=3*a.volume>>1;break;case 15:a.volume<<=1}0>a.volume?a.volume=0:64<a.volume&&(a.volume=64);a.flags|=b}}});return Object.seal(d)}})()})();